<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Sheng Wang</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://sheng09.github.io/"/>
  <updated>2017-02-03T08:48:08.335Z</updated>
  <id>http://sheng09.github.io/</id>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Linear Inversion of Receiver Function</title>
    <link href="http://sheng09.github.io/2017/10/19/RF-LinearInversion/"/>
    <id>http://sheng09.github.io/2017/10/19/RF-LinearInversion/</id>
    <published>2017-10-19T05:04:16.000Z</published>
    <updated>2017-02-03T08:48:08.335Z</updated>
    
    <content type="html">&lt;p&gt;In receiver function inversion, the model is calibrated and the target is to minimize the mismatch between synthetic receiver function waveform and observed waveform. The key point of the inversion is to give a &amp;#x201C;good&amp;#x201D; model calibration direction, and amount. In linear inversion, these calibration items are given by the first order derivative of the optimal function. However, it is difficult to derive the analytical expression of the first order derivative since the relationship between model&lt;br&gt;and receiver function waveform is extreme complex. Finite difference provides approximate value of differential value.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!--toc--&gt;
&lt;h1 id=&quot;building-linear-equation&quot;&gt;&lt;a href=&quot;#Building-Linear-Equation&quot; class=&quot;headerlink&quot; title=&quot;Building Linear Equation&quot;&gt;&lt;/a&gt;Building Linear Equation&lt;/h1&gt;&lt;p&gt;The receiver function waveform $r(t)$ is determined by the model $m$ and observation error. Given the real model $\hat{m}$ and the observation $\hat{r}$, we have:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \hat{r}(t) = F( \hat{m}(x) ) + err(t) \label{r0} \\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;while synthetic waveform is:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    r(t) = F( m(x) )
\end{eqnarray}&lt;/script&gt;&lt;p&gt;$m(x)$ here indicates the &lt;strong&gt;thickness&lt;/strong&gt; and &lt;strong&gt;velocity&lt;/strong&gt; of each layers. Apply taylor expansion in $\hat{m}$ and ignore high order items, $r(t)$ would be:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    r(t) = F(\hat{m}) + \frac{\delta F}{\delta m} \delta m 
\end{eqnarray}&lt;/script&gt;&lt;p&gt;considering $\eqref{r0}$:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    r(t) - \hat{r}(t) = \frac{\delta F}{\delta m}|_{m=\hat{m}} \delta m - err(t)
\end{eqnarray}&lt;/script&gt;&lt;p&gt;This gives the model calibration $\delta m$. In discrete sense, it is a linear equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        \Delta r[t_0] \\
        \Delta r[t_1] \\
        ... \\
        \Delta r[t_i] \\
        ... \\
        \Delta r[t_N] \\
    \end{bmatrix}
    =
    \begin{bmatrix}
        a_{00} &amp; a_{01} &amp; a_{02} &amp; ... &amp; a_{0M} \\
        a_{10} &amp; a_{11} &amp; a_{12} &amp; ... &amp; a_{1M} \\
        ... \\
        a_{i0} &amp; a_{i1} &amp; a_{i2} &amp; ... &amp; a_{iM} \\
        ... \\
        a_{N0} &amp; a_{N1} &amp; a_{N2} &amp; ... &amp; a_{NM} \\
    \end{bmatrix}
    \begin{bmatrix}
        \Delta m[x_0] \\
        \Delta m[x_1] \\
        ... \\
        \Delta m[x_i] \\
        ... \\
        \Delta m[x_M] \\
    \end{bmatrix}
    -
    \begin{bmatrix}
        err[t_0] \\
        err[t_1] \\
        ...\\
        err[t_i] \\
        ...\\
        err[t_N]
    \end{bmatrix} \\
    a_{ij} = \frac{\delta F} {\delta m}|_{t_i, \hat{m}(x_j)}
\end{equation}&lt;/script&gt;&lt;p&gt;assume current model $m$ approximates the real model $\hat{m}$, $a&lt;em&gt;{ij}$ could be replaced with $a&amp;#x2019;&lt;/em&gt;{ij} = \frac{\delta F} {\delta m}|_{t_i, \m(x_j)}$. To minimize the error, the model calibration is the solution of the linear equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \mathbf{ \Delta r = A \Delta m } \label{lq}
\end{equation}&lt;/script&gt;&lt;h1 id=&quot;differential-seismogram&quot;&gt;&lt;a href=&quot;#Differential-Seismogram&quot; class=&quot;headerlink&quot; title=&quot;Differential Seismogram&quot;&gt;&lt;/a&gt;Differential Seismogram&lt;/h1&gt;&lt;p&gt;It is difficult to derive the first order derivative, the matrix $\mathbf{A}$. Finite difference provides approximates value of this matrix. &lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{\delta F} {\delta m} = \frac{ F(m(x+dx)) - F(m(x)) }{dx} 
\end{eqnarray}&lt;/script&gt;&lt;p&gt;for stratified media, &lt;a href=&quot;http://www.bssaonline.org/content/85/1/300.short&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;this kind of finite difference value of waveform, the differential seismogram, could be computed directely&lt;/a&gt;.&lt;/p&gt;
&lt;h1 id=&quot;inversion&quot;&gt;&lt;a href=&quot;#Inversion&quot; class=&quot;headerlink&quot; title=&quot;Inversion&quot;&gt;&lt;/a&gt;Inversion&lt;/h1&gt;&lt;p&gt;For inversion, model calibration presented above should be operated recursively until the model converges, or minimizing the mismatch between synthetic waveform and observed waveform. Moreover, regularization should be applyed into the inversion to make the solution reasonable.&lt;/p&gt;
&lt;h1 id=&quot;more&quot;&gt;&lt;a href=&quot;#More&quot; class=&quot;headerlink&quot; title=&quot;More&quot;&gt;&lt;/a&gt;More&lt;/h1&gt;&lt;p&gt;In linear inversion, the model calibration is given by the derivatives. So the initial model dominates the solution, the convergence. To avoid locally optimal solution, non-linear techniques is employed. Anyway, linear inversion here presents a way to transform some kinds of complex relationship between model and data into computable problem and employing numerial method to solve it.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;In receiver function inversion, the model is calibrated and the target is to minimize the mismatch between synthetic receiver function waveform and observed waveform. The key point of the inversion is to give a &amp;#x201C;good&amp;#x201D; model calibration direction, and amount. In linear inversion, these calibration items are given by the first order derivative of the optimal function. However, it is difficult to derive the analytical expression of the first order derivative since the relationship between model&lt;br&gt;and receiver function waveform is extreme complex. Finite difference provides approximate value of differential value.&lt;/p&gt;
    
    </summary>
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/categories/Receiver-Function/"/>
    
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/tags/Receiver-Function/"/>
    
      <category term="Inversion" scheme="http://sheng09.github.io/tags/Inversion/"/>
    
      <category term="Linear Equation" scheme="http://sheng09.github.io/tags/Linear-Equation/"/>
    
  </entry>
  
  <entry>
    <title>Finite Difference of Staggered Grid (2)</title>
    <link href="http://sheng09.github.io/2016/10/20/finite-difference-staggerGrid2/"/>
    <id>http://sheng09.github.io/2016/10/20/finite-difference-staggerGrid2/</id>
    <published>2016-10-20T14:18:22.000Z</published>
    <updated>2017-02-02T09:50:08.483Z</updated>
    
    <content type="html">&lt;p&gt;This post presents the asymmetric finite-difference scheme build in staggered grid. This asymmetric scheme works well for processing boundary points.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#fx-in-2nd-order-accuracy&quot;&gt;$f&amp;#x2019;(x)$ in 2nd order accuracy&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#point-0&quot;&gt;point 0&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#fx-in-2nth-order-accuracy&quot;&gt;$f&amp;#x2019;(x)$ in 2Nth order accuracy&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#point-0&quot;&gt;point 0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#point-k-k0123n-1&quot;&gt;point k $(k=0,1,2,3&amp;#x2026;,N-1)$&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#examples&quot;&gt;Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;fx-in-2nd-order-accuracy&quot;&gt;&lt;a href=&quot;#f&amp;#x2019;-x-in-2nd-order-accuracy&quot; class=&quot;headerlink&quot; title=&quot;$f&amp;#x2019;(x)$ in 2nd order accuracy&quot;&gt;&lt;/a&gt;$f&amp;#x2019;(x)$ in 2nd order accuracy&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/10/20/finite-difference-staggerGrid2/2order.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;point-0&quot;&gt;&lt;a href=&quot;#point-0&quot; class=&quot;headerlink&quot; title=&quot;point 0&quot;&gt;&lt;/a&gt;point 0&lt;/h3&gt;&lt;p&gt;To calculate the first order derivates in the $\color{blue}{blue}$ grid points, values in $\color{red}{red}$ points are expanded.&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f(x+\frac{\delta}{2}) &amp; = &amp; f(x) + \frac{\delta}{2} f&#39;(x)
                    + \frac{\delta^2}{2^2 2!}f&#39;&#39;(x)
                    + O(\delta^3) \\
                    %+\frac{\delta^N}{2^N N!}f^{(N)}(x)
                    %+ O(\delta^{N+1}) \\
    f(x+\frac{3\delta}{2}) &amp; = &amp; f(x) + \frac{3\delta}{2} f&#39;(x)
                    + \frac{3^2\delta^2}{2^2 2!}f&#39;&#39;(x)
                    + O(\delta^3) \\
                    %+ ...
                    %+ \frac{3^N\delta^N}{2^N N!}f^{(N)}(x)
                    %+ O(\delta^{N+1}) \\
    f(x+\frac{5\delta}{2}) &amp; = &amp; f(x) + \frac{5\delta}{2} f&#39;(x)
                    + \frac{5^2\delta^2}{2^2 2!}f&#39;&#39;(x)
                    + O(\delta^3) \\
                    %+ ...
                    %+ \frac{5^N\delta^N}{2^N N!}f^{(N)}(x)
                    %+ O(\delta^{N+1})
\end{eqnarray}&lt;/script&gt;&lt;p&gt;thus, $f&amp;#x2019;(x)$ are:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x) &amp; = &amp;  \frac{2 f(x+\frac{\delta}{2}) }{\delta}
                -\frac{2 f(x)}{\delta}
                    - \frac{\delta}{2 2!}f&#39;&#39;(x)
                    + O(\delta^3) \\
                    %- ...
                    %-\frac{\delta^{N-1}}{2^{N-1} N!}f^{(N)}(x)
                    %+ O(\delta^{N}) \\
    f&#39;(x) &amp; = &amp;  \frac{2 f(x+\frac{3\delta}{2}) }{3\delta}
                -\frac{2 f(x)  }{3\delta}
                    - \frac{3\delta }{2 2!}f&#39;&#39;(x)
                    + O(\delta^3) \\
                    %- ...
                    %- \frac{3^{N-1}\delta^{N-1}}{2^{N-1} N!}f^{(N)}(x)
                    %+ O(\delta^{N}) \\
    f&#39;(x) &amp; = &amp;  \frac{2 f(x+\frac{5\delta}{2}) }{5\delta}
                -\frac{2 f(x)  }{5\delta}
                    - \frac{5\delta }{2 2!}f&#39;&#39;(x)
                    + O(\delta^3) \\
                    %- ...
                    %- \frac{5^{N-1}\delta^{N-1}}{2^{N-1} N!}f^{(N)}(x)
                    %+ O(\delta^{N})

\end{eqnarray}&lt;/script&gt;&lt;p&gt;add these $f&amp;#x2019;(x)$ proportionally:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{aligned}
f&#39;(x) = &amp; \frac{2}{\delta}
            \left[
                C^2_{00}            f(x + \frac{\delta}{2}) +
                C^2_{01}\frac{1}{3} f(x + \frac{3\delta}{2} )+
                C^2_{02}\frac{1}{5} f(x + \frac{5\delta}{2} )
            \right]\\
        &amp; -\frac{2}{\delta}
            \left[
                           C^2_{00}+
                \frac{1}{3}C^2_{01}+
                \frac{1}{5}C^2_{02}
            \right] f(x)
          - \frac{\delta}{2 2!}
            \left[
                C^2_{00}+
                3C^2_{01}+
                5C^2_{02}
            \right]f&#39;&#39;(x) + O(\delta^3)

\end{aligned}
\end{equation}&lt;/script&gt;&lt;p&gt;In order to have second order accuracy, $C^2_{0j}$ must satisfy the equation of:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{cases}
        C^2_{00} +  C^2_{01} + C^2_{02} = 1\\
        C^2_{00} + \frac{1}{3}C^2_{01} + \frac{1}{5}C^2_{02}  = 0\\
        C^2_{00} + 3C^2_{01} + 5C^2_{02}  = 0\\
    \end{cases}
    \Rightarrow
    \begin{cases}
        C^2_{00} =  -1           \\
        C^2_{01} =   \frac{9}{2} \\
        C^2_{02} =  -\frac{5}{2}
    \end{cases}
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;fx-in-2nth-order-accuracy&quot;&gt;&lt;a href=&quot;#f&amp;#x2019;-x-in-2Nth-order-accuracy&quot; class=&quot;headerlink&quot; title=&quot;$f&amp;#x2019;(x)$ in 2Nth order accuracy&quot;&gt;&lt;/a&gt;$f&amp;#x2019;(x)$ in 2Nth order accuracy&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/10/20/finite-difference-staggerGrid2/2Norder.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;point-0&quot;&gt;&lt;a href=&quot;#point-0-1&quot; class=&quot;headerlink&quot; title=&quot;point 0&quot;&gt;&lt;/a&gt;point 0&lt;/h3&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f(x+\frac{\delta}{2}) &amp; = &amp; f(x) + \frac{\delta}{2} f&#39;(x)
                    + \frac{\delta^2}{2^2 2!}f&#39;&#39;(x)
                    + ...
                    +\frac{\delta^{2N}}{2^{2N} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N+1}) \\
    f(x+\frac{3\delta}{2}) &amp; = &amp; f(x) + \frac{3\delta}{2} f&#39;(x)
                    + \frac{3^2\delta^2}{2^2 2!}f&#39;&#39;(x)
                    + ...
                    + \frac{3^{2N}\delta^{2N}}{2^{2N} {2N}!}f^{(2N)}(x)
                    + O(\delta^{2N+1})\\
        &amp;...&amp;\\
    f(x+\frac{l\delta}{2}) &amp; = &amp; f(x) + \frac{l\delta}{2}f&#39;(x)
                    + \frac{l^2\delta^2}{2^2 2!}f&#39;&#39;(x)
                    + ...
                    + \frac{l^{2N}\delta^{2N}}{2^{2N} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N+1})
\end{eqnarray}&lt;/script&gt;&lt;p&gt;thus, $f&amp;#x2019;(x)$ are:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x) &amp; = &amp;  \frac{2 f(x+\frac{\delta}{2}) }{\delta}
                -\frac{2 f(x)}{\delta}
                - \frac{\delta}{2 2!}f&#39;&#39;(x)
                - ...
                -\frac{\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                + O(\delta^{2N}) \\
    f&#39;(x) &amp; = &amp;  \frac{2 f(x+\frac{3\delta}{2}) }{3\delta}
                -\frac{2 f(x)  }{3\delta}
                    - \frac{3\delta }{2 2!}f&#39;&#39;(x)
                    - ...
                    - \frac{3^{2N-1}\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N}) \\
    &amp;...&amp;\\
    f&#39;(x) &amp; = &amp; \frac{2 f(x+\frac{l\delta}{2}) }{l\delta}
               -\frac{2 f(x) }{l\delta}
                    - \frac{l\delta}{2 2!}f&#39;&#39;(x)
                    - ...
                    - \frac{l^{2N-1}\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N}) \\
    \color{red}{(l=1,3,5,7,9...)}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;add these $f&amp;#x2019;(x)$ proportionally:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{aligned}
f&#39;(x) = &amp; \frac{2}{\delta}
            \sum \limits_l
            \left[
                 f(x + \frac{l\delta}{2}) C^{2N}_{0(\frac{l-1}{2})}\frac{1}{l}
            \right]\\
        &amp;-\frac{2}{\delta}f(x)
            \sum \limits_l
            \left[
                 C^{2i}_{0(\frac{l-1}{2})} \frac{1}{l}
            \right]
         -\frac{\delta}{2 2!} f&#39;&#39;(x)
            \sum \limits_l
            \left[
                C^{2i}_{0(\frac{l-1}{2})} l
            \right]\\
        &amp; -...
        -\frac{\delta^{2N-1}}{2^{2N-1} (2N)!} f^{2N}(x)
            \sum \limits_l
            \left[
                C^{2N}_{0(\frac{l-1}{2})} l^{2N-1}
            \right]
        +O(\delta^{2N})\\
        (l=1,3,5,7,9...)
\end{aligned}
\end{equation}&lt;/script&gt;&lt;p&gt;To have 2Nth order accuracy, , $C^{2N}_{0j}$ must satisfy the equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{bmatrix}
        1 &amp; 1            &amp; 1          &amp; ... &amp; 1           \\
        1 &amp; \frac{1}{3}  &amp; \frac{1}{5}&amp; ... &amp; \frac{1}{4N+1} \\
        1 &amp; 3            &amp; 5          &amp; ... &amp;  4N+1          \\
        1 &amp; 3^2          &amp; 5^2        &amp; ... &amp;  (4N+1)^2        \\
        ...\\
        1 &amp; 3^{2N-1}      &amp; 5^{2N-1}    &amp; ... &amp;  (4N+1)^{2N-1}    \\
    \end{bmatrix}
    \begin{bmatrix}
    C^{2N}_{00}      \\
    C^{2N}_{01}      \\
    C^{2N}_{02}      \\
    C^{2N}_{03}      \\
    ...\\
    C^{2N}_{0(2N)} \\
    \end{bmatrix}
    =
    \begin{bmatrix}
    1\\
    0\\
    0\\
    0\\
    ...\\
    0\\
    \end{bmatrix}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;point-k-k0123n-1&quot;&gt;&lt;a href=&quot;#point-k-k-0-1-2-3&amp;#x2026;-N-1&quot; class=&quot;headerlink&quot; title=&quot;point k $(k=0,1,2,3&amp;#x2026;,N-1)$&quot;&gt;&lt;/a&gt;point k $(k=0,1,2,3&amp;#x2026;,N-1)$&lt;/h3&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f(x+\frac{(1-2k)\delta}{2}) &amp; = &amp; f(x)
            +\frac{(1-2k)\delta}{2} f&#39;(x)
            + \frac{(1-2k)^2\delta^2}{2^22!}f&#39;&#39;(x)
            +...
            + \frac{(1-2k)^{2N}\delta^{2N}}{2^{2N}(2N)!}f^{(2N)}(x)
            + O(2N+1)
    \\
    ...
    \\
    f(x-\frac{\delta}{2}) &amp; = &amp; f(x) - \frac{\delta}{2}f&#39;(x)
            + \frac{\delta^2}{2^22!}f&#39;&#39;(x)
            + ...
            + \frac{(-1)^{2N}\delta^{2N}}{2^{2N} (2N)!}f^{(2N)}(x)
            + O(\delta^{2N+1})
                                    \\
    f(x+\frac{\delta}{2}) &amp; = &amp; f(x) + \frac{\delta}{2} f&#39;(x)
            + \frac{\delta^2}{2^2 2!}f&#39;&#39;(x)
            + ...
            +\frac{\delta^{2N}}{2^{2N} (2N)!}f^{(2N)}(x)
            + O(\delta^{2N+1}) \\
    f(x+\frac{3\delta}{2}) &amp; = &amp; f(x) + \frac{3\delta}{2} f&#39;(x)
            + \frac{3^2\delta^2}{2^2 2!}f&#39;&#39;(x)
            + ...
            + \frac{3^{2N}\delta^{2N}}{2^{2N} (2N)!}f^{(2N)}(x)
            + O(\delta^{2N+1})\\
        &amp;...&amp;\\
    f(x+\frac{l\delta}{2}) &amp; = &amp; f(x) + \frac{l\delta}{2}f&#39;(x)
            + \frac{l^2\delta^2}{2^2 2!}f&#39;&#39;(x)
            + ...
            + \frac{l^{2N}\delta^{2N}}{2^{2N} (2N)!}f^{(2N)}(x)
            + O(\delta^{2N+1})
\end{eqnarray}&lt;/script&gt;&lt;p&gt;thus, $f&amp;#x2019;(x)$ are:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x) &amp; = &amp; \frac{2}{(1-2k)\delta} f(x+\frac{(1-2k)\delta}{2})
            - \frac{2}{(1-2k)\delta} f(x)
            - \frac{(1-2k)\delta}{2 2!}f&#39;&#39;(x)
            - ...
            -\frac{(1-2k)^{2N-1}\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N}) \\
    \\
    ...
    \\
    f&#39;(x) &amp; = &amp; \frac{-2}{\delta} f(x-\frac{\delta}{2})
                 +\frac{2}{\delta} f(x)
                 + \frac{\delta^2}{22!}f&#39;&#39;(x)
                 + ...
                 + \frac{(-1)^{2N-1}\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                                    + O(\delta^{2N})
                                    \\
    f&#39;(x) &amp; = &amp; \frac{2}{\delta} f(x+\frac{\delta}{2})
                    - \frac{2}{\delta} f(x)
                    - \frac{\delta}{2 2!}f&#39;&#39;(x)
                    - ...
                    -\frac{\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N}) \\
    f&#39;(x) &amp; = &amp; \frac{2}{3\delta} f(x+\frac{3\delta}{2})
                    -\frac{2}{3\delta}f(x)
                    - \frac{3\delta}{2 2!}f&#39;&#39;(x)
                    - ...
                    - \frac{3^{2N-1}\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N})\\
        &amp;...&amp;\\
    f&#39;(x) &amp; = &amp; \frac{2}{l\delta} f(x+\frac{l\delta}{2})
                    -\frac{2}{l\delta} f(x)
                    - \frac{l\delta}{2 2!}f&#39;&#39;(x)
                    - ...
                    - \frac{l^{2N-1}\delta^{2N-1}}{2^{2N-1} (2N)!}f^{(2N)}(x)
                    + O(\delta^{2N})
\end{eqnarray}&lt;/script&gt;&lt;p&gt;add these $f&amp;#x2019;(x)$ proportionally:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{aligned}
    f&#39;(x) =  &amp;
\frac{2}{\delta} \sum \limits_l
    \left[
        f( x+ \frac{ l\delta}{2} )C^{2N}_{k(\frac{l-1}{2})} \frac{1}{l}
    \right]
\\
&amp;-\frac{2}{\delta}f(x) \sum \limits_l \frac{1}{l}    C^{2N}_{k(\frac{l-1}{2})}
-\frac{\delta}{22!}f&#39;&#39;(x)         \sum \limits_l{l}  C^{2N}_{k(\frac{l-1}{2})}
-\frac{\delta^2}{2^23!}f^{(3)}(x) \sum \limits_l{l^2}C^{2N}_{k(\frac{l-1}{2})}
\\
&amp;-\frac{\delta^3}{2^34!}f^{(4)}(x) \sum \limits_l{l^3}C^{2N}_{k(\frac{l-1}{2})}
-...
-\frac{\delta^{2N-1}}{2^{2N-1}(2N)!}f^{(2N)}(x) \sum \limits_l{l^{2N-1}}C^{2N}_{k(\frac{l-1}{2})}
+O({\delta^{2N}})
\\
&amp;(l = 1-2k, 3-2k,...,-1,1,...)
\end{aligned}
\end{equation}&lt;/script&gt;&lt;p&gt;to have 2Nth order accuracy: $C^{2N}_{kj}$ must satisfy equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{bmatrix}
    1 &amp; 1              &amp; 1                           &amp; ... &amp; 1 \\
    \frac{1}{1-2k} &amp; \frac{1}{3-2k} &amp; \frac{1}{5-2k} &amp; ... &amp; \frac{1}{4N-2k+1} \\
    1-2k           &amp; 3-2k           &amp; 5-2k           &amp; ... &amp; 4N-2k+1 \\
    (1-2k)^2       &amp; (3-2k)^2       &amp; (5-2k)^2       &amp; ... &amp; (4N-2k+1)^2 \\
    ...\\
    (1-2k)^{2N-1}  &amp; (3-2k)^{2N-1}  &amp; (5-2k)^{2N-1}  &amp; ... &amp; (4N-2k+1)^{2N-1}
\end{bmatrix}
\begin{bmatrix}
    C^{2N}_{k (-k)   } \\
    C^{2N}_{k (-k+1) } \\
    C^{2N}_{k (-k+2) } \\
    C^{2N}_{k (-k+3) } \\
    ...\\
    C^{2N}_{k (2N-k)}
\end{bmatrix}
=
\begin{bmatrix}
    1\\
    0\\
    0\\
    0\\
    ...\\
    0\\
    \end{bmatrix}
    \label{LA}
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;conclusion&quot;&gt;&lt;a href=&quot;#Conclusion&quot; class=&quot;headerlink&quot; title=&quot;Conclusion&quot;&gt;&lt;/a&gt;Conclusion&lt;/h2&gt;&lt;p&gt;For 2Nth order accuracy, for point k in the boundary region, value of $f&amp;#x2019;(x)$ is:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
f&#39;(x) = 
\frac{2}{l\delta} \sum \limits_l
    \left[
        f( x+ \frac{l\delta}{2} )C^{2N}_{k(\frac{l-1}{2})}
    \right]
    \\
    (l=1-2k,3-2k,...,-1,1,...,4N-2k+1)
\end{equation}&lt;/script&gt;&lt;p&gt;while $C^{2N}_{kj}$ is solution of equation $\eqref{LA}$.&lt;/p&gt;
&lt;p&gt;Or, in the form of:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{cases}
f&#39;(x) = 
\frac{1}{\delta} \sum \limits_l
    \left[
        f( x+ \frac{l\delta}{2} )c^{2N}_{k(\frac{l-1}{2})}
    \right]
    \\
    c^{2N}_{k(\frac{l-1}{2})}  = \frac{2}{l}C^{2N}_{k(\frac{l-1}{2})}
    \\
    (l=1-2k,3-2k,...,-1,1,...,4N-2k+1)
\end{cases}
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;examples&quot;&gt;&lt;a href=&quot;#Examples&quot; class=&quot;headerlink&quot; title=&quot;Examples&quot;&gt;&lt;/a&gt;Examples&lt;/h2&gt;&lt;p&gt;FD scheme corresponding to accuracy orders of 2,4,6,8,10,12 are implemented to $f(x)=sin(x)$, their FD results are ploted versus theoretical first order derivative of $f&amp;#x2019;(x)=cos(x)$, as well as their error.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2016/10/20/finite-difference-staggerGrid2/compare.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;This post presents the asymmetric finite-difference scheme build in staggered grid. This asymmetric scheme works well for processing boundary points.&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
  </entry>
  
  <entry>
    <title>Wave Modeling in Stratified Media</title>
    <link href="http://sheng09.github.io/2016/10/19/waveModelinginStratifiedMedia/"/>
    <id>http://sheng09.github.io/2016/10/19/waveModelinginStratifiedMedia/</id>
    <published>2016-10-19T07:59:00.000Z</published>
    <updated>2017-02-02T09:58:30.908Z</updated>
    
    <content type="html">&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!--toc--&gt;
&lt;p&gt;This post presents wave modeling techniques related to Prof. Kennett&amp;#x2019;s method. Detailed derivation, and analysis are introduced in the book &amp;lt;&lt;seismic wave=&quot;&quot; propagation=&quot;&quot; in=&quot;&quot; stratified=&quot;&quot; media=&quot;&quot;&gt;&amp;gt;, and this post just pay attention to some key points.&lt;/seismic&gt;&lt;/p&gt;
&lt;h1 id=&quot;green-function&quot;&gt;&lt;a href=&quot;#Green-Function&quot; class=&quot;headerlink&quot; title=&quot;Green Function&quot;&gt;&lt;/a&gt;Green Function&lt;/h1&gt;&lt;p&gt;When talking about modeling, what we really pay attention to is the system response of media, the Green Function. It is independent of the source, and only determined by the media.&lt;/p&gt;
&lt;p&gt;In Kennett&amp;#x2019;s method, the main target is to obtain the Green Function of stratified media with a free surface boundary condition. &lt;/p&gt;
&lt;p&gt;Kennett&amp;#x2019;s method is widely used in receiver function research, in which the synthetic Green Function of layers are calculated, and compared with the &amp;#x201C;observed&amp;#x201D; Green Functions,the deconvolution of seismic records. Model is calibrated by some inversion techniques until synthetic data &amp;#x201C;matches&amp;#x201D; observed data, and finally, the most optimal and reasonable model is obtained, as well as error estimation.&lt;/p&gt;
&lt;h1 id=&quot;media-constraint-and-wave-decoupling&quot;&gt;&lt;a href=&quot;#Media-Constraint-and-Wave-decoupling&quot; class=&quot;headerlink&quot; title=&quot;Media Constraint and Wave decoupling&quot;&gt;&lt;/a&gt;Media Constraint and Wave decoupling&lt;/h1&gt;&lt;p&gt;What we pay attention to is horizontally stratified media composed of isotropic and elastic material. This simplification or assumption is reasonable for it approximates the real Earth&amp;#x2019;s structure.&lt;/p&gt;
&lt;p&gt;In isotropic media, the wave could be decoupled into SH wave, and P-SV wave. Moreover, if the media is homogeneous, the P-SV wave could be decoupled. Here comes the key point of wave modeling:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When it is in layer, everything is uniform, so the wave could be decomposed into three independent types of waves, direction of which are pependicular to the others. So we can construct a coordinates system aligning these three direction, the wave propagation is just the changes of phase for each wave component. In equation derivation, the rotation from ordinary XYZ coordinate to wave vector directions is called diagonalization.&lt;/li&gt;
&lt;li&gt;When it is crossing layers (the interface), isotropic condition is satisfied but homogeneous condtion is not, so the wave could be decomposed into SH wave and P-SV wave. So we make two similar derivations, one is for SH wave, which is easier, relatively, and the other is for P-SV wave.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&quot;diagonalization&quot;&gt;&lt;a href=&quot;#Diagonalization&quot; class=&quot;headerlink&quot; title=&quot;Diagonalization&quot;&gt;&lt;/a&gt;Diagonalization&lt;/h1&gt;&lt;p&gt;An interesting problem is what would happen if imaginary items appear in the diagonalized propagation matrix. In fact, imaginary items correspond to $e^{\alpha z + i \beta x}$, the evanescent wave.&lt;/p&gt;
&lt;h1 id=&quot;time-domain-or-frequency-domain&quot;&gt;&lt;a href=&quot;#Time-Domain-or-Frequency-Domain&quot; class=&quot;headerlink&quot; title=&quot;Time Domain or Frequency Domain&quot;&gt;&lt;/a&gt;Time Domain or Frequency Domain&lt;/h1&gt;&lt;p&gt;Frequency domain is choosed for derivation. In frequency domain, time axis is totally rotated by 90 degrees, then we don&amp;#x2019;t need to care which wave happens firstly, and which happens after. In other words, when calculate the wave in one position, we don&amp;#x2019;t need to struggle with all the wave field of the total space happened formly. We just derive the system response of one layer or one interface in frequency domain, and repeate this derivation one layer by one layer, one interface by&lt;br&gt;interface, from surface to bottom or in reverse.&lt;/p&gt;
&lt;p&gt;However, wraparound problems happen for computation in frequency domain. Since the computation is based on discrete space/time, implicit periodic condition exist for discrete fourier transformation(DFT). To avoid this problem, padding zeros is a simple but inconvenient solution. Much better method is employing imaginery frequency, which corresponds to $e^{-\omega_i nT}$ taper to eliminate the fake signal, the effect of DFT.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!--toc--&gt;
&lt;p&gt;This post presents wave modeling techniques related to Prof. Kennett&amp;#x2019;s method. Detailed derivation, a
    
    </summary>
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/categories/Receiver-Function/"/>
    
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/tags/Receiver-Function/"/>
    
      <category term="Digital Signal Processing" scheme="http://sheng09.github.io/tags/Digital-Signal-Processing/"/>
    
      <category term="Modeling" scheme="http://sheng09.github.io/tags/Modeling/"/>
    
  </entry>
  
  <entry>
    <title>Finite Difference of Staggered Grid (1)</title>
    <link href="http://sheng09.github.io/2016/10/18/finite-difference-staggerGrid/"/>
    <id>http://sheng09.github.io/2016/10/18/finite-difference-staggerGrid/</id>
    <published>2016-10-17T20:15:09.000Z</published>
    <updated>2017-01-21T15:55:02.183Z</updated>
    
    <content type="html">&lt;p&gt;This post presents the central finite difference(FD) system build in stagger grid. Symmetric scheme are derived and examples are presented.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#taylor-expansion&quot;&gt;Taylor expansion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#first-order-derivatives&quot;&gt;First order derivatives&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#examples&quot;&gt;Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;taylor-expansion&quot;&gt;&lt;a href=&quot;#Taylor-expansion&quot; class=&quot;headerlink&quot; title=&quot;Taylor expansion&quot;&gt;&lt;/a&gt;Taylor expansion&lt;/h2&gt;&lt;p&gt;As always, we start the derivation from taylor expansion. For the $\color{red}{red}$ points in the below staggerd point, function value here have the form of taylor series expanded in the $\color{blue}{blue}$ point. This kind of stagger grid scheme is widely used in modeling.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2016/10/18/finite-difference-staggerGrid/img.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
f\left(x-\frac{i\delta}{2}\right) &amp; = &amp; f(x) - \frac{i\delta}{2}f&#39;(x)
                                    + \frac{i^2\delta^2}{2^22!}f&#39;&#39;(x)
                                    - \frac{i^3\delta^3}{2^33!}f^{(3)}(x)
                                    %+ \frac{i^4\delta^4}{2^44!}f^{(4)}(x)
                                    + ...
                                    + \frac{i^{2N}\delta^{2N}}{2^{2N}(2N)!}f^{(2N)}(x)
                                    + O(\delta^{2N+1})
                                    \\
&amp; ... &amp;\\
f\left(x-\frac{\delta}{2}\right) &amp; = &amp; f(x) - \frac{\delta}{2}f&#39;(x)
                                    + \frac{\delta^2}{2^22!}f&#39;&#39;(x)
                                    - \frac{\delta^3}{2^33!}f^{(3)}(x)
                                    %+ \frac{\delta^4}{2^44!}f^{(4)}(x)
                                    + ...
                                    + \frac{\delta^{2N}}{2^{2N}(2N)!}f^{(2N)}(x)
                                    + O(\delta^{2N+1})
                                    \\
f\left(x+\frac{\delta}{2}\right) &amp; = &amp; f(x) + \frac{\delta}{2}f&#39;(x)
                                    + \frac{\delta^2}{2^22!}f&#39;&#39;(x)
                                    + \frac{\delta^3}{2^33!}f^{(3)}(x)
                                    %+ \frac{\delta^4}{2^44!}f^{(4)}(x)
                                    + ...
                                    + \frac{\delta^{2N}}{2^{2N}(2N)!}f^{(2N)}(x)
                                    + O(\delta^{2N+1})
                                    \\
&amp; ... &amp;\\
f\left(x+\frac{i\delta}{2}\right) &amp; = &amp; f(x) + \frac{i\delta}{2}f&#39;(x)
                                    + \frac{i^2\delta^2}{2^22!}f&#39;&#39;(x)
                                    + \frac{i^3\delta^3}{2^33!}f^{(3)}(x)
                                    %+ \frac{i^4\delta^4}{2^44!}f^{(4)}(x)
                                    + ...
                                    + \frac{i^{2N}\delta^{2N}}{2^{2N}(2N)!}f^{(2N)}(x)
                                    + O(\delta^{2N+1})
\\
\color{red}{\left(i =1,3,5,7,9...\right)}
\\
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;first-order-derivatives&quot;&gt;&lt;a href=&quot;#First-order-derivatives&quot; class=&quot;headerlink&quot; title=&quot;First order derivatives&quot;&gt;&lt;/a&gt;First order derivatives&lt;/h2&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\frac{f\left(x+\frac{\delta}{2}\right) - f\left(x-\frac{\delta}{2}\right)}{2}
    &amp; = &amp; \frac{\delta}{2}f&#39;(x)
        + \frac{\delta^3}{2^33!}f^{(3)}(x)
        + ...
        + \frac{\delta^{2N-1}}{2^{2N-1}(2N-1)!}f^{(2N-1)}(x)
        + O(\delta^{2N+1})
        \\
&amp;...&amp;\\
\frac{ f\left(x+\frac{i\delta}{2}\right) - f\left(x-\frac{i\delta}{2}\right) }{2}
    &amp; = &amp; \frac{i\delta}{2}f&#39;(x)
        + \frac{i^3\delta^3}{2^33!}f^{(3)}(x)
        + ...
        + \frac{i^{2N-1}\delta^{2N-1}}{2^{2N-1}(2N-1)!}f^{(2N-1)}(x)
        + O(\delta^{2N+1})
        \\
\color{red}{\left(i=1,3,5,7,9...\right)}
\\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;or in the forms of:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
f&#39;(x) &amp; = &amp;
    \frac{f\left(x+\frac{\delta}{2}\right) - f\left(x-\frac{\delta}{2}\right)}{\delta}
        - \frac{\delta^2}{2^23!}f^{(3)}(x)
        - ...
        - \frac{\delta^{2N-2}}{2^{2N-2}(2N-1)!}f^{(2N-1)}(x)
        + O(\delta^{2N})
        \\
&amp;...&amp;\\
f&#39;(x) &amp; = &amp;
\frac{ f\left(x+\frac{i\delta}{2}\right) - f\left(x-\frac{i\delta}{2}\right) }{i\delta}
        - \frac{i^2\delta^2}{2^23!}f^{(3)}(x)
        - ...
        - \frac{i^{2N-2}\delta^{2N-2}}{2^{2N-2}(2N-1)!}f^{(2N-1)}(x)
        + O(\delta^{2N})
        \\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;adding all these $f&amp;#x2019;(x)$ propotionally together:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{aligned}
    f&#39;(x) \sum \limits_{i} C_i
     = &amp;\sum \limits_{i} C_i
            \frac{ f\left(x+\frac{i\delta}{2}\right) - f\left(x-\frac{i\delta}{2}\right) }{i\delta}\\
        &amp;- \frac{\delta^2}{2^23!}f^{(3)}(x) \sum \limits_i i^2C_i
         - \frac{\delta^4}{2^45!}f^{(5)}(x) \sum \limits_i i^4C_i
         %- \frac{\delta^6}{2^67!}f^{(7)}(x) \sum \limits_i i^6C_i
         - \frac{\delta^{2N-2}}{2^{2N-2}(2N-1)!}f^{(2N-1)}(x) \sum \limits_i i^{2N-2}C_i
         + O(\delta^{2N})
\end{aligned}\label{fd1} \\
\color{red}{\left(i=1,3,5,7,9...,2N-1\right)}
\end{equation}&lt;/script&gt;&lt;p&gt;So, for $2N$th order accuracy, $C_k$ must be the solution of linear equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1 &amp; 1           &amp; 1         &amp; 1         &amp; ... &amp; 1\\
        1 &amp; 3^2         &amp; 5^2       &amp; 7^2       &amp; ... &amp; (2N-1)^2     \\
        1 &amp; 3^4         &amp; 5^4       &amp; 7^4       &amp; ... &amp; (2N-1)^4     \\
        ...\\
        1 &amp; 3^{2N-2}    &amp; 5^{2N-2}  &amp; 7^{2N-2}  &amp; ... &amp; (2N-1)^{2N-2}\\
    \end{bmatrix}
    \begin{bmatrix}
        C_1\\
        C_3\\
        C_5\\
        ...\\
        C_{2N-1}\\
    \end{bmatrix}
    =
    \begin{bmatrix}
    1\\
    0\\
    0\\
    ...\\
    0\\
    \end{bmatrix}
    \label{LA}
\end{equation}&lt;/script&gt;&lt;p&gt;$\eqref{LA}$ is the &lt;a href=&quot;http://sheng09.github.io/2016/10/15/vandermonde&quot;&gt;vandermonde equation&lt;/a&gt;, its augmented matrix corresponds to the upper triangular linear equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1 &amp; 1 &amp; 1      &amp; 1      &amp; ... &amp; 1      \\
        0 &amp; 1 &amp; a_{23} &amp; a_{24} &amp; ... &amp; a_{2N} \\
        0 &amp; 0 &amp; 1      &amp; a_{34} &amp; ... &amp; a_{3N} \\
        ...\\
        0 &amp; 0 &amp; 0      &amp; 0      &amp; ... &amp; 1 \\
    \end{bmatrix}
    \begin{bmatrix}
        x_1\\
        x_2\\
        x_3\\
        ...\\
        x_N\\
    \end{bmatrix}
    =
    \begin{bmatrix}
    b_1\\
    b-2\\
    b-3\\
    ...\\
    b_N\\
    \end{bmatrix}
\end{equation}&lt;/script&gt;&lt;p&gt;while&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    a_{ij} &amp; = &amp; \frac{ \left[ (2j-1)^2-(2i-3)^2    \right]
                    \left[  (2j-1)^2-(2i-5)^2   \right]
                    ...
                    \left[(2j-1)^2-1            \right]  }
                {   \left[ (2i-1)^2 - (2i-3)^2  \right]
                    \left[ (2i-1)^2 - (2i-5)^2  \right]
                    ...
                    \left[ (2i-1)^2 - 1         \right]  }
                (j \geq i)
    \\
    b_i &amp; = &amp; \frac
                    {   (-1)^{i-1}1^23^2...(2i-3)^2     }
                    {   \left[ (2i-1)^2 - (2i-3)^2  \right]
                    \left[ (2i-1)^2 - (2i-5)^2  \right]
                    ...
                    \left[ (2i-1)^2 - 1         \right]  }
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Thus, $x_i$ have the value of:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{cases}
    x_i= C_{2i-1} = b_i - \sum \limits_{j=i+1}^N a_{ij}x_j
    \\
    x_N = C_{2N-1} = b_N
\end{cases}
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;conclusion&quot;&gt;&lt;a href=&quot;#Conclusion&quot; class=&quot;headerlink&quot; title=&quot;Conclusion&quot;&gt;&lt;/a&gt;Conclusion&lt;/h2&gt;&lt;p&gt;From $\eqref{fd1}$, the FD scheme of 2Nth order accuracy is built:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x) &amp; = &amp;\sum \limits_{i} C_i
            \frac{ f\left(x+\frac{i\delta}{2}\right) - f\left(x-\frac{i\delta}{2}\right) }{i\delta}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;or in the form of:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{cases}
    f&#39;(x) &amp; = &amp; \frac{1}{\delta} &amp;\sum \limits_{i}
            c_i
            \left[
                f\left(x+\frac{i\delta}{2}\right)
                - f\left(x-\frac{i\delta}{2}\right)
            \right]
    \\
    c_i &amp; = &amp; \frac{C_i}{i}\\
    \color{red}{\left(i =1,3,5,7,9...\right)}
\end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Values of $c_i$ for different accuracy order are:&lt;/p&gt;
&lt;div class=&quot;table-container&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;order&lt;/th&gt;
&lt;th&gt;$c_1$&lt;/th&gt;
&lt;th&gt;$c_2$&lt;/th&gt;
&lt;th&gt;$c_3$&lt;/th&gt;
&lt;th&gt;$c_4$&lt;/th&gt;
&lt;th&gt;$c_5$&lt;/th&gt;
&lt;th&gt;$c_6$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;$\frac{1}{1}$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;$\frac{9}{8}$&lt;/td&gt;
&lt;td&gt;$\frac{-1}{24}$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;$\frac{75}{64}$&lt;/td&gt;
&lt;td&gt;$\frac{-25}{384}$&lt;/td&gt;
&lt;td&gt;$\frac{3}{640}$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;$\frac{1225}{1024}$&lt;/td&gt;
&lt;td&gt;$\frac{-245}{3072}$&lt;/td&gt;
&lt;td&gt;$\frac{49}{5120}$&lt;/td&gt;
&lt;td&gt;$\frac{-5}{7168}$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;$\frac{19845}{16384}$&lt;/td&gt;
&lt;td&gt;$\frac{-735}{8192}$&lt;/td&gt;
&lt;td&gt;$\frac{567}{40960}$&lt;/td&gt;
&lt;td&gt;$\frac{-405}{229376}$&lt;/td&gt;
&lt;td&gt;$\frac{35}{294912}$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;$\frac{160083}{131072}$&lt;/td&gt;
&lt;td&gt;$\frac{-12705}{131072}$&lt;/td&gt;
&lt;td&gt;$\frac{22869}{1310720}$&lt;/td&gt;
&lt;td&gt;$\frac{-5445}{1835008}$&lt;/td&gt;
&lt;td&gt;$\frac{847}{2359296}$&lt;/td&gt;
&lt;td&gt;$\frac{-63}{2883584}$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&quot;examples&quot;&gt;&lt;a href=&quot;#Examples&quot; class=&quot;headerlink&quot; title=&quot;Examples&quot;&gt;&lt;/a&gt;Examples&lt;/h2&gt;&lt;p&gt;FD scheme corresponding to accuracy orders of 2,4,6,8,10,12 are implemented to $f(x) = sin(x)$, their FD results are ploted versus theoretical first order derivative of $f&amp;#x2019;(x) = cos(x)$, as well as their error.&lt;br&gt;&lt;img src=&quot;/2016/10/18/finite-difference-staggerGrid/fd1_sym_staggered.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;This post presents the central finite difference(FD) system build in stagger grid. Symmetric scheme are derived and examples are presented.&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="error" scheme="http://sheng09.github.io/tags/error/"/>
    
  </entry>
  
  <entry>
    <title>Asymmetric Finite Difference for Boundary Points</title>
    <link href="http://sheng09.github.io/2016/10/17/finite-difference-asymmetric/"/>
    <id>http://sheng09.github.io/2016/10/17/finite-difference-asymmetric/</id>
    <published>2016-10-16T18:02:22.000Z</published>
    <updated>2017-01-21T13:41:15.772Z</updated>
    
    <content type="html">&lt;p&gt;For $2i$th order accuracy finite difference(FD), symmetric scheme cannot apply to $i$ boundary points. Thus, asymmetric scheme are required.&lt;br&gt;&lt;img src=&quot;/2016/10/17/finite-difference-asymmetric/img.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#2nd-order-accuracy&quot;&gt;2nd order accuracy&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#point-0&quot;&gt;point 0&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2ith-order-accuracy&quot;&gt;2ith order accuracy&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#point-0&quot;&gt;point 0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#point-1&quot;&gt;point 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#point-k-k01i-1&quot;&gt;point k (k=0,1,&amp;#x2026;,i-1)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#result&quot;&gt;Result&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#examples&quot;&gt;Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;p&gt;Let us take 2nd order FD as example:&lt;/p&gt;
&lt;h2 id=&quot;2nd-order-accuracy&quot;&gt;&lt;a href=&quot;#2nd-order-accuracy&quot; class=&quot;headerlink&quot; title=&quot;2nd order accuracy&quot;&gt;&lt;/a&gt;2nd order accuracy&lt;/h2&gt;&lt;h3 id=&quot;point-0&quot;&gt;&lt;a href=&quot;#point-0&quot; class=&quot;headerlink&quot; title=&quot;point 0&quot;&gt;&lt;/a&gt;point 0&lt;/h3&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f(x) &amp; = &amp; f(x)\\
    f(x+\delta ) &amp; = &amp; f(x) +  \delta  f&#39;(x) +
                            \frac{\delta ^2}{2!}  f&#39;&#39;(x)  +
                            \frac{\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{\delta ^n}{n!}  f^{(n)} (x)  +
                            O(\delta^{n+1})\\
    f(x+2\delta ) &amp; = &amp; f(x) +  2\delta  f&#39;(x) +
                            \frac{2^2\delta ^2}{2!}  f&#39;&#39;(x)  +
                            \frac{2^3\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{2^n\delta ^n}{n!}  f^{(n)} (x)  +
                            O(\delta^{n+1})\\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Thus, $f&amp;#x2019;(x)$ is:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x;\delta) &amp; = &amp; \frac{f(x+\delta )- f(x) } {\delta}
                -\frac{\delta   }{2!}  f&#39;&#39;(x)
                -\frac{\delta ^2}{3!}  f^{(3)} (x)
                -...
                -\frac{\delta ^{n-1}}{n!}  f^{(n)} (x)
                +O(\delta^{n})\\
    f&#39;(x;2\delta) &amp; = &amp; \frac{f(x+2\delta )- f(x) } {2\delta}
                -\frac{2\delta   }{2!}  f&#39;&#39;(x)
                -\frac{2^2\delta ^2}{3!}  f^{(3)} (x)
                -...
                -\frac{2^{n-1}\delta ^{n-1}}{n!}  f^{(n)} (x)
                +O(\delta^{n})\\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;adding $f&amp;#x2019;(x;\delta)$ and $f&amp;#x2019;(x;2\delta)$ proportionally:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{cases}
    \begin{aligned}
        f&#39;(x) = &amp;    C_{21}\frac{f(x+\delta )- f(x) } {\delta}
                    +C_{22}\frac{f(x+2\delta )- f(x) } {2\delta} \\
                &amp;-\frac{\delta  }{2!}f&#39;&#39;(x) \left[ C_{21} + 2C_{22}\right]
                 -...
                 -\frac{\delta^{n-1}}{n!}f^{(n)}(x) \left[C_{21} +2^{n-1}C_{22}\right]
                 +O(\delta^{n})\\
        1 = &amp; C_{21} + C_{22}
        \end{aligned}\\
    \end{cases}
\end{equation}&lt;/script&gt;&lt;p&gt;Thus, for 2nd order accuracy, item of $\delta$ should be eliminated, so:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{cases}
    C_{21} + C_{22}  &amp; = &amp; 1 \\
    C_{21} + 2C_{22} &amp; = &amp; 0 \\
\end{cases}
\Rightarrow
\begin{cases}
    C_{21} &amp; = &amp; 2 \\
    C_{22} &amp; = &amp; -1 \\
\end{cases}
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;2ith-order-accuracy&quot;&gt;&lt;a href=&quot;#2ith-order-accuracy&quot; class=&quot;headerlink&quot; title=&quot;2ith order accuracy&quot;&gt;&lt;/a&gt;2ith order accuracy&lt;/h2&gt;&lt;h3 id=&quot;point-0&quot;&gt;&lt;a href=&quot;#point-0-1&quot; class=&quot;headerlink&quot; title=&quot;point 0&quot;&gt;&lt;/a&gt;point 0&lt;/h3&gt;&lt;p&gt;For point 0, we have:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f(x) &amp; = &amp; f(x)\\
    f(x+\delta ) &amp; = &amp; f(x) +  \delta  f&#39;(x) +
                            \frac{\delta ^2}{2!}  f&#39;&#39;(x)  +
                            \frac{\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{\delta ^{2i}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i+1})\\
    f(x+2\delta ) &amp; = &amp; f(x) +  2\delta  f&#39;(x) +
                            \frac{2^2\delta ^2}{2!}  f&#39;&#39;(x)  +
                            \frac{2^3\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{2^{2i}\delta ^{2i}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i+1})\\
    f(x+3\delta ) &amp; = &amp; f(x) +  3\delta  f&#39;(x) +
                            \frac{3^2\delta ^2}{2!}  f&#39;&#39;(x)  +
                            \frac{3^3\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{3^{2i}\delta ^{2i}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i+1})\\
    &amp;...&amp;\\
    f(x+2i\delta ) &amp; = &amp; f(x) +  2i\delta  f&#39;(x) +
                            \frac{(2i)^2\delta ^2}{2!}  f&#39;&#39;(x)  +
                            \frac{(2i)^3\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{(2i)^{2i}\delta ^{2i}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i+1})\\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Thus, $f&amp;#x2019;(x)$ is:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x;\delta) &amp; = &amp; \frac {f(x+\delta ) - f(x)}{\delta}
                            -\frac{\delta   }{2!}  f&#39;&#39;(x)
                            -\frac{\delta ^2}{3!}  f^{(3)} (x)
                            -...
                            -\frac{\delta ^{2i-1}}{(2i)!}  f^{(2i)} (x)
                            +O(\delta^{2i})\\
    f&#39;(x;2\delta) &amp; = &amp; \frac {f(x+2\delta ) - f(x)}{2\delta}
                            -\frac{2  \delta  }{2!}  f&#39;&#39;(x)
                            -\frac{2^2\delta ^2}{3!}  f^{(3)} (x)
                            -...
                            -\frac{2^{2i-1}\delta ^{2i-1}}{(2i)!}  f^{(2i)} (x)
                            +O(\delta^{2i})\\
    f&#39;(x;3\delta) &amp; = &amp; \frac {f(x+3\delta ) -f(x)} {3\delta}
                            -\frac{3  \delta   }{2!}  f&#39;&#39;(x)
                            -\frac{3^2\delta ^2}{3!}  f^{(3)} (x)
                            -...
                            -\frac{3^{2i-1}\delta ^{2i-1}}{(2i)!}  f^{(2i)} (x)
                            +O(\delta^{2i})\\
    &amp;...&amp;\\
    f&#39;(x;2i\delta) &amp; = &amp; \frac{f(x+2i\delta ) - f(x)}{2i\delta  }
                            -\frac{ 2i \delta     }{2!}  f&#39;&#39;(x)
                            -\frac{(2i)^2\delta ^2}{3!}  f^{(3)} (x)
                            -...
                            -\frac{(2i)^{2i-1}\delta ^{2i-1}}{(2i)!}  f^{(2i)} (x)
                            + O(\delta^{2i})\\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;adding $f&amp;#x2019;(x;\delta), f&amp;#x2019;(x;2\delta),&amp;#x2026;,f&amp;#x2019;(x;2i\delta)$ proportionally:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{aligned}
    f&#39;(x) = &amp; \sum \limits_{j=1}^{2i} C_{(2i)j} \frac { f(x+j\delta) -f(x) }{j\delta} \\
            &amp; -  \frac{\delta       }{ 2!}f&#39;&#39;(x) \sum \limits_{j=1}^{2i}C_{(2i)j}j
              -  \frac{\delta^2     }{ 3!}f^{(3)}(x) \sum \limits_{j=1}^{2i}C_{(2i)j}j^2
              - ...
              -  \frac{\delta^{2i-1}}{(2i)!}f^{(2i)}(x)\sum \limits_{j=1}^{2i}C_{(2i)j}j^{2i-1}
              + O(\delta^{2i})\\

\end{aligned}
\end{equation}&lt;/script&gt;&lt;p&gt;Thus, for 2ith order accuracy, item of $\delta,\delta^2,&amp;#x2026;,\delta^{2i-1}$ should be eliminated, so:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
% \begin{eqnarray}
% \begin{cases}
%     \sum \limits_{j=1}^{2i} C_{(2i)j}    = 1 \\
%     \sum \limits_{j=1}^{2i} C_{(2i)j}j   = 0 \\
%     \sum \limits_{j=1}^{2i} C_{(2i)j}j^2 = 0 \\
%     ...\\
%     \sum \limits_{j=1}^{2i} C_{(2i)j}j^{2i-1} = 0 \\
% \end{cases}
% \end{eqnarray}&lt;/script&gt;&lt;!-- or in matrix form: --&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{bmatrix}
        1 &amp; 1        &amp; 1        &amp; 1        &amp; ... &amp; 1           \\
        1 &amp; 2        &amp; 3        &amp; 4        &amp; ... &amp; 2i          \\
        1 &amp; 2^2      &amp; 3^2      &amp; 4^2      &amp; ... &amp; (2i)^2      \\
        ...\\
        1 &amp; 2^{2i-1} &amp; 3^{2i-1} &amp; 4^{2i-1} &amp; ... &amp; (2i)^{2i-1} \\
    \end{bmatrix}
    \begin{bmatrix}
        C_{(2i)1}\\
        C_{(2i)2}\\
        C_{(2i)3}\\
        ...\\
        C_{(2i)(2i)}\\
    \end{bmatrix}
    =
    \begin{bmatrix}
    1\\
    0\\
    0\\
    ...\\
    0\\
    \end{bmatrix}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
%\begin{eqnarray}
%    \begin{bmatrix}
%        1 &amp; 1        &amp; 1        &amp; 1        &amp; ... &amp; 1           \\
%        1 &amp; 2        &amp; 3        &amp; 4        &amp; ... &amp; N          \\
%        1 &amp; 2^2      &amp; 3^2      &amp; 4^2      &amp; ... &amp; N^2      \\
%        ...\\
%        1 &amp; 2^{N-1} &amp; 3^{N-1} &amp; 4^{N-1} &amp; ... &amp; N^{N-1} \\
%    \end{bmatrix}
%    \begin{bmatrix}
%        C_{N1}\\
%        C_{N2}\\
%        C_{N3}\\
%        ...\\
%        C_{NN}\\
%    \end{bmatrix}
%    =
%    \begin{bmatrix}
%    1\\
%    0\\
%    0\\
%    ...\\
%    0\\
%    \end{bmatrix}
%\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;point-1&quot;&gt;&lt;a href=&quot;#point-1&quot; class=&quot;headerlink&quot; title=&quot;point 1&quot;&gt;&lt;/a&gt;point 1&lt;/h3&gt;&lt;p&gt;&amp;#x2026;&lt;/p&gt;
&lt;h3 id=&quot;point-k-k01i-1&quot;&gt;&lt;a href=&quot;#point-k-k-0-1-&amp;#x2026;-i-1&quot; class=&quot;headerlink&quot; title=&quot;point k (k=0,1,&amp;#x2026;,i-1)&quot;&gt;&lt;/a&gt;point k (k=0,1,&amp;#x2026;,i-1)&lt;/h3&gt;&lt;p&gt;For point k, we have:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f(x-k\delta) &amp; = &amp; f(x) - k\delta f&#39;(x) +
                        \frac{ (-k)^2\delta^2 }{2!} f&#39;&#39;(x) +
                        ... +
                        \frac{(-k)^{2i}\delta^{2i}}{(2i)!}  f^{(2i)} (x)  +
                        O(\delta^{2i+1})\\
    ...\\
    f(x-\delta ) &amp; = &amp; f(x) -  \delta  f&#39;(x) +
                        \frac{(-1)^2\delta ^2}{2!}  f&#39;&#39;(x)  +
                        ... +
                        \frac{(-1)^{2i}\delta^{2i}}{(2i)!}  f^{(2i)} (x)  +
                        O(\delta^{2i+1})\\
    f(x) &amp; = &amp; f(x)\\
    f(x+\delta ) &amp; = &amp; f(x) +  \delta  f&#39;(x) +
                            \frac{\delta ^2}{2!}  f&#39;&#39;(x)  +
                            %\frac{\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{\delta ^{2i}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i+1})\\
    ...\\
    f(x+(2i-k)\delta) &amp; = &amp; f(x) +  (2i-k)\delta  f&#39;(x) +
                            \frac{(2i-k)^2 \delta ^2}{2!}  f&#39;&#39;(x)  +
                            %\frac{(2i-k)^3 \delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{(2i-k)^{2i}\delta ^{2i}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i+1})\\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Thus, $f&amp;#x2019;(x)$ is:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x) &amp; = &amp; \frac{f(x-k\delta) - f(x)}{- k\delta }
                        -\frac{ (-k)\delta }{2!} f&#39;&#39;(x) -
                        ...
                        -\frac{(-k)^{2i-1}\delta^{2i-1}}{(2i)!}  f^{(2i)} (x)  +
                        O(\delta^{2i})\\
    ...\\
    f&#39;(x) &amp; = &amp; \frac{f(x-\delta ) - f(x)}{-  \delta  }
                        -\frac{-\delta}{2!}  f&#39;&#39;(x)  -
                        ...-
                        -\frac{(-1)^{2i-1}\delta^{2i-1}}{(2i)!}  f^{(2i)} (x)  +
                        O(\delta^{2i})\\
    f&#39;(x) &amp; = &amp; \frac{f(x+\delta ) - f(x)}{\delta  }
                            -\frac{\delta}{2!}  f&#39;&#39;(x)
                            - ...
                            - \frac{\delta ^{2i-1}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i})\\
    ...\\
    f&#39;(x) &amp; = &amp; \frac{f(x+(2i-k)\delta)-f(x)}{(2i-k)\delta  }
                            -\frac{(2i-k) \delta }{2!}  f&#39;&#39;(x)
                            -...
                            -\frac{(2i-k)^{2i-1}\delta ^{2i-1}}{(2i)!}  f^{(2i)} (x)  +
                            O(\delta^{2i})\\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;adding all these $f&amp;#x2019;(x)$ proportionally:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{aligned}
        f&#39;(x) = &amp; \sum \limits_{j=-k}^{2i-k} C^k_{(2i)j} \frac{ f(x+j\delta)-f(x) }{j\delta}\\
                &amp;-   \frac{\delta}{2!}f&#39;&#39;(x) \sum\limits_{j=-k}^{2i-k}jC^k_{(2i)j}
                 -   \frac{\delta^2}{3!}f^{(3)}(x) \sum\limits_{j=-k}^{2i-k}j^2C^k_{(2i)j}
                 -   ...
                 -   \frac{\delta^{2i-1}}{(2i)!}f^{(2i)}(x) \sum \limits_{j=-k}^{2i-k}j^{2i-1}C^k_{(2i)j}
    \end{aligned}
\end{equation}&lt;/script&gt;&lt;p&gt;Thus, for 2ith order accuracy, item of $\delta,\delta^2,&amp;#x2026;,\delta^{2i-1}$ should be eliminated, so:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{bmatrix}
        1      &amp; 1       &amp;... &amp;   1    &amp;  1  &amp; ... &amp; 1                \\
        -k     &amp; -k+1    &amp;... &amp;  -1    &amp;  1  &amp; ... &amp; 2i-k             \\
        (-k)^2 &amp;(-k+1)^2 &amp;... &amp; (-1)^2 &amp; 1^2 &amp; ... &amp; (2i-k)^2         \\
        (-k)^3 &amp;(-k+1)^3 &amp;... &amp; (-1)^2 &amp; 1^3 &amp; ... &amp; (2i-k)^3         \\
        ...\\
        (-k)^{2i-1} &amp; (-k+1)^{2i-1} &amp; ... &amp;(-1)^{2i-1} &amp; 1^{2i-1} &amp; ... &amp; (2i-k)^{2i-1}
    \end{bmatrix}
    \begin{bmatrix}
    C^k_{(2i)(-k)}   \\
    C^k_{(2i)(-k+1)} \\
    C^k_{(2i)(-k+2)} \\
    ...\\
    C^k_{(2i)(-1)}   \\
    C^k_{(2i)1}      \\
    ...\\
    C^k_{(2i)(2i-k)}
    \end{bmatrix}
    =
    \begin{bmatrix}
    1\\
    0\\
    0\\
    ...\\
    0\\
    \end{bmatrix}
    \label{LA}
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;result&quot;&gt;&lt;a href=&quot;#Result&quot; class=&quot;headerlink&quot; title=&quot;Result&quot;&gt;&lt;/a&gt;Result&lt;/h2&gt;&lt;p&gt;For $2i$th order FD accuracy, the $k$th$(k=0,1,2,&amp;#x2026;,i-1)$ boundary points, $C^k_{(2i)(j)}$ $(j=-k,-k+1,&amp;#x2026;,-1,1,&amp;#x2026;,2i-k)$ is the solution of $\eqref{LA}$, while&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{aligned}
        f&#39;(x) = &amp; \sum \limits_{j=-k}^{2i-k} C^k_{(2i)j} \frac{ f(x+j\delta)-f(x) }{j\delta}\\
    \end{aligned}
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;examples&quot;&gt;&lt;a href=&quot;#Examples&quot; class=&quot;headerlink&quot; title=&quot;Examples&quot;&gt;&lt;/a&gt;Examples&lt;/h2&gt;&lt;p&gt;FD scheme corresponding to accuracy orders of 2,4,6,8,10,12 are implemented to $f(x) = sin(x)$, their FD results are ploted versus theoretical first order derivative of $f&amp;#x2019;(x) = cos(x)$, as well as their error.&lt;br&gt;&lt;img src=&quot;/2016/10/17/finite-difference-asymmetric/fd1_asym.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;For $2i$th order accuracy finite difference(FD), symmetric scheme cannot apply to $i$ boundary points. Thus, asymmetric scheme are required.&lt;br&gt;&lt;img src=&quot;/2016/10/17/finite-difference-asymmetric/img.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="error" scheme="http://sheng09.github.io/tags/error/"/>
    
  </entry>
  
  <entry>
    <title>Solving Vandermonde Equation for FD</title>
    <link href="http://sheng09.github.io/2016/10/15/vandermonde/"/>
    <id>http://sheng09.github.io/2016/10/15/vandermonde/</id>
    <published>2016-10-14T19:07:44.000Z</published>
    <updated>2017-01-21T13:39:36.239Z</updated>
    
    <content type="html">&lt;p&gt;This post presents how to solve vandermonde equation in finite-difference.&amp;#x3000;For 2N order accuracy &lt;a href=&quot;http://sheng09.github.io/2016/10/13/finite-difference/#conclusion&quot;&gt;finite-difference of derivatives&lt;/a&gt;, $C_k(k=1,2,&amp;#x2026;,N)$ is the solution of a vandermonde equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1        &amp; 1        &amp; 1        &amp; ... &amp; 1        \\
        1^2      &amp; 2^2      &amp; 3^2      &amp; ... &amp; N^2      \\
        1^4      &amp; 2^4      &amp; 3^4      &amp; ... &amp; N^4      \\
        1^6      &amp; 2^6      &amp; 3^6      &amp; ... &amp; N^6      \\
        ... \\
        1^{2N-2} &amp; 2^{2N-2} &amp; 3^{2N-2} &amp; ... &amp; N^{2N-2}
    \end{bmatrix}
    \begin{bmatrix}
        C_1 \\ C_2 \\ C_3 \\ C_4 \\ ... \\ C_N
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 \\ 0 \\ 0 \\ 0 \\ ... \\ 0
    \end{bmatrix}
    \label{equ}
\end{equation}&lt;/script&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#gaussian-elimination&quot;&gt;Gaussian Elimination&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#step-1&quot;&gt;Step 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#step-2&quot;&gt;Step 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#step-3&quot;&gt;Step 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#step-k&quot;&gt;Step k&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#step-n-1&quot;&gt;Step N-1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#result&quot;&gt;Result&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#value-and-program&quot;&gt;Value and Program&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;gaussian-elimination&quot;&gt;&lt;a href=&quot;#Gaussian-Elimination&quot; class=&quot;headerlink&quot; title=&quot;Gaussian Elimination&quot;&gt;&lt;/a&gt;Gaussian Elimination&lt;/h2&gt;&lt;p&gt;This linear equation could be solved by gaussian elimination.&lt;br&gt;Augmented matrix of linear equation $\eqref{equ}$ is:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1^0 &amp; 2^0 &amp; 3^0 &amp; 4^0 &amp; 5^0 &amp; 6^0 &amp; ... &amp; N^0 &amp; 1\\
        1^2 &amp; 2^2 &amp; 3^2 &amp; 4^2 &amp; 5^2 &amp; 6^2 &amp; ... &amp; N^2 &amp; 0\\
        1^4 &amp; 2^4 &amp; 3^4 &amp; 4^4 &amp; 5^4 &amp; 6^4 &amp; ... &amp; N^4 &amp; 0\\
        1^6 &amp; 2^6 &amp; 3^6 &amp; 4^6 &amp; 5^6 &amp; 6^6 &amp; ... &amp; N^6 &amp; 0\\
        1^8 &amp; 2^8 &amp; 3^8 &amp; 4^8 &amp; 5^8 &amp; 6^8 &amp; ... &amp; N^8 &amp; 0\\
        ... \\
        1^{2N-2} &amp; 2^{2N-2} &amp; 3^{2N-2} &amp; ... &amp; ...&amp; ...&amp; ... &amp; N^{2N-2} &amp; 0 \\
    \end{bmatrix}
\end{equation}&lt;/script&gt;&lt;p&gt;An upper triangular matrix could be obtained by subtracting the row $(i+1)$  from row $i$:&lt;/p&gt;
&lt;h3 id=&quot;step-1&quot;&gt;&lt;a href=&quot;#Step-1&quot; class=&quot;headerlink&quot; title=&quot;Step 1&quot;&gt;&lt;/a&gt;Step 1&lt;/h3&gt;&lt;p&gt;$row(i+1) - row(i) [i=1,2,3,4,5,&amp;#x2026;,N-1] $&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1^0 &amp; 2^0              &amp; 3^0                 &amp; ... &amp; N^0            &amp; 1   \\
        0   &amp; 2^2-1            &amp; 3^2-1               &amp; ... &amp; N^2-1          &amp;-1   \\
        0   &amp; 2^2(2^2-1)       &amp; 3^2(3^2-1)          &amp; ... &amp; N^2(N^2-1)     &amp; 0   \\
        0   &amp; 2^4(2^2-1)       &amp; 3^4(3^2-1)          &amp; ... &amp; N^4(N^2-1)     &amp; 0   \\
        0   &amp; 2^6(2^2-1)       &amp; 3^6(3^2-1)          &amp; ... &amp; N^6(N^2-1)     &amp; 0   \\
        ... \\
        0   &amp; 2^{2N-4}(2^2-1)  &amp; 3^{2N-4}(3^2-1) 　&amp; ... &amp; N^{2N-4}(N^2-1)&amp; 0   \\
    \end{bmatrix}
\end{equation}&lt;/script&gt;&lt;h3 id=&quot;step-2&quot;&gt;&lt;a href=&quot;#Step-2&quot; class=&quot;headerlink&quot; title=&quot;Step 2&quot;&gt;&lt;/a&gt;Step 2&lt;/h3&gt;&lt;p&gt;$row(i+1) - 2^2row(i) [i=2,3,4,5,&amp;#x2026;,N-1] $&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1 &amp; 1     &amp; 1                        &amp; ... &amp;  1                        &amp; 1   \\
        0 &amp; 2^2-1 &amp;              3^2-1       &amp; ... &amp;               N^2-1       &amp; -1  \\
        0 &amp; 0     &amp;    (3^2-2^2)(3^2-1)      &amp; ... &amp;     (N^2-2^2)(N^2-1)      &amp; 2^2 \\
        0 &amp; 0     &amp; 3^2(3^2-2^2)(3^2-1)      &amp; ... &amp;  N^2(N^2-2^2)(N^2-1)      &amp; 0   \\
        0 &amp; 0     &amp; 3^4(3^2-2^2)(3^2-1)      &amp; ... &amp;  N^4(N^2-2^2)(N^2-1)      &amp; 0   \\
        ...\\
        0 &amp; 0     &amp; 3^{2N-6}(3^2-2^2)(3^2-1) &amp; ... &amp;  N^{2N-6}(N^2-2^2)(N^2-1) &amp; 0   \\
    \end{bmatrix}
\end{equation}&lt;/script&gt;&lt;h3 id=&quot;step-3&quot;&gt;&lt;a href=&quot;#Step-3&quot; class=&quot;headerlink&quot; title=&quot;Step 3&quot;&gt;&lt;/a&gt;Step 3&lt;/h3&gt;&lt;p&gt;$row(i+1) - 3^2row(i) [i=3,4,5,&amp;#x2026;,N-1] $&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1 &amp; 1     &amp; 1                   &amp; ... &amp;   1                                &amp; 1         \\
        0 &amp; 2^2-1 &amp;              3^2-1  &amp; ... &amp;                        N^2-1       &amp; -1        \\
        0 &amp; 0     &amp;    (3^2-2^2)(3^2-1) &amp; ... &amp;              (N^2-2^2)(N^2-1)      &amp; 2^2       \\
        0 &amp; 0     &amp; 0                   &amp; ... &amp;     (N^2-3^2)(N^2-2^2)(N^2-1)      &amp; -2^23^2   \\
        0 &amp; 0     &amp; 0                   &amp; ... &amp;  N^2(N^2-3^2)(N^2-2^2)(N^2-1)      &amp; 0         \\
        ...\\
        0 &amp; 0     &amp; 0                   &amp; ... &amp;  N^{2N-8}(N^2-3^2)(N^2-2^2)(N^2-1) &amp; 0         \\
    \end{bmatrix}
\end{equation}&lt;/script&gt;&lt;h3 id=&quot;step-k&quot;&gt;&lt;a href=&quot;#Step-k&quot; class=&quot;headerlink&quot; title=&quot;Step k&quot;&gt;&lt;/a&gt;Step k&lt;/h3&gt;&lt;p&gt;$row(i+1) - k^2row(i) [i=k,k+1,&amp;#x2026;,N-1] $&lt;br&gt;&amp;#x2026;&lt;/p&gt;
&lt;h3 id=&quot;step-n-1&quot;&gt;&lt;a href=&quot;#Step-N-1&quot; class=&quot;headerlink&quot; title=&quot;Step N-1&quot;&gt;&lt;/a&gt;Step N-1&lt;/h3&gt;&lt;p&gt;$row(i+1) - k^2row(i) [i=N-1] $&lt;/p&gt;
&lt;p&gt;Detail derivations are presented in &lt;a href=&quot;/exam/fd_coef_vandermonde.pdf&quot;&gt;fd_coef_vandermonde.pdf&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id=&quot;result&quot;&gt;&lt;a href=&quot;#Result&quot; class=&quot;headerlink&quot; title=&quot;Result&quot;&gt;&lt;/a&gt;Result&lt;/h2&gt;&lt;p&gt;Finally, the augmented matrix is:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{bmatrix}
        1 &amp; a_{12} &amp; a_{13} &amp; a_{14}  &amp; ... &amp; a_{1N} 　　　　　&amp; b_1  \\
        0 &amp; 1      &amp; a_{23} &amp; a_{24}  &amp; ... &amp; a_{2N} 　　　　　&amp; b_2  \\
        0 &amp; 0      &amp; 1      &amp; a_{34}  &amp; ... &amp; a_{3N} 　　　　　&amp; b_3  \\
        ...\\
        0 &amp; 0      &amp;0       &amp; 0       &amp; ... &amp; 1      　　　　　&amp; b_4  \\
    \end{bmatrix}\\

\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    a_{ij} &amp; = &amp; \frac  { i (j+i-1)! } { j(2i-1)!(j-i)! } (j&gt;i)\\
    b_i    &amp; = &amp; \frac  { (-1)^{i-1}  (i-1)! i! } { (2i-1)! } \\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Thus:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    C_i &amp; = &amp; b_i - \sum \limits_{j=i+1}^N a_{ij}C_j = \frac{ (-1)^{i-1}  (i-1)! i! } { (2i-1)! }
                                                        - \sum \limits_{j=i+1}^N \frac  { i (j+i-1)! } { j(2i-1)!(j-i)! } C_i \\
    C_N &amp; = &amp; \frac  { (-1)^{N-1}  (N-1)! N! } { (2N-1)! } \\
        %&amp; = &amp;  \sum \limits_{i=k+1}^N \frac{1}{N-k} \frac { (-1)^{k-1}  (k-1)! k! (i-k)!i } { i(2k-1)! (i-k)! }
        %     - \sum \limits_{i=k+1}^N  \frac  { k (i+k-1)! } { i(2k-1)!(i-k)! } C_i \\
        %&amp; = &amp;  \sum \limits_{i=k+1}^N \frac{1}{ i(2k-1)!(i-k)! }
        %        \left[ \frac{ (-1)^{k-1}  (k-1)! k! (i-k)!i }{N-k} - { k (i+k-1)! } C_i \right]
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;value-and-program&quot;&gt;&lt;a href=&quot;#Value-and-Program&quot; class=&quot;headerlink&quot; title=&quot;Value and Program&quot;&gt;&lt;/a&gt;Value and Program&lt;/h2&gt;&lt;p&gt;Values of $C_i$ are calculated by &lt;a href=&quot;/exam/fd_coef.py&quot;&gt;fd_coef.py&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;table-container&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;order&lt;/th&gt;
&lt;th&gt;$C_{1}$&lt;/th&gt;
&lt;th&gt;$C_{2}$&lt;/th&gt;
&lt;th&gt;$C_{3}$&lt;/th&gt;
&lt;th&gt;$C_{4}$&lt;/th&gt;
&lt;th&gt;$C_{5}$&lt;/th&gt;
&lt;th&gt;$C_{6}$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;$4/3$&lt;/td&gt;
&lt;td&gt;$-1/3$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;$3/2$&lt;/td&gt;
&lt;td&gt;$-3/5$&lt;/td&gt;
&lt;td&gt;$1/10$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;$8/5$&lt;/td&gt;
&lt;td&gt;$-4/5$&lt;/td&gt;
&lt;td&gt;$8/35$&lt;/td&gt;
&lt;td&gt;$-1/35$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;$5/3$&lt;/td&gt;
&lt;td&gt;$-20/21$&lt;/td&gt;
&lt;td&gt;$5/14$&lt;/td&gt;
&lt;td&gt;$-5/63$&lt;/td&gt;
&lt;td&gt;$1/126$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;$12/7$&lt;/td&gt;
&lt;td&gt;$-15/14$&lt;/td&gt;
&lt;td&gt;$10/21$&lt;/td&gt;
&lt;td&gt;$-1/7$&lt;/td&gt;
&lt;td&gt;$2/77$&lt;/td&gt;
&lt;td&gt;$-1/462$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;This post presents how to solve vandermonde equation in finite-difference.&amp;#x3000;For 2N order accuracy &lt;a href=&quot;http://sheng09.github.io/2016/10/13/finite-difference/#conclusion&quot;&gt;finite-difference of derivatives&lt;/a&gt;, $C_k(k=1,2,&amp;#x2026;,N)$ is the solution of a vandermonde equation:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1        &amp; 1        &amp; 1        &amp; ... &amp; 1        \\
        1^2      &amp; 2^2      &amp; 3^2      &amp; ... &amp; N^2      \\
        1^4      &amp; 2^4      &amp; 3^4      &amp; ... &amp; N^4      \\
        1^6      &amp; 2^6      &amp; 3^6      &amp; ... &amp; N^6      \\
        ... \\
        1^{2N-2} &amp; 2^{2N-2} &amp; 3^{2N-2} &amp; ... &amp; N^{2N-2}
    \end{bmatrix}
    \begin{bmatrix}
        C_1 \\ C_2 \\ C_3 \\ C_4 \\ ... \\ C_N
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 \\ 0 \\ 0 \\ 0 \\ ... \\ 0
    \end{bmatrix}
    \label{equ}
\end{equation}&lt;/script&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="Linear Equation" scheme="http://sheng09.github.io/tags/Linear-Equation/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="error" scheme="http://sheng09.github.io/tags/error/"/>
    
  </entry>
  
  <entry>
    <title>Central Finite Difference of Derivatives(中心有限差分)</title>
    <link href="http://sheng09.github.io/2016/10/13/finite-difference/"/>
    <id>http://sheng09.github.io/2016/10/13/finite-difference/</id>
    <published>2016-10-12T19:53:58.000Z</published>
    <updated>2017-01-21T13:41:31.136Z</updated>
    
    <content type="html">&lt;p&gt;This post derived the method of central finite difference for calculating derivatives, especially for first and second order derivatives, and finally arrive at perfect results. Example are provided to verify the results.&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#taylor-expansion&quot;&gt;Taylor expansion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#derivatives&quot;&gt;Derivatives&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-first-order-derivative&quot;&gt;(1) First order derivative&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-second-order-derivative&quot;&gt;(2) Second order derivative&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#higher-order-accuracy&quot;&gt;Higher Order Accuracy&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-fx&quot;&gt;(1) $f&amp;#x2019;(x)$&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-fx&quot;&gt;(2) $f&amp;#x2019;&amp;#x2019;(x)$&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#examples&quot;&gt;Examples&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#whats-more&quot;&gt;What&amp;#x2019;s more&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;taylor-expansion&quot;&gt;&lt;a href=&quot;#Taylor-expansion&quot; class=&quot;headerlink&quot; title=&quot;Taylor expansion&quot;&gt;&lt;/a&gt;Taylor expansion&lt;/h2&gt;&lt;p&gt;According to Taylor expansion, we have:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f(x+\delta ) &amp; = &amp; f(x) +  \delta  f&#39;(x) +
                            \frac{\delta ^2}{2!}  f&#39;&#39;(x)  +
                            \frac{\delta ^3}{3!}  f^{(3)} (x)  +
                            ... +
                            \frac{\delta ^i}{i!}  f^{(i)} (x)  +
                            \frac{\delta ^n}{n!}  f^{(n)} (x)  +
                            O(\delta^{n+1})\\
    f(x-\delta ) &amp; = &amp; f(x) -  \delta  f&#39;(x) +
                        \frac{\delta ^2}{2!}  f&#39;&#39;(x)  -
                        \frac{\delta ^3}{3!}  f^{(3)} (x)  +
                        ... +
                        \frac{(-\delta)^i}{i!}  f^{(i)} (x)  +
                        \frac{(-\delta)^n}{n!}  f^{(n)} (x)  +
                        O(\delta^{n+1})
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;derivatives&quot;&gt;&lt;a href=&quot;#Derivatives&quot; class=&quot;headerlink&quot; title=&quot;Derivatives&quot;&gt;&lt;/a&gt;Derivatives&lt;/h2&gt;&lt;p&gt;In physical field, it is first and second order derivatives, as well as other boundary(initial) functions or constants, that compose the differential control equations. So we only pay attention to the first and second order derivatives.&lt;br&gt;Adding and subtraction of $f(x+\delta)$ and $f(x-\delta)$ lead to:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{f(x+\delta) + f(x-\delta)}{2} &amp; = &amp; f(x) +    \frac{\delta^2}{2!} f&#39;&#39;(x) +
                                                        \frac{\delta^4}{4!} f^{(4)}(x) +
                                                        \frac{\delta^{2i}}{(2i)!} f^{(2i)}(x) +
                                                        O( \delta^{2i+2})
                                                        \label{second} \\
    \frac{f(x+\delta) - f(x-\delta)}{2} &amp; = &amp; \delta f&#39;(x) +
                                            \frac{\delta^3}{3!} f^{(3)}(x) +
                                            \frac{\delta^5}{5!} f^{(5)}(x) +
                                            \frac{\delta^{2i-1}}{(2i-1)!} f^{(2i-1)}(x) +
                                            O(\delta^{2i+1})
                                            \label{first}

\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;1-first-order-derivative&quot;&gt;&lt;a href=&quot;#1-First-order-derivative&quot; class=&quot;headerlink&quot; title=&quot;(1) First order derivative&quot;&gt;&lt;/a&gt;(1) First order derivative&lt;/h3&gt;&lt;p&gt;According to $\eqref{first}$, $f&amp;#x2019;(x)$ should be:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    f&#39;(x;\delta) = \frac{f(x+\delta) - f(x-\delta)}{2\delta}
                                                        - \frac{\delta^2}{3!} f^{(3)}(x)
                                                        - \frac{\delta^4}{5!} f^{(5)}(x)
                                                        - \frac{\delta^{2i-2}}{(2i-1)!} f^{(2i-1)}(x)
                                                        + O(\delta^{2i})
\end{eqnarray}&lt;/script&gt;&lt;p&gt;omitting tail items leads to $f&amp;#x2019;(x) = \frac{f(x+\delta) - f(x-\delta)}{2\delta}$. The accuracy is $O(\delta^2)$, known as second order accuracy.&lt;/p&gt;
&lt;h3 id=&quot;2-second-order-derivative&quot;&gt;&lt;a href=&quot;#2-Second-order-derivative&quot; class=&quot;headerlink&quot; title=&quot;(2) Second order derivative&quot;&gt;&lt;/a&gt;(2) Second order derivative&lt;/h3&gt;&lt;p&gt;In the same way, $f&amp;#x2019;&amp;#x2019;(x)$ is derived from $\eqref{second}$&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
 f&#39;&#39;(x;\delta)  = \frac{f(x+\delta) + f(x-\delta) - 2f(x)}{ \delta^2}
                                                    - \frac{2\delta^2}{4!} f^{(4)}(x)
                                                    - \frac{2\delta^4}{6!} f^{(6)}(x)
                                                    - \frac{2\delta^{2i-2}}{(2i)!} f^{(2i)}(x)
                                                    + O( \delta^{2i})
\end{eqnarray}&lt;/script&gt;&lt;p&gt;omitting tail items leads to $f&amp;#x2019;&amp;#x2019;(x) = \frac{f(x+\delta) + f(x-\delta) - 2f(x)}{ \delta^2}$. The accuracy is $O(\delta^2)$, also know as second order accuaray.&lt;/p&gt;
&lt;h2 id=&quot;higher-order-accuracy&quot;&gt;&lt;a href=&quot;#Higher-Order-Accuracy&quot; class=&quot;headerlink&quot; title=&quot;Higher Order Accuracy&quot;&gt;&lt;/a&gt;Higher Order Accuracy&lt;/h2&gt;&lt;p&gt;To increase the accuracy, $f&amp;#x2019;(x;\delta)$, $f&amp;#x2019;(x;2\delta)$, $f&amp;#x2019;(x;3\delta)$&amp;#x2026;etc are could be added together by appropriate ratios to counteract the items of $\delta^2$,$\delta^4$,$\delta^6$&amp;#x2026;etc. This method works for $f&amp;#x2019;&amp;#x2019;(x)$ as well.&lt;/p&gt;
&lt;h3 id=&quot;1-fx&quot;&gt;&lt;a href=&quot;#1-f&amp;#x2019;-x&quot; class=&quot;headerlink&quot; title=&quot;(1) $f&amp;#x2019;(x)$&quot;&gt;&lt;/a&gt;(1) $f&amp;#x2019;(x)$&lt;/h3&gt;&lt;p&gt;For step of $\delta$, $2\delta$, $3\delta$&amp;#x2026;etc, we have:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        f&#39;(x; \delta) &amp; = &amp; \frac{f(x+\delta) - f(x-\delta)}{2\delta}
                                        - \frac{\delta^2}{3!} f^{(3)}(x)
                                        - \frac{\delta^4}{5!} f^{(5)}(x)
                                        - \frac{\delta^{2i-2}}{(2i-1)!}  f^{(2i-1)}(x)
                                        + O(\delta^{2i})\\
        f&#39;(x;2\delta) &amp; = &amp; \frac{f(x+2\delta) - f(x-2\delta)}{2 (2\delta)}
                                        - \frac{2^2\delta^2}{3!}  f^{(3)}(x)
                                        - \frac{2^4\delta^4}{5!}  f^{(5)}(x)
                                        - \frac{2^{2i-2}\delta^{2i-2}}{(2i-1)!}  f^{(2i-1)}(x)
                                        + O(\delta^{2i}) \\
        f&#39;(x;3\delta) &amp; = &amp; \frac{f(x+3\delta) - f(x-3\delta)}{2 (3\delta)}
                                        - \frac{3^2\delta^2}{3!}  f^{(3)}(x)
                                        - \frac{3^4\delta^4}{5!}  f^{(5)}(x)
                                        - \frac{3^{2i-2}\delta^{2i-2}}{(2i-1)!}  f^{(2i-1)}(x)
                                        + O(\delta^{2i}) \\
        ...\\
        f&#39;(x;N\delta) &amp; = &amp; \frac{f(x+N\delta) - f(x-N\delta)}{2 (N\delta)}
                                        - \frac{N^2\delta^2}{3!}  f^{(3)}(x)
                                        - \frac{N^4\delta^4}{5!}  f^{(5)}(x)
                                        - \frac{N^{2i-2}\delta^{2i-2}}{(2i-1)!}  f^{(2i-1)}(x)
                                        + O(\delta^{2i}) \\
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;summing all these items proportionally from $f&amp;#x2019;(x;\delta)$ to $f&amp;#x2019;(x;N\delta)$ leads to:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
\begin{aligned}
    f&#39;(x) = &amp;\sum \limits_{k=1}^N {C_k \frac{ f(x+k\delta) - f(x-k\delta) }{2k\delta} } + O(\delta^{2i}) \\
            &amp; - \frac{\delta^2 f^{(3)}(x) }{3!} \sum \limits_{k=1}^N {C_k k^2}
              - \frac{\delta^4 f^{(5)}(x) }{5!} \sum \limits_{k=1}^N {C_k k^4}
              - ...
              - \frac{\delta^{2i-2} f^{(2i-1)}(x) }{5!} \sum \limits_{k=1}^N {C_k k^{2i-2}}
\end{aligned}
\end{equation}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
C_1+C_2+C_3+...+C_N = 1
\end{equation}&lt;/script&gt;&lt;p&gt;so, if we want to have 2ith order accuracy, all item coefficients of $\sum \limits_{k=1}^N {C_k k^{**}}$ must have value of zero. Besides, to determine the value of $C_1,C_2,&amp;#x2026;,C_N$, $i$ should equals to $N$. So we arrive at a linear equation of $C$:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1        &amp; 1        &amp; 1        &amp; ... &amp; 1        \\
        1^2      &amp; 2^2      &amp; 3^2      &amp; ... &amp; N^2      \\
        1^4      &amp; 2^4      &amp; 3^4      &amp; ... &amp; N^4      \\
        1^6      &amp; 2^6      &amp; 3^6      &amp; ... &amp; N^6      \\
        ... \\
        1^{2N-2} &amp; 2^{2N-2} &amp; 3^{2N-2} &amp; ... &amp; N^{2N-2}
    \end{bmatrix}
    \begin{bmatrix}
        C_1 \\ C_2 \\ C_3 \\ C_4 \\ ... \\ C_N
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 \\ 0 \\ 0 \\ 0 \\ ... \\ 0
    \end{bmatrix}
    \label{M_C}
\end{equation}&lt;/script&gt;&lt;p&gt;By calculation, $C_1,C_2,C_3,&amp;#x2026;,C_N$ have the value of:&lt;/p&gt;
&lt;h3 id=&quot;2-fx&quot;&gt;&lt;a href=&quot;#2-f&amp;#x2019;&amp;#x2019;-x&quot; class=&quot;headerlink&quot; title=&quot;(2) $f&amp;#x2019;&amp;#x2019;(x)$&quot;&gt;&lt;/a&gt;(2) $f&amp;#x2019;&amp;#x2019;(x)$&lt;/h3&gt;&lt;p&gt;For step of $\delta$, $2\delta$, $3\delta$&amp;#x2026;etc, we have:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        f&#39;&#39;(x; \delta)  &amp; = &amp; \frac{f(x+\delta) + f(x-\delta) - 2f(x)}{ \delta^2}
                                                            - \frac{2\delta^2}{4!} f^{(4)}(x)
                                                            - \frac{2\delta^4}{6!} f^{(6)}(x)
                                                            - \frac{2\delta^{2i-2}}{(2i)!} f^{(2i)}(x)
                                                            + O( \delta^{2i}) \\
f&#39;&#39;(x;2\delta)  &amp; = &amp; \frac{f(x+2\delta) + f(x-2\delta) - 2f(x)}{ 2^2\delta^2}
                                                    - 2^2     \frac{2 \delta^2}{4!} f^{(4)}(x)
                                                    - 2^4     \frac{2 \delta^4}{6!} f^{(6)}(x)
                                                    - 2^{2i-2}\frac{2 \delta^{2i-2}}{(2i)!} f^{(2i)}(x)
                                                    + O( \delta^{2i}) \\
f&#39;&#39;(x;3\delta)  &amp; = &amp; \frac{f(x+3\delta) + f(x-3\delta) - 2f(x)}{3^2 \delta^2}
                                                    - 3^2     \frac{2 \delta^2}{4!} f^{(4)}(x)
                                                    - 3^4     \frac{2 \delta^4}{6!} f^{(6)}(x)
                                                    - 3^{2i-2}\frac{2 \delta^{2i-2}}{(2i)!} f^{(2i)}(x)
                                                    + O( \delta^{2i}) \\
f&#39;&#39;(x;N\delta)  &amp; = &amp; \frac{f(x+N\delta) + f(x-N\delta) - 2f(x)}{N^2 \delta^2}
                                                    - N^2     \frac{2 \delta^2}{4!} f^{(4)}(x)
                                                    - N^4     \frac{2 \delta^4}{6!} f^{(6)}(x)
                                                    - N^{2i-2}\frac{2 \delta^{2i-2}}{(2i)!} f^{(2i)}(x)
                                                    + O( \delta^{2i})
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;summing all these items proportionally from $f&amp;#x2019;(x;\delta)$ to $f&amp;#x2019;(x;N\delta)$ leads to:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{aligned}
        f&#39;&#39;(x) = &amp; \sum \limits_{k=1}^N F_k \frac{ f(x+k\delta) - f(x-k\delta) -2f(x) }{k^2 \delta^2} +O( \delta^{2i}) \\
                &amp; - \frac{2 \delta^2}{4!} f^{(4)}(x) \sum \limits_{k=1}^N F_k k^2
                  - \frac{2 \delta^4}{6!} f^{(6)}(x) \sum \limits_{k=1}^N F_k k^4
                  ...
                  - \frac{2 \delta^{2i-2}}{(2i)!} f^{(2i)}(x) \sum \limits_{k=1}^N F_k k^{2i-2}
    \end{aligned}
\end{equation}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
F_1+F_2+F_3+...+F_N = 1
\end{equation}&lt;/script&gt;&lt;p&gt;so, if we want to have 2ith order accuracy, all item coefficients of $\sum \limits_{k=1}^N {F_k k^{**}}$ must have value of zero. Besides, to determine the value of $F_1,F_2,&amp;#x2026;,F_N$, $i$ should equals to $N$. So we arrive at a linear equation of $F$, which is same as $\eqref{M_C}$.&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{bmatrix}
        1        &amp; 1        &amp; 1        &amp; ... &amp; 1        \\
        1^2      &amp; 2^2      &amp; 3^2      &amp; ... &amp; N^2      \\
        1^4      &amp; 2^4      &amp; 3^4      &amp; ... &amp; N^4      \\
        1^6      &amp; 2^6      &amp; 3^6      &amp; ... &amp; N^6      \\
        ... \\
        1^{2N-2} &amp; 2^{2N-2} &amp; 3^{2N-2} &amp; ... &amp; N^{2N-2}
    \end{bmatrix}
    \begin{bmatrix}
        F_1 \\ F_2 \\ F_3 \\ F_4 \\ ... \\ F_N
    \end{bmatrix}
    =
    \begin{bmatrix}
        1 \\ 0 \\ 0 \\ 0 \\ ... \\ 0
    \end{bmatrix}
    \label{M_F}
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;conclusion&quot;&gt;&lt;a href=&quot;#Conclusion&quot; class=&quot;headerlink&quot; title=&quot;Conclusion&quot;&gt;&lt;/a&gt;Conclusion&lt;/h2&gt;&lt;p&gt;To sum up, finite difference of 2Nth order accuracy for first or second order derivative are:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
D  [f(x)]   &amp; = &amp; \sum \limits_{k=1}^N {C_k \frac{ f(x+k\delta) - f(x-k\delta) }{2k\delta} } \\
D^2[f(x)]   &amp; = &amp; \sum \limits_{k=1}^N C_k \frac{ f(x+k\delta) - f(x-k\delta) -2f(x) }{k^2 \delta^2} \\
%C_k         &amp; = &amp;
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Values of $C_k$ are obtained by &lt;a href=&quot;http://sheng09.github.io/2016/10/15/vandermonde/&quot;&gt;solving vandermonde equation&lt;/a&gt;.&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
    C_i &amp; = &amp; \frac{ (-1)^{i-1}  (i-1)! i! } { (2i-1)! } - \sum \limits_{j=i+1}^N \frac  { i (j+i-1)! } { j(2i-1)!(j-i)! } C_i \\
    %\left[ i= 1,2,3...,N-1 \right]\\
    C_N &amp; = &amp; \frac  { (-1)^{N-1}  (N-1)! N! } { (2N-1)! } \\
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;by simplifying:&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
D  [f(x)]   &amp; = &amp; \sum \limits_{k=1}^N  \frac{c_k}{\delta}   \left[f(x+k\delta) - f(x-k\delta)         \right] \\
D^2[f(x)]   &amp; = &amp; \sum \limits_{k=1}^N  \frac{f_k}{\delta^2} \left[f(x+k\delta) - f(x-l\delta) - 2f(x) \right]  \\
c_k         &amp; = &amp; \frac{C_k}{2k} \\
f_k         &amp; = &amp; \frac{C_k}{k^2}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;Values of $C_k$, $c_k$ and $f_k$ are:&lt;/p&gt;
&lt;div class=&quot;table-container&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;order&lt;/th&gt;
&lt;th&gt;$C_{1}$&lt;/th&gt;
&lt;th&gt;$C_{2}$&lt;/th&gt;
&lt;th&gt;$C_{3}$&lt;/th&gt;
&lt;th&gt;$C_{4}$&lt;/th&gt;
&lt;th&gt;$C_{5}$&lt;/th&gt;
&lt;th&gt;$C_{6}$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;$1$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;$4/3$&lt;/td&gt;
&lt;td&gt;$-1/3$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;$3/2$&lt;/td&gt;
&lt;td&gt;$-3/5$&lt;/td&gt;
&lt;td&gt;$1/10$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;$8/5$&lt;/td&gt;
&lt;td&gt;$-4/5$&lt;/td&gt;
&lt;td&gt;$8/35$&lt;/td&gt;
&lt;td&gt;$-1/35$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;$5/3$&lt;/td&gt;
&lt;td&gt;$-20/21$&lt;/td&gt;
&lt;td&gt;$5/14$&lt;/td&gt;
&lt;td&gt;$-5/63$&lt;/td&gt;
&lt;td&gt;$1/126$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;$12/7$&lt;/td&gt;
&lt;td&gt;$-15/14$&lt;/td&gt;
&lt;td&gt;$10/21$&lt;/td&gt;
&lt;td&gt;$-1/7$&lt;/td&gt;
&lt;td&gt;$2/77$&lt;/td&gt;
&lt;td&gt;$-1/462$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;table-container&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;order&lt;/th&gt;
&lt;th&gt;$c_{1}$&lt;/th&gt;
&lt;th&gt;$c_{2}$&lt;/th&gt;
&lt;th&gt;$c_{3}$&lt;/th&gt;
&lt;th&gt;$c_{4}$&lt;/th&gt;
&lt;th&gt;$c_{5}$&lt;/th&gt;
&lt;th&gt;$c_{6}$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;$0.5$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;$2/3$&lt;/td&gt;
&lt;td&gt;$-1/12$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;$3/4$&lt;/td&gt;
&lt;td&gt;$-3/20$&lt;/td&gt;
&lt;td&gt;$1/60$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;$4/5$&lt;/td&gt;
&lt;td&gt;$-1/5$&lt;/td&gt;
&lt;td&gt;$4/105$&lt;/td&gt;
&lt;td&gt;$-1/280$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;$5/6$&lt;/td&gt;
&lt;td&gt;$-5/21$&lt;/td&gt;
&lt;td&gt;$5/84$&lt;/td&gt;
&lt;td&gt;$-5/504$&lt;/td&gt;
&lt;td&gt;$1/1260$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;$6/7$&lt;/td&gt;
&lt;td&gt;$-15/56$&lt;/td&gt;
&lt;td&gt;$5/63$&lt;/td&gt;
&lt;td&gt;$-1/56$&lt;/td&gt;
&lt;td&gt;$1/385$&lt;/td&gt;
&lt;td&gt;$-1/5544$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div class=&quot;table-container&quot;&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;order&lt;/th&gt;
&lt;th&gt;$f_{1}$&lt;/th&gt;
&lt;th&gt;$f_{2}$&lt;/th&gt;
&lt;th&gt;$f_{3}$&lt;/th&gt;
&lt;th&gt;$f_{4}$&lt;/th&gt;
&lt;th&gt;$f_{5}$&lt;/th&gt;
&lt;th&gt;$f_{6}$&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;$1.0$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;$4/3$&lt;/td&gt;
&lt;td&gt;$-1/12$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;$3/2$&lt;/td&gt;
&lt;td&gt;$-3/20$&lt;/td&gt;
&lt;td&gt;$1/90$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;$8/5$&lt;/td&gt;
&lt;td&gt;$-1/5$&lt;/td&gt;
&lt;td&gt;$8/315$&lt;/td&gt;
&lt;td&gt;$-1/560$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;$5/3$&lt;/td&gt;
&lt;td&gt;$-5/21$&lt;/td&gt;
&lt;td&gt;$5/126$&lt;/td&gt;
&lt;td&gt;$-5/1008$&lt;/td&gt;
&lt;td&gt;$1/3150$&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12&lt;/td&gt;
&lt;td&gt;$12/7$&lt;/td&gt;
&lt;td&gt;$-15/56$&lt;/td&gt;
&lt;td&gt;$10/189$&lt;/td&gt;
&lt;td&gt;$-1/112$&lt;/td&gt;
&lt;td&gt;$2/1925$&lt;/td&gt;
&lt;td&gt;$-1/16632$&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;h2 id=&quot;examples&quot;&gt;&lt;a href=&quot;#Examples&quot; class=&quot;headerlink&quot; title=&quot;Examples&quot;&gt;&lt;/a&gt;Examples&lt;/h2&gt;&lt;p&gt;Applying finite-difference method to calculate the first and second derivatives of $f(x)=sin(x)$, results of 2nd, 4th, 6th order accuracy are presented below, as well as their error.&lt;br&gt;&lt;a href=&quot;/exam/fd_eg.m&quot;&gt;Codes&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/2016/10/13/finite-difference/1st.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2016/10/13/finite-difference/2nd.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;whats-more&quot;&gt;&lt;a href=&quot;#What&amp;#x2019;s-more&quot; class=&quot;headerlink&quot; title=&quot;What&amp;#x2019;s more&quot;&gt;&lt;/a&gt;What&amp;#x2019;s more&lt;/h2&gt;&lt;p&gt;Method presented above applies to collocated grid and symmetric points only. Find method for staggered grid, and &lt;a href=&quot;http://sheng09.github.io/2016/10/17/finite-difference-asymmetric/&quot;&gt;method for processing boundary points(asymmetric method)&lt;/a&gt;.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;This post derived the method of central finite difference for calculating derivatives, especially for first and second order derivatives, and finally arrive at perfect results. Example are provided to verify the results.&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="error" scheme="http://sheng09.github.io/tags/error/"/>
    
  </entry>
  
  <entry>
    <title>组合</title>
    <link href="http://sheng09.github.io/2016/10/12/combination/"/>
    <id>http://sheng09.github.io/2016/10/12/combination/</id>
    <published>2016-10-11T18:30:34.000Z</published>
    <updated>2016-10-13T19:16:55.860Z</updated>
    
    <content type="html"></content>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>快速排列</title>
    <link href="http://sheng09.github.io/2016/10/11/fast-permutation/"/>
    <id>http://sheng09.github.io/2016/10/11/fast-permutation/</id>
    <published>2016-10-11T15:59:02.000Z</published>
    <updated>2017-01-22T14:50:47.462Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;&amp;#xFF0C;&amp;#x5FEB;&amp;#x901F;&amp;#x5B9E;&amp;#x73B0;&amp;#x6392;&amp;#x5217;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot;&gt;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4F18;&amp;#x5316;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot;&gt;&amp;#x4F18;&amp;#x5316;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4F4D;&amp;#x4F18;&amp;#x5316;&quot;&gt;&amp;#x4F4D;&amp;#x4F18;&amp;#x5316;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x5FEB;&amp;#x901F;&amp;#x4F4D;&quot;&gt;&amp;#x5FEB;&amp;#x901F;&amp;#x4F4D;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x66F4;&amp;#x591A;&amp;#x4F18;&amp;#x5316;&quot;&gt;&amp;#x66F4;&amp;#x591A;&amp;#x4F18;&amp;#x5316;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#codes&quot;&gt;Codes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot;&gt;&lt;a href=&quot;#&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot;&gt;&lt;/a&gt;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&lt;/h2&gt;&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x9012;&amp;#x5F52;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x6B21;&amp;#x653E;&amp;#x7F6E;&amp;#xFF0C;&amp;#x9996;&amp;#x5148;&amp;#x68C0;&amp;#x67E5;&amp;#x5176;&amp;#x662F;&amp;#x5426;&amp;#x4E0E;&amp;#x524D;&amp;#x9762;&amp;#x7684;&amp;#x6570;&amp;#x91CD;&amp;#x5408;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;ctime&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;string&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, end, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; *sol = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; [n] {};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i =&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i) &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; sol[i];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;;&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; count &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;( &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos )&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; ok = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j =&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; pos; ++j) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(i == sol[j]) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ok = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( ok ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(pos == end) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                count++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;//print();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                sol[pos] = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                permutation(pos+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; *argv[])&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::stoi(argv[&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( argc == &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        end = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::stoi(argv[&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;]) - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        end = n - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;clock_t&lt;/span&gt; tic = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::clock();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    permutation(&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;keyword&quot;&gt;clock_t&lt;/span&gt; toc = &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::clock();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;Solution: &amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; count &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;keyword&quot;&gt;float&lt;/span&gt;(toc - tic) / CLOCKS_PER_SEC &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;s\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x4F18;&amp;#x5316;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot;&gt;&lt;a href=&quot;#&amp;#x4F18;&amp;#x5316;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4F18;&amp;#x5316;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&quot;&gt;&lt;/a&gt;&amp;#x4F18;&amp;#x5316;&amp;#x6DF1;&amp;#x5EA6;&amp;#x641C;&amp;#x7D22;&lt;/h2&gt;&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x4E00;&amp;#x4E2A;&amp;#x6570;&amp;#x7EC4;&amp;#x6765;&amp;#x6807;&amp;#x8BB0;&amp;#x54EA;&amp;#x4E9B;&amp;#x6570;&amp;#x5DF2;&amp;#x7ECF;&amp;#x88AB;&amp;#x5360;&amp;#x7528;&amp;#x4E86;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, end, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; *avai = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;bool&lt;/span&gt; [n] {};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;( &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos )&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( !avai[i] ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pos == end) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                count++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                avai[i] = &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                permutation(pos+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                avai[i] = &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x4F4D;&amp;#x4F18;&amp;#x5316;&quot;&gt;&lt;a href=&quot;#&amp;#x4F4D;&amp;#x4F18;&amp;#x5316;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4F4D;&amp;#x4F18;&amp;#x5316;&quot;&gt;&lt;/a&gt;&amp;#x4F4D;&amp;#x4F18;&amp;#x5316;&lt;/h2&gt;&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x6765;&amp;#x6807;&amp;#x8BB0;&amp;#x54EA;&amp;#x4E9B;&amp;#x6570;&amp;#x5DF2;&amp;#x7ECF;&amp;#x88AB;&amp;#x5360;&amp;#x7528;&amp;#x4E86;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, end, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; avai = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;( &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos )&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; n; ++i) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( ( avai &amp;amp; (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;lt;&amp;lt;i) ) == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pos == end) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                count++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                avai ^= (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;lt;&amp;lt;i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                permutation(pos+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                avai ^= (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;lt;&amp;lt;i);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x5FEB;&amp;#x901F;&amp;#x4F4D;&quot;&gt;&lt;a href=&quot;#&amp;#x5FEB;&amp;#x901F;&amp;#x4F4D;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x5FEB;&amp;#x901F;&amp;#x4F4D;&quot;&gt;&lt;/a&gt;&amp;#x5FEB;&amp;#x901F;&amp;#x4F4D;&lt;/h2&gt;&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x6765;&amp;#x6807;&amp;#x8BB0;&amp;#x54EA;&amp;#x4E9B;&amp;#x6570;&amp;#x5DF2;&amp;#x7ECF;&amp;#x88AB;&amp;#x5360;&amp;#x7528;&amp;#x4E86;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E14;&amp;#x6BCF;&amp;#x4E00;&amp;#x6B21;&amp;#x8FED;&amp;#x4EE3;&amp;#x76F4;&amp;#x63A5;&amp;#x53D6;&amp;#x51FA;&amp;#x672A;&amp;#x5360;&amp;#x7528;&amp;#x7684;&amp;#x6570;&amp;#xFF1A;&lt;br&gt;&lt;code&gt;x &amp;amp; -x&lt;/code&gt;&amp;#x53EF;&amp;#x4EE5;&amp;#x53D6;&amp;#x51FA;&amp;#x6700;&amp;#x53F3;&amp;#x8FB9;&amp;#x4E3A;1&amp;#x7684;&amp;#x90A3;&amp;#x4E00;&amp;#x4F4D;&amp;#x3002;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, end, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, avai = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;( &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos )&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; empty =  ((&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;lt;&amp;lt;n)&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) &amp;amp; ~avai; &lt;span class=&quot;comment&quot;&gt;// acquire the available bits and set them to 1.(eg 01110110)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt;( empty != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; p = empty &amp;amp; (-empty);&lt;span class=&quot;comment&quot;&gt;//pick the most right bit that equals 1.(eg 00000010)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        empty ^= p; &lt;span class=&quot;comment&quot;&gt;//set this bit to be 0, which means occupied. (eg 01110100)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pos == end) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            count++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            avai ^= p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            permutation(pos+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            avai ^= p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x66F4;&amp;#x591A;&amp;#x4F18;&amp;#x5316;&quot;&gt;&lt;a href=&quot;#&amp;#x66F4;&amp;#x591A;&amp;#x4F18;&amp;#x5316;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x66F4;&amp;#x591A;&amp;#x4F18;&amp;#x5316;&quot;&gt;&lt;/a&gt;&amp;#x66F4;&amp;#x591A;&amp;#x4F18;&amp;#x5316;&lt;/h2&gt;&lt;p&gt;&amp;#x589E;&amp;#x52A0;&amp;#x51FD;&amp;#x6570;&amp;#x53C2;&amp;#x6570;&amp;#xFF0C;&amp;#x51CF;&amp;#x5C11;&amp;#x8FD0;&amp;#x7B97;&amp;#x91CF;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; n, end, count = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;permutation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;( &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; pos, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; avai )&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; empty =  ((&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&amp;lt;&amp;lt;n)&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) &amp;amp; ~avai;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt;( empty != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; p = empty &amp;amp; (-empty);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        empty ^= p;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (pos == end) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            count++;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;  {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            permutation(pos+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, avai^p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;codes&quot;&gt;&lt;a href=&quot;#Codes&quot; class=&quot;headerlink&quot; title=&quot;Codes&quot;&gt;&lt;/a&gt;Codes&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;/exam/fast-permutation.tgz&quot;&gt;Download&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/sheng09/sheng09.github.io.posts/tree/master/_posts/fast-permutation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;&amp;#xFF0C;&amp;#x5FEB;&amp;#x901F;&amp;#x5B9E;&amp;#x73B0;&amp;#x6392;&amp;#x5217;&amp;#x3002;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://sheng09.github.io/categories/Programming/"/>
    
    
      <category term="bit" scheme="http://sheng09.github.io/tags/bit/"/>
    
      <category term="Programming" scheme="http://sheng09.github.io/tags/Programming/"/>
    
      <category term="algorithm" scheme="http://sheng09.github.io/tags/algorithm/"/>
    
  </entry>
  
  <entry>
    <title>位运算--快速判断奇偶性</title>
    <link href="http://sheng09.github.io/2016/10/10/even-odd/"/>
    <id>http://sheng09.github.io/2016/10/10/even-odd/</id>
    <published>2016-10-10T01:03:10.000Z</published>
    <updated>2017-01-22T14:50:34.809Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5FEB;&amp;#x901F;&amp;#x7684;&amp;#x5224;&amp;#x65AD;&amp;#x6574;&amp;#x6570;&amp;#x7684;&amp;#x5947;&amp;#x5076;&amp;#x6027;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;&amp;#x6574;&amp;#x6570;&amp;#x4F4D;&amp;#x5B58;&amp;#x50A8;&amp;#x65F6;&amp;#xFF0C;&amp;#x6700;&amp;#x4F4E;&amp;#x4F4D;&amp;#x5982;&amp;#x679C;&amp;#x662F;0&amp;#xFF0C;&amp;#x90A3;&amp;#x4E48;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E8E;&amp;#x5076;&amp;#x6570;&amp;#xFF0C;&amp;#x5982;&amp;#x679C;&amp;#x662F;1&amp;#xFF0C;&amp;#x5219;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E8E;&amp;#x5947;&amp;#x6570;&amp;#x3002;&amp;#xFF08;&amp;#x6CE8;&amp;#x610F;&amp;#x8D1F;&amp;#x6570;&amp;#x7684;&amp;#x8865;&amp;#x7801;&amp;#xFF09;&lt;br&gt;&amp;#x4EE3;&amp;#x7801;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; ISODD(x) ((x)&amp;amp;1)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&amp;#x6D4B;&amp;#x8BD5;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//test.cpp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;define&lt;/span&gt; ISODD(x) ((x)&amp;amp;1)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;** argv)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;    x[&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;] = {&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;   l[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;] = {&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-13&lt;/span&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;short&lt;/span&gt;  s[&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;] = {&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-17&lt;/span&gt;};&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;; ++i) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( ISODD(x[i]) )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;int:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; x[i] &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;: odd\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;int:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; x[i] &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;: even\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; ++i) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( ISODD(l[i]) )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;long:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; l[i] &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;: odd\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;long:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; l[i] &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;: even\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; ++i) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( ISODD(s[i]) )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;short:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; s[i] &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;: odd\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;short:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; s[i] &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;: even\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x8FD0;&amp;#x884C;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;bash&amp;gt; g++ test.cpp -o &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;  &lt;span class=&quot;comment&quot;&gt;#compile&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;bash&amp;gt; ./&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int:0: even&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int:10: even&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int:11: odd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int:-10: even&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;int:-13: odd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;long:10: even&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;long:11: odd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;long:-10: even&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;long:-13: odd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;short:10: even&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;short:11: odd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;short:-120: even&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;short:-17: odd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;base&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5FEB;&amp;#x901F;&amp;#x7684;&amp;#x5224;&amp;#x65AD;&amp;#x6574;&amp;#x6570;&amp;#x7684;&amp;#x5947;&amp;#x5076;&amp;#x6027;&amp;#x3002;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://sheng09.github.io/categories/Programming/"/>
    
    
      <category term="bit" scheme="http://sheng09.github.io/tags/bit/"/>
    
      <category term="Programming" scheme="http://sheng09.github.io/tags/Programming/"/>
    
      <category term="algorithm" scheme="http://sheng09.github.io/tags/algorithm/"/>
    
  </entry>
  
  <entry>
    <title>位运算</title>
    <link href="http://sheng09.github.io/2016/10/07/BitComputing/"/>
    <id>http://sheng09.github.io/2016/10/07/BitComputing/</id>
    <published>2016-10-06T21:17:17.000Z</published>
    <updated>2017-01-22T14:50:09.569Z</updated>
    
    <content type="html">&lt;p&gt;1&amp;#x4E2A;Byte&amp;#x7531;8&amp;#x4E2A;Bit&amp;#x6784;&amp;#x6210;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;Bit&amp;#x4E3A;0&amp;#x6216;1&amp;#x3002;&amp;#x9488;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E00;&amp;#x7279;&amp;#x6027;&amp;#xFF0C;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x6765;&amp;#x5B58;&amp;#x50A8;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5B9E;&amp;#x73B0;&amp;#x7A7A;&amp;#x95F4;&amp;#x6700;&amp;#x4F18;&amp;#x5316;&amp;#x3002;&amp;#x6B64;&amp;#x5916;&amp;#xFF0C;&amp;#x7531;&amp;#x4E8E;CPU&amp;#x6307;&amp;#x4EE4;&amp;#x96C6;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E00;&amp;#x6B21;&amp;#x6027;&amp;#x64CD;&amp;#x4F5C;&amp;#x591A;&amp;#x4E2A;Bit&amp;#xFF0C;&amp;#x6545;&amp;#x8FD9;&amp;#x4E00;&amp;#x65B9;&amp;#x6CD5;&amp;#x53EF;&amp;#x4EE5;&amp;#x907F;&amp;#x514D;&amp;#x5BF9;&amp;#x6570;&amp;#x636E;&amp;#x5143;&amp;#x7D20;&amp;#x7684;&amp;#x5FAA;&amp;#x73AF;&amp;#x904D;&amp;#x5386;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x5B9E;&amp;#x73B0;&amp;#x52A0;&amp;#x901F;&amp;#x3002;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4F4D;&quot;&gt;&amp;#x4F4D;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4F4D;&amp;#x64CD;&amp;#x4F5C;&quot;&gt;&amp;#x4F4D;&amp;#x64CD;&amp;#x4F5C;&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4F4D;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;-~&quot;&gt;&amp;#x4F4D;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;&lt;code&gt;&amp;amp; | ~ ^&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x79FB;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;&quot;&gt;&amp;#x79FB;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97; &lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt; &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#bit-mask&quot;&gt;bit mask&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;&amp;#x4F4D;&quot;&gt;&lt;a href=&quot;#&amp;#x4F4D;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4F4D;&quot;&gt;&lt;/a&gt;&amp;#x4F4D;&lt;/h2&gt;&lt;p&gt;&amp;#x9488;&amp;#x5BF9;&amp;#x67D0;&amp;#x4E00;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x83B7;&amp;#x53D6;&amp;#x5176;&amp;#x4F4D;&amp;#x6570;&amp;#x636E;&amp;#x53EF;&amp;#x4EE5;&amp;#x4F7F;&amp;#x7528;&amp;#x4EE5;&amp;#x4E0B;&amp;#x51FD;&amp;#x6570;&lt;code&gt;getBits()&lt;/code&gt;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//getBits.cpp&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//Compile: g++ getBits.cpp -c -std=c++11 -o getBits&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;span class=&quot;meta-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;meta-string&quot;&gt;&amp;lt;string&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;template&lt;/span&gt; &amp;lt;&lt;span class=&quot;keyword&quot;&gt;typename&lt;/span&gt; T&amp;gt; &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;getBits&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T _x)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; len   = &lt;span class=&quot;keyword&quot;&gt;sizeof&lt;/span&gt;(T) * &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt; - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;string&lt;/span&gt; str = &lt;span class=&quot;string&quot;&gt;&amp;apos;[&amp;apos;&lt;/span&gt; + &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::to_string(len+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + &lt;span class=&quot;string&quot;&gt;&amp;quot;bits]&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; x = *( (&lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt;*)(&amp;amp;_x) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt;( len-- != &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; ) {&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( (x &amp;gt;&amp;gt; len) &amp;amp; &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt; )&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      str+= &lt;span class=&quot;string&quot;&gt;&amp;apos;1&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      str+= &lt;span class=&quot;string&quot;&gt;&amp;apos;0&amp;apos;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  }&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; str;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x4F4D;&amp;#x64CD;&amp;#x4F5C;&quot;&gt;&lt;a href=&quot;#&amp;#x4F4D;&amp;#x64CD;&amp;#x4F5C;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4F4D;&amp;#x64CD;&amp;#x4F5C;&quot;&gt;&lt;/a&gt;&amp;#x4F4D;&amp;#x64CD;&amp;#x4F5C;&lt;/h2&gt;&lt;h3 id=&quot;&amp;#x4F4D;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;-~&quot;&gt;&lt;a href=&quot;#&amp;#x4F4D;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;-amp&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4F4D;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;&amp;amp; | ~ ^&quot;&gt;&lt;/a&gt;&amp;#x4F4D;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;&lt;code&gt;&amp;amp; | ~ ^&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;&amp;#x4E0D;&amp;#x540C;&amp;#x4E8E;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;&amp;#x7B26;&amp;#x4E2D;&amp;#x7684;&amp;#x201C;&amp;#x4E0E;&amp;#x201D;&amp;#x201C;&amp;#x6216;&amp;#x201D;&amp;#x201C;&amp;#x975E;&amp;#x201D;&amp;#x201C;&amp;#x4EA6;&amp;#x6216;&amp;#x201D;&amp;#xFF0C;&amp;#x4F4D;&amp;#x903B;&amp;#x8F91;&amp;#x8FD0;&amp;#x7B97;&amp;#x5E76;&amp;#x4E0D;&amp;#x5BF9;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x201C;TRUE&amp;#x201D;&amp;#x6216;&amp;#x201C;FALSE&amp;#x201D;&amp;#xFF0C;&amp;#x800C;&amp;#x662F;&amp;#x9488;&amp;#x5BF9;&amp;#x6BCF;&amp;#x4E00;&amp;#x4F4D;&amp;#x7684;&amp;#x201C;0&amp;#x201D;&amp;#x6216;&amp;#x201C;1&amp;#x201D;&amp;#x505A;&amp;#x903B;&amp;#x8F91;&amp;#x64CD;&amp;#x4F5C;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;00010100 &amp;amp; 00001100 = 00000100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;00010100 | 00001100 = 00000100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;00010100 ^ 00001100 = 00011000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;~00000010 = 11111101&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;&amp;#x79FB;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;&quot;&gt;&lt;a href=&quot;#&amp;#x79FB;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;-lt-lt-gt-gt&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x79FB;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97; &amp;lt;&amp;lt; &amp;gt;&amp;gt;&quot;&gt;&lt;/a&gt;&amp;#x79FB;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97; &lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt; &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt; &lt;code&gt;&amp;gt;&amp;gt;&lt;/code&gt;&amp;#x5206;&amp;#x522B;&amp;#x8868;&amp;#x793A;&amp;#x5C06;&amp;#x6570;&amp;#x636E;&amp;#x4F4D;&amp;#x6574;&amp;#x4F53;&amp;#x5DE6;&amp;#x79FB;&amp;#x548C;&amp;#x53F3;&amp;#x79FB;&amp;#x3002;&amp;#x4F8B;&amp;#x5982;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;(00000001 &amp;lt;&amp;lt; 2) = 00000100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;(00001000 &amp;gt;&amp;gt; 3) = 00000001&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x503C;&amp;#x5F97;&amp;#x6CE8;&amp;#x610F;&amp;#x7684;&amp;#x662F;&amp;#xFF0C;&amp;#x53F3;&amp;#x79FB;&amp;#x8FD0;&amp;#x7B97;&amp;#x7B26;&amp;#x53F7;&amp;#x6D89;&amp;#x53CA;&amp;#x5230;&amp;#x7B26;&amp;#x53F7;&amp;#x4F4D;&amp;#x79FB;&amp;#x52A8;&amp;#x7684;&amp;#x5904;&amp;#x7406;&amp;#xFF0C;&amp;#x5206;&amp;#x4E3A;&amp;#x903B;&amp;#x8F91;&amp;#x79FB;&amp;#x4F4D;&amp;#x4E0E;&amp;#x7B97;&amp;#x672F;&amp;#x79FB;&amp;#x4F4D;&amp;#x3002;&amp;#x4E0D;&amp;#x540C;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x5177;&amp;#x4F53;&amp;#x5B9E;&amp;#x73B0;&amp;#x65B9;&amp;#x5F0F;&amp;#xFF0C;&amp;#x8BF7;&amp;#x53C2;&amp;#x8003;&amp;#x5BF9;&amp;#x5E94;&amp;#x6807;&amp;#x51C6;&amp;#x3002;&lt;/p&gt;
&lt;h3 id=&quot;bit-mask&quot;&gt;&lt;a href=&quot;#bit-mask&quot; class=&quot;headerlink&quot; title=&quot;bit mask&quot;&gt;&lt;/a&gt;bit mask&lt;/h3&gt;&lt;p&gt;&amp;#x6784;&amp;#x5EFA;&amp;#x4E00;&amp;#x4E2A;&amp;#x503C;A&amp;#xFF0C;&amp;#x5176;&amp;#x67D0;&amp;#x4E9B;&amp;#x4F4D;&amp;#x4E3A;0&amp;#xFF0C;&amp;#x67D0;&amp;#x4E9B;&amp;#x4F4D;&amp;#x4E3A;1&amp;#x3002;&amp;#x90A3;&amp;#x4E48;&amp;#x5C06;&amp;#x6570;&amp;#x636E;&amp;#x4E0E;A&amp;#x505A;&amp;#x4F4D;&amp;#x8FD0;&amp;#x7B97;&amp;#x53EF;&amp;#x4EE5;&amp;#x5B9E;&amp;#x73B0;&amp;#x5BF9;&amp;#x6570;&amp;#x636E;&amp;#x7279;&amp;#x5B9A;&amp;#x4F4D;&amp;#x7684;&amp;#x4FEE;&amp;#x6539;&amp;#x3002;&lt;/p&gt;
&lt;p&gt;&amp;#x63D0;&amp;#x53D6;&amp;#x6570;&amp;#x636E;&amp;#x7684;&amp;#x7B2C;1&amp;#x4F4D;&amp;#xFF1A; &lt;code&gt;dat &amp;amp; 00000010&lt;/code&gt;;&lt;br&gt;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6570;&amp;#x636E;&amp;#x7B2C;3&amp;#x4F4D;&amp;#x4E3A;0: &lt;code&gt;dat &amp;amp;= 11110111&lt;/code&gt;;&lt;br&gt;&amp;#x8BBE;&amp;#x7F6E;&amp;#x6570;&amp;#x636E;&amp;#x7B2C;3&amp;#x4F4D;&amp;#x4E3A;1&amp;#xFF1A;&lt;code&gt;dat |= 00001000&lt;/code&gt;;&lt;br&gt;&amp;#x6570;&amp;#x636E;&amp;#x7B2C;3&amp;#x4F4D;&amp;#x53D6;&amp;#x53CD;&amp;#xFF1A;&lt;code&gt;dat ^= 00001000&lt;/code&gt;;&lt;br&gt;&amp;#x63D0;&amp;#x53D6;&amp;#x6570;&amp;#x636E;&amp;#x6700;&amp;#x53F3;&amp;#x8FB9;&amp;#x4E3A;1&amp;#x7684;&amp;#x90A3;&amp;#x4E00;&amp;#x4F4D;&amp;#xFF1A;&lt;code&gt;dat &amp;amp; -dat&lt;/code&gt;;&lt;/p&gt;
&lt;figure class=&quot;highlight cpp&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//Test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; *argv[])&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; a = &lt;span class=&quot;number&quot;&gt;95&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; index = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits(a) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a &amp;amp; 00000001:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a &amp;amp; index   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a &amp;amp; 11111110:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a &amp;amp; (~index)) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a | 00000001:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a | index   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a ^ a       :&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a ^ a   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a &amp;amp;-a       :&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a &amp;amp;-a   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  a = &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits(a) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a &amp;amp; 00000001:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a &amp;amp; index   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a &amp;amp; 11111110:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a &amp;amp; (~index)) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a | 00000001:&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a | index   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a ^ a       :&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a ^ a   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;built_in&quot;&gt;std&lt;/span&gt;::&lt;span class=&quot;built_in&quot;&gt;cout&lt;/span&gt; &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;a &amp;amp;-a       :&amp;quot;&lt;/span&gt; &amp;lt;&amp;lt; getBits( (&lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt;)( a &amp;amp;-a   ) ) &amp;lt;&amp;lt; &lt;span class=&quot;string&quot;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;1&amp;#x4E2A;Byte&amp;#x7531;8&amp;#x4E2A;Bit&amp;#x6784;&amp;#x6210;&amp;#xFF0C;&amp;#x6BCF;&amp;#x4E00;&amp;#x4E2A;Bit&amp;#x4E3A;0&amp;#x6216;1&amp;#x3002;&amp;#x9488;&amp;#x5BF9;&amp;#x8FD9;&amp;#x4E00;&amp;#x7279;&amp;#x6027;&amp;#xFF0C;&amp;#x5229;&amp;#x7528;&amp;#x4F4D;&amp;#x6765;&amp;#x5B58;&amp;#x50A8;&amp;#x6570;&amp;#x636E;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x5B9E;&amp;#x73B0;&amp;#x7A7A;&amp;#x95F4;&amp;#x6700;&amp;#x4F18;&amp;#x5316;&amp;#x3002;&amp;#x6B64;&amp;#x5916;&amp;#xFF0C;&amp;#x7531;&amp;#x4E8E;CPU&amp;#x6307;&amp;#x4EE4;&amp;#x96C6;&amp;#x53EF;&amp;#x4EE5;&amp;#x4E00;&amp;#x6B21;&amp;#x6027;&amp;#x64CD;&amp;#x4F5C;&amp;#x591A;&amp;#x4E2A;Bit&amp;#xFF0C;&amp;#x6545;&amp;#x8FD9;&amp;#x4E00;&amp;#x65B9;&amp;#x6CD5;&amp;#x53EF;&amp;#x4EE5;&amp;#x907F;&amp;#x514D;&amp;#x5BF9;&amp;#x6570;&amp;#x636E;&amp;#x5143;&amp;#x7D20;&amp;#x7684;&amp;#x5FAA;&amp;#x73AF;&amp;#x904D;&amp;#x5386;&amp;#x64CD;&amp;#x4F5C;&amp;#xFF0C;&amp;#x4ECE;&amp;#x800C;&amp;#x5B9E;&amp;#x73B0;&amp;#x52A0;&amp;#x901F;&amp;#x3002;&lt;/p&gt;
    
    </summary>
    
      <category term="Programming" scheme="http://sheng09.github.io/categories/Programming/"/>
    
    
      <category term="bit" scheme="http://sheng09.github.io/tags/bit/"/>
    
      <category term="Programming" scheme="http://sheng09.github.io/tags/Programming/"/>
    
  </entry>
  
  <entry>
    <title>PML边界-一阶声波方程有线差分模拟在二维下的实现</title>
    <link href="http://sheng09.github.io/2016/09/17/fd-2d-PML/"/>
    <id>http://sheng09.github.io/2016/09/17/fd-2d-PML/</id>
    <published>2016-09-16T17:54:33.000Z</published>
    <updated>2016-10-10T01:45:25.463Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;PML&amp;#x5438;&amp;#x6536;&amp;#x8FB9;&amp;#x754C;&amp;#x7684;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/wave_field.jpg&quot; width=&quot;600px&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#pml&amp;#x533A;&amp;#x57DF;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;PML&amp;#x533A;&amp;#x57DF;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#dx&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot;&gt;$d(x)$&amp;#x7684;&amp;#x9009;&amp;#x62E9;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#q_x&amp;#x9012;&amp;#x63A8;&quot;&gt;$q_x$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#q_z&amp;#x9012;&amp;#x63A8;&quot;&gt;$q_z$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#p_x&amp;#x9012;&amp;#x63A8;&quot;&gt;$p_x$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#p_z&amp;#x9012;&amp;#x63A8;&quot;&gt;$p_z$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot;&gt;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#implementation&quot;&gt;Implementation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;pml&amp;#x533A;&amp;#x57DF;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;a href=&quot;#PML&amp;#x533A;&amp;#x57DF;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot; class=&quot;headerlink&quot; title=&quot;PML&amp;#x533A;&amp;#x57DF;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;/a&gt;PML&amp;#x533A;&amp;#x57DF;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/h2&gt;&lt;p&gt;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x4E0D;&amp;#x8003;&amp;#x8651;&amp;#x8F93;&amp;#x51FA;&amp;#x6E90;&amp;#xFF0C;&amp;#x4E8C;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x4E3A;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{\partial^2 p}{\partial x^2} +
        \frac{\partial^2 p}{\partial z^2} &amp; = &amp;
        \frac{1}{v^2} \frac{\partial^2 p}{\partial t^2} \\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x4E00;&amp;#x9636;&amp;#x538B;&amp;#x5F3A;-&amp;#x901F;&amp;#x5EA6;&amp;#x65B9;&amp;#x7A0B;&amp;#x53EF;&amp;#x4EE5;&amp;#x5199;&amp;#x6210;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        p &amp; = &amp; p_x + p_z\\
        \frac{\partial p_x}{\partial t} &amp; = &amp; -\rho v^2
            \frac{\partial q_x}{\partial x}\\
        \frac{\partial p_z}{\partial_t} &amp; = &amp; -\rho v^2
            \frac{\partial q_z}{\partial z}\\
        \frac{\partial q_x}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial x}\\
        \frac{\partial q_z}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial z}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x9488;&amp;#x5BF9;PML&amp;#x533A;&amp;#x57DF;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        p &amp; = &amp; p_x + p_z \\
        \frac{\partial p_x}{\partial t} + d(x)p_x &amp; = &amp; -\rho v^2
            \frac{\partial q_x}{\partial x}\\
        \frac{\partial p_z}{\partial_t} + d(z)p_z &amp; = &amp; -\rho v^2
            \frac{\partial q_z}{\partial z}\\
        \frac{\partial q_x}{\partial t} + d(x)q_x &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial x}\\
        \frac{\partial q_y}{\partial t} + d(z)q_z &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial z}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;dx&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot;&gt;&lt;a href=&quot;#d-x-&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot; class=&quot;headerlink&quot; title=&quot;$d(x)$&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot;&gt;&lt;/a&gt;$d(x)$&amp;#x7684;&amp;#x9009;&amp;#x62E9;&lt;/h2&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
d(x) = log(\frac{1}{R}) \frac{3v}{2\delta}(\frac{x}{\delta})^2&lt;/script&gt;&lt;p&gt;$R$&amp;#x63A8;&amp;#x8350;&amp;#x53D6;0.001&amp;#xFF0C;$\delta$&amp;#x4E3A;PML&amp;#x5C42;&amp;#x539A;[&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1444908&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Collino and Tsogka 2001&lt;/a&gt;]&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;/a&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/h2&gt;&lt;p&gt;&amp;#x6784;&amp;#x5EFA;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x7684;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/grid1.jpg&quot; width=&quot;400&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4EA4;&amp;#x9519;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;$p$,$q_x$,$q_z$&amp;#x9012;&amp;#x63A8;&amp;#x5173;&amp;#x7CFB;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#xFF1A;&lt;/p&gt;
&lt;table&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/p1.jpg&quot; width=&quot;200&quot;&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/q_x1.jpg&quot; width=&quot;200&quot;&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/q_z1.jpg&quot; width=&quot;200&quot;&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;

&lt;h2 id=&quot;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;a href=&quot;#&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;/a&gt;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&lt;/h2&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        p &amp; = &amp; p_x + p_z \\

        \frac{\partial p_x}{\partial t} + d(x)p_x &amp; = &amp; -\rho v^2
            \frac{\partial q_x}{\partial x}\\

        \frac{\partial p_z}{\partial_t} + d(z)p_z &amp; = &amp; -\rho v^2
            \frac{\partial q_z}{\partial z}\\

        \frac{\partial q_x}{\partial t} + d(x)q_x &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial x}\\

        \frac{\partial q_y}{\partial t} + d(z)q_z &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial z}
    \end{cases}
    \Rightarrow
    \begin{cases}
        p &amp; = &amp; p_x + p_z \\
        D_t p_x + d(x)p_x &amp; = &amp; -\rho v^2 D_x q_x \\
        D_t p_z + d(z)p_z &amp; = &amp; -\rho v^2 D_z q_z \\
        D_t q_x + d(x)q_x &amp; = &amp; - \frac{1}{\rho}  D_x (p_x+p_z)\\
        D_t q_z + d(z)q_z &amp; = &amp; - \frac{1}{\rho}  D_z (p_x+p_z)
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;q_x&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#q-x-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$q_x$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$q_x$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/q_x1.jpg&quot; width=&quot;200&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t q_x(A) + d(A) q_x(A) &amp; = &amp; - \frac{1}{\rho}  D_x p(A)
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{1}{\Delta t}[q_x(D) - q_x(C)] + \frac{d(A)}{2} [q_x(D) + q_x(C)] &amp; = &amp; - \frac{1}{\rho \Delta x} [p(F) - p(E)]
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t}[q_x(x_{i+1/2},z_{j},t_{m+1} )  - &amp; q_x(x_{i+1/2},z_j,t_{m})] + \\
    \frac{d(x_{i+1/2},z_j,t_{m+1/2})}{2}    [q_x(x_{i+1/2},z_{j},t_{m+1} )  + &amp; q_x(x_{i+1/2},z_j,t_{m})] \\
    = - \frac{1}{\rho \Delta x} [ p(&amp;x_{i+1},z_j,t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
    q_x(x_{i+1/2},z_{j},t_{m+1} )  = &amp; c_{qx1} q_x(x_{i+1/2},z_j,t_{m}) \\ &amp;+ c_{qx2} [ p(x_{i+1},z_j,t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ] \\
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
      \begin{cases}
        c_{qx1}  =  \frac{ 2- \Delta t d(x_{i+1/2},z_j,t_{m+1/2})  }{2 + \Delta t d(x_{i+1/2},z_j,t_{m+1/2}) } \\
        c_{qx2}  =  -\frac{2 \Delta t}{\rho \Delta x [2 + \Delta t d(x_{i+1/2},z_j,t_{m+1/2})]}
      \end{cases}
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;q_z&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#q-z-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$q_z$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$q_z$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/q_z1.jpg&quot; width=&quot;200&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t q_z(B) + d(B)q_z(B) &amp; = &amp; - \frac{1}{\rho}  D_z p(B)
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{1}{\Delta t}[q_z(J) - q_z(H)] + \frac{d(B)}{2}[q_z(J) + q_z(H)] &amp; = &amp; - \frac{1}{\rho \Delta z} [p(G) - p(E)]
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t}[q_z(x_{i},z_{j+1/2},t_{m+1} ) - &amp; q_z(x_{i},z_{j+1/2},t_{m})]\\ +
    \frac{d(x_{i},z_{j+1/2},t_{m+1/2} )}{2}[q_z(x_{i},z_{j+1/2},t_{m+1} ) + &amp; q_z(x_{i},z_{j+1/2},t_{m})] \\
    = - \frac{1}{\rho \Delta z} [ p(&amp;x_i,z_{j+1},t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    q_z(x_{i},z_{j+1/2},t_{m+1} ) = &amp; c_{qz1} q_z(x_{i},z_{j+1/2},t_{m}) \\
    &amp;+c_{qz2} [ p(x_i,z_{j+1},t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
      \begin{cases}
        c_{qz1}  =  \frac{ 2- \Delta t d(x_{i},z_{j+1/2},t_{m+1/2})  }{2 + \Delta t d(x_{i},z_{j+1/2},t_{m+1/2}) } \\
        c_{qz2}  =  -\frac{2 \Delta t}{\rho \Delta z [2 + \Delta t d(x_{i},z_{j+1/2},t_{m+1/2})]}
      \end{cases}
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;p_x&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#p-x-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$p_x$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$p_x$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/p1.jpg&quot; width=&quot;400&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t p_x + d(x)p_x &amp; = &amp; -\rho v^2 D_x q_x
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t} [p_x(x_i,z_j,t_{m+1/2}) - &amp; p_x(x_i,z_j,t_{m-1/2})]  \\
    +\frac{d(x_i,z_j,t_m)}{2} [p_x(x_i,z_j,t_{m+1/2}) + &amp; p_x(x_i,z_j,t_{m-1/2})] \\
    = - &amp;\frac{\rho v^2}{\Delta x} [ q_x(x_{i+1/2},z_j,t_m) - q_x(x_{i-1/2,z_j,t_m}) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    p_x(x_i,z_j,t_{m+1/2}) = &amp; c_{px1} p_x(x_i,z_j,t_{m-1/2})\\
    &amp;  +c_{px2} [ q_x(x_{i+1/2},z_j,t_m) - q_x(x_{i-1/2,z_j,t_m}) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
      \begin{cases}
        c_{px1}  =  \frac{ 2- \Delta t d(x_i,z_j,t_m)  }
                         {2 + \Delta t d(x_i,z_j,t_m) } \\
        c_{px2}  =  -\frac{2 \rho v^2 \Delta t}{\Delta x [2 + \Delta t d(x_i,z_j,t_m)]}
      \end{cases}
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;p_z&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#p-z-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$p_z$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$p_z$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/p1.jpg&quot; width=&quot;400&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t p_z + d(z)p_z &amp; = &amp; -\rho v^2 D_z q_z
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t}      [p_z(x_i,z_j,t_{m+1/2}) - &amp; p_z(x_i,z_j,t_{m-1/2})] \\
    \frac{d(x_i,z_j,t_m)}{2}[p_z(x_i,z_j,t_{m+1/2}) + &amp; p_z(x_i,z_j,t_{m-1/2})] \\
    = -&amp;\frac{\rho v^2}{\Delta x} [ q_z(x_i,z_{j+1/2},t_m) - q_z(x_i,z_{j-1/2},t_m) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    p_z(x_i,z_j,t_{m+1/2}) = &amp; c_{pz1} p_z(x_i,z_j,t_{m-1/2}) \\
    &amp;  +c_{pz2} [ q_z(x_i,z_{j+1/2},t_m) - q_z(x_i,z_{j-1/2},t_m) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
      \begin{cases}
        c_{pz1}  =  \frac{ 2- \Delta t d(x_i,z_j,t_m)  }
                         {2 + \Delta t d(x_i,z_j,t_m) } \\
        c_{pz2}  =  -\frac{2 \rho v^2 \Delta t}{\Delta z [2 + \Delta t d(x_i,z_j,t_m)]}
      \end{cases}
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot;&gt;&lt;a href=&quot;#&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot;&gt;&lt;/a&gt;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&lt;/h2&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
        \begin{cases}
            q_x(x_{i+1/2},z_{j},t_{m+1} ) &amp; = &amp; c_{qx1} q_x(x_{i+1/2},z_j,t_{m}) \\
            &amp;&amp;+ c_{qx2} [ p(x_{i+1},z_j,t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ] \\

            q_z(x_{i},z_{j+1/2},t_{m+1} )&amp; = &amp; c_{qz1} q_z(x_{i},z_{j+1/2},t_{m}) \\
            &amp;&amp;+c_{qz2} [ p(x_i,z_{j+1},t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ] \\

            p_x(x_i,z_j,t_{m+1/2}) &amp; = &amp; c_{px1} p_x(x_i,z_j,t_{m-1/2})\\
            &amp;&amp;+c_{px2} [ q_x(x_{i+1/2},z_j,t_m) - q_x(x_{i-1/2,z_j,t_m}) ]\\

            p_z(x_i,z_j,t_{m+1/2}) &amp; = &amp; c_{pz1} p_z(x_i,z_j,t_{m-1/2}) \\
            &amp;&amp;+c_{pz2} [ q_z(x_i,z_{j+1/2},t_m) - q_z(x_i,z_{j-1/2},t_m) ]\\
        \end{cases}
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
      \begin{cases}
        c_{qx1}  &amp;= &amp;  \frac{ 2- \Delta t d(x_{i+1/2},z_j,t_{m+1/2})  }{2 + \Delta t d(x_{i+1/2},z_j,t_{m+1/2}) } \\
        c_{qx2}  &amp;= &amp;  -\frac{2 \Delta t}{\rho \Delta x [2 + \Delta t d(x_{i+1/2},z_j,t_{m+1/2})]}\\
        c_{qz1}  &amp;= &amp;  \frac{ 2- \Delta t d(x_{i},z_{j+1/2},t_{m+1/2})  }{2 + \Delta t d(x_{i},z_{j+1/2},t_{m+1/2}) } \\
        c_{qz2}  &amp;= &amp;  -\frac{2 \Delta t}{\rho \Delta z [2 + \Delta t d(x_{i},z_{j+1/2},t_{m+1/2})]}\\
        c_{px1}  &amp;= &amp;  \frac{ 2- \Delta t d(x_i,z_j,t_m)  } {2 + \Delta t d(x_i,z_j,t_m) } \\
        c_{px2}  &amp;= &amp;  -\frac{2 \rho v^2 \Delta t}{\Delta x [2 + \Delta t d(x_i,z_j,t_m)]}\\
        c_{pz1}  &amp;= &amp;  \frac{ 2- \Delta t d(x_i,z_j,t_m)  } {2 + \Delta t d(x_i,z_j,t_m) } \\
        c_{pz2}  &amp;= &amp;  -\frac{2 \rho v^2 \Delta t}{\Delta z [2 + \Delta t d(x_i,z_j,t_m)]}\\
      \end{cases}
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x6545;&amp;#x800C;&amp;#xFF0C;&amp;#x6CE2;&amp;#x573A;&amp;#x9012;&amp;#x63A8;&amp;#x5173;&amp;#x7CFB;&amp;#x4E3A;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{cases}
        q_x(t=0)\\
        q_z(t=0)\\
        p(t=\Delta /2)
    \end{cases}
    \Rightarrow
    \begin{cases}
        \color{red}{q_x(t=\Delta t)}\\
        \color{red}{q_z(t=\Delta t)}\\
    \end{cases}
    \\
    \Rightarrow
    \begin{cases}
        \color{red}{q_x(t=\Delta t)}\\
        \color{red}{q_z(t=\Delta t)}\\
        p(t=\Delta /2)
    \end{cases}
    \Rightarrow
        \color{blue}{p(t=3\Delta /2)}
    \\
    \Rightarrow
    \begin{cases}
        \color{red}{q_x(t=\Delta t)}\\
        \color{red}{q_z(t=\Delta t)}\\
        \color{blue}{p(t=3\Delta /2)}
    \end{cases}
    \Rightarrow
    \begin{cases}
        \color{green}{q_x(t=2\Delta t)}\\
        \color{green}{q_z(t=2\Delta t)}\\
    \end{cases}
    \\
    \Rightarrow
    \begin{cases}
        \color{green}{q_x(t=2\Delta t)}\\
        \color{green}{q_z(t=2\Delta t)}\\
        \color{blue}{p(t=3\Delta /2)}
    \end{cases}
    \Rightarrow
    ............
    \\ \\
    ... ...
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;implementation&quot;&gt;&lt;a href=&quot;#Implementation&quot; class=&quot;headerlink&quot; title=&quot;Implementation&quot;&gt;&lt;/a&gt;Implementation&lt;/h2&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;%Matlab&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    close all;clear;clc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    %Parameters&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    n_pml = 10;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    nx = 320; nz = 320; dx = 5.0; dz = 5.0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x  = (-n_pml:nx-1-n_pml) *dx; %(1:11) and (310:320) are PML zone&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    z  = (-n_pml:nx-1-n_pml) *dz;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dt = 1.0e-3; nt = 2000; t  = (0:nt-1)*dt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    v = zeros(nx,nz) + 800.0; rho = 1000.0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    R = 0.001; delta = n_pml * dx; d_const = (3.0/2.0/delta)*log(1.0/R) /(delta*    delta);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    %d(x) and d(z)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_pxLeft  = ( (-n_pml:0)*dx ).^2 * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_pxRight = ( (0:n_pml)*dx  ).^2 * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_qxLeft  = ( (-n_pml:-1)*dx +dx/2 ).^2 * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_qxRight = ( (1:n_pml)*dx   -dx/2 ).^2 * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_px      = [d_pxLeft zeros(1,nx-2*n_pml-2) d_pxRight];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_qx      = [d_qxLeft zeros(1,nx-2*n_pml-1) d_qxRight];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_pzLeft  = ( (-n_pml:0)*dz ) .^2 * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_pzRight = ( (0:n_pml)*dz  ) .^2 * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_qzLeft  = ( (-n_pml:-1)*dz +dz/2 ) .^2 *  d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_qzRight = ( (1:n_pml)*dz   -dz/2 ) .^2 *  d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_pz      = [d_pzLeft zeros(1,nx-2*n_pml-2) d_pzRight];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    d_qz      = [d_qzLeft zeros(1,nx-2*n_pml-1) d_qzRight];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p   = zeros(nx,nz); p_x = zeros(nx,nz); p_z = zeros(nx,nz);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    q_x = zeros(nx-1,nz); q_z = zeros(nx,nz-1);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    $Source&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    src = [ 2.0*mexihat(-5,5,200) zeros(1,nt)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ix_src = 161; iz_src = 161;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    %Main loop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    figure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    for it = 1:nt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %     1   2   3   4   5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %   --q---q---q---q---q--...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %   p---p---p---p---p---p...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %   1   2   3   4   5   6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p_x(ix_src, iz_src) = p_x(ix_src,iz_src) + src(it)/2.0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p_z(ix_src, iz_src) = p_z(ix_src,iz_src) + src(it)/2.0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p(  ix_src, iz_src) = p(  ix_src,iz_src) + src(it)/2.0;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %q_x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for ix = 1:nx-1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            for iz = 1:nz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                deno  = (2.0 + dt * d_qx(ix)*v(ix,iz));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_qx1 = (2.0 - dt * d_qx(ix)*v(ix,iz) ) / deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_qx2 = -2.0*dt / rho / dx / deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                q_x(ix,iz) = c_qx1 * q_x(ix,iz) + c_qx2 *( p(ix+1,iz) - p(ix,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            end&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        end&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %q_z&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for iz = 1:nz-1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            for ix = 1:nx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                deno  = (2.0 + dt * d_qz(iz)*v(ix,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_qz1 = (2.0 - dt * d_qz(iz)*v(ix,iz) )/ deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_qz2 = -2.0*dt/rho/ dz / deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                q_z(ix,iz) = c_qz1 * q_z(ix,iz) + c_qz2 *( p(ix,iz+1) - p(ix,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            end&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        end&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        %p_x&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        for ix = 2:nx-1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            for iz = 2:nz-1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                deno  =  (2.0 + dt * d_px(ix)*v(ix,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_px1 =  (2.0 - dt * d_px(ix)*v(ix,iz) ) / deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_px2 = -2.0*rho*v2(ix,iz)*dt/dx / deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                deno  =  (2.0 + dt * d_pz(iz)*v(ix,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_pz1 =  (2.0 - dt * d_pz(iz)*v(ix,iz) ) / deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                c_pz2 = -2.0*rho*v2(ix,iz)*dt/dz /deno;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p_x(ix,iz) = c_px1 * p_x(ix,iz) + c_px2 * ( q_x(ix,iz) - q_x(ix-    1,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p_z(ix,iz) = c_pz1 * p_z(ix,iz) + c_pz2 * ( q_z(ix,iz) - q_z(ix,iz- 1) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p(ix,iz)   = p_x(ix,iz) + p_z(ix,iz);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            end&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        end&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pmax = max(max( abs(p) ));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        imagesc(x, z, p/pmax );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        colormap(&amp;apos;gray&amp;apos;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        axis square;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pause(0.001);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    end&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;PML&amp;#x5438;&amp;#x6536;&amp;#x8FB9;&amp;#x754C;&amp;#x7684;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/17/fd-2d-PML/wave_field.jpg&quot; width=&quot;600px&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="wave equation" scheme="http://sheng09.github.io/tags/wave-equation/"/>
    
  </entry>
  
  <entry>
    <title>一阶声波方程有线差分模拟在二维下的实现</title>
    <link href="http://sheng09.github.io/2016/09/15/fd-2d/"/>
    <id>http://sheng09.github.io/2016/09/15/fd-2d/</id>
    <published>2016-09-14T17:54:33.000Z</published>
    <updated>2016-10-10T01:45:20.432Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x4E00;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x5728;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x7684;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x6A21;&amp;#x62DF;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/15/fd-2d/wave_field.jpg&quot; width=&quot;600px&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#q_x&amp;#x9012;&amp;#x63A8;&quot;&gt;$q_x$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#q_z&amp;#x9012;&amp;#x63A8;&quot;&gt;$q_z$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#p_x&amp;#x9012;&amp;#x63A8;&quot;&gt;$p_x$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#p_z&amp;#x9012;&amp;#x63A8;&quot;&gt;$p_z$&amp;#x9012;&amp;#x63A8;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot;&gt;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#implementation&quot;&gt;Implementation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;a href=&quot;#&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;/a&gt;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/h2&gt;&lt;p&gt;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x4E0D;&amp;#x8003;&amp;#x8651;&amp;#x8F93;&amp;#x51FA;&amp;#x6E90;&amp;#xFF0C;&amp;#x4E8C;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x4E3A;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{\partial^2 p}{\partial x^2} +
        \frac{\partial^2 p}{\partial z^2} &amp; = &amp;
        \frac{1}{v^2} \frac{\partial^2 p}{\partial t^2} \\
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x4E00;&amp;#x9636;&amp;#x538B;&amp;#x5F3A;-&amp;#x901F;&amp;#x5EA6;&amp;#x65B9;&amp;#x7A0B;&amp;#x53EF;&amp;#x4EE5;&amp;#x5199;&amp;#x6210;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        \frac{\partial p}{\partial t} &amp; = &amp; -\rho v^2(
            \frac{\partial q_x}{\partial x} +
            \frac{\partial q_z}{\partial z}
            )\\
        \frac{\partial q_x}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial p}{\partial x}\\
        \frac{\partial q_z}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial p}{\partial z}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x5C06;&amp;#x538B;&amp;#x5F3A;$p$&amp;#x5199;&amp;#x4F5C;$p_x+p_y$&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x83B7;&amp;#x5F97;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        p &amp; = &amp; p_x + p_z\\
        \frac{\partial p_x}{\partial t} &amp; = &amp; -\rho v^2
            \frac{\partial q_x}{\partial x}\\
        \frac{\partial p_z}{\partial_t} &amp; = &amp; -\rho v^2
            \frac{\partial q_z}{\partial z}\\
        \frac{\partial q_x}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial x}\\
        \frac{\partial q_z}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial z}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;/a&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/h2&gt;&lt;p&gt;&amp;#x6784;&amp;#x5EFA;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x7684;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/15/fd-2d/grid1.jpg&quot; width=&quot;400&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5BF9;&amp;#x4E8E;&amp;#x4EA4;&amp;#x9519;&amp;#x8282;&amp;#x70B9;&amp;#xFF0C;$p$,$q_x$,$q_z$&amp;#x9012;&amp;#x63A8;&amp;#x5173;&amp;#x7CFB;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#xFF1A;&lt;/p&gt;
&lt;table&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;img src=&quot;/2016/09/15/fd-2d/p1.jpg&quot; width=&quot;200&quot;&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/2016/09/15/fd-2d/q_x1.jpg&quot; width=&quot;200&quot;&gt;&lt;/td&gt;
      &lt;td&gt;&lt;img src=&quot;/2016/09/15/fd-2d/q_z1.jpg&quot; width=&quot;200&quot;&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;

&lt;h2 id=&quot;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;a href=&quot;#&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;/a&gt;&amp;#x4E8C;&amp;#x9636;&amp;#x7CBE;&amp;#x5EA6;&amp;#x6709;&amp;#x73B0;&amp;#x5DEE;&amp;#x5206;&amp;#x5B9E;&amp;#x73B0;&lt;/h2&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        p &amp; = &amp; p_x + p_z\\
        \frac{\partial p_x}{\partial t} &amp; = &amp; -\rho v^2
            \frac{\partial q_x}{\partial x}\\
        \frac{\partial p_z}{\partial_t} &amp; = &amp; -\rho v^2
            \frac{\partial q_z}{\partial z}\\
        \frac{\partial q_x}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial x}\\
        \frac{\partial q_z}{\partial t} &amp; = &amp;
            - \frac{1}{\rho} \frac{\partial (p_x+p_z)}{\partial z}
    \end{cases}
    \Rightarrow
    \begin{cases}
        p &amp; = &amp; p_x + p_z \\
        D_t p_x &amp; = &amp; -\rho v^2 D_x q_x \\
        D_t p_z &amp; = &amp; -\rho v^2 D_z q_z \\
        D_t q_x &amp; = &amp; - \frac{1}{\rho}  D_x (p_x+p_z)\\
        D_t q_z &amp; = &amp; - \frac{1}{\rho}  D_z (p_x+p_z)
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;q_x&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#q-x-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$q_x$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$q_x$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/15/fd-2d/q_x1.jpg&quot; width=&quot;200&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t q_x(A) &amp; = &amp; - \frac{1}{\rho}  D_x p(A)
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{1}{\Delta t}[q_x(D) - q_x(C)] &amp; = &amp; - \frac{1}{\rho \Delta x} [p(F) - p(E)]
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t}[q_x(x_{i+1/2},z_{j},t_{m+1} )  - &amp; q_x(x_{i+1/2},z_j,t_{m})] \\&amp; =
    - \frac{1}{\rho \Delta x} [ p(x_{i+1},z_j,t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
        q_x(x_{i+1/2},z_{j},t_{m+1} ) = &amp; q_x(x_{i+1/2},z_j,t_{m}) \\
        &amp;- \frac{\Delta t}{\rho \Delta x} [ p(x_{i+1},z_j,t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;q_z&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#q-z-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$q_z$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$q_z$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/15/fd-2d/q_z1.jpg&quot; width=&quot;200&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t q_z(B) &amp; = &amp; - \frac{1}{\rho}  D_z p(B)
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \frac{1}{\Delta t}[q_z(J) - q_z(H)] &amp; = &amp; - \frac{1}{\rho \Delta z} [p(G) - p(E)]
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t}[q_z(x_{i},z_{j+1/2},t_{m+1} ) - &amp; q_z(x_{i},z_{j+1/2},t_{m})] \\&amp; =
    - \frac{1}{\rho \Delta z} [ p(x_i,z_{j+1},t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    q_z(x_{i},z_{j+1/2},t_{m+1} ) = &amp; q_z(x_{i},z_{j+1/2},t_{m}) \\
    &amp;- \frac{\Delta t}{\rho \Delta z} [ p(x_i,z_{j+1},t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;p_x&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#p-x-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$p_x$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$p_x$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/15/fd-2d/p1.jpg&quot; width=&quot;400&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t p_x &amp; = &amp; -\rho v^2 D_x q_x
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t} [p_x(x_i,z_j,t_{m+1/2}) - &amp; p_x(x_i,z_j,t_{m-1/2})] \\
    &amp; = -\frac{\rho v^2}{\Delta x} [ q_x(x_{i+1/2},z_j,t_m) - q_x(x_{i-1/2,z_j,t_m}) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    p_x(x_i,z_j,t_{m+1/2}) = &amp; p_x(x_i,z_j,t_{m-1/2})\\
    &amp;  -\frac{\rho v^2\Delta t}{\Delta x} [ q_x(x_{i+1/2},z_j,t_m) - q_x(x_{i-1/2,z_j,t_m}) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h3 id=&quot;p_z&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;a href=&quot;#p-z-&amp;#x9012;&amp;#x63A8;&quot; class=&quot;headerlink&quot; title=&quot;$p_z$&amp;#x9012;&amp;#x63A8;&quot;&gt;&lt;/a&gt;$p_z$&amp;#x9012;&amp;#x63A8;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/15/fd-2d/p1.jpg&quot; width=&quot;400&quot;&gt;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t p_z &amp; = &amp; -\rho v^2 D_z q_z
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    \frac{1}{\Delta t} [p_z(x_i,z_j,t_{m+1/2}) - &amp; p_z(x_i,z_j,t_{m-1/2})] \\
    &amp; = -\frac{\rho v^2}{\Delta z} [ q_z(x_i,z_{j+1/2},t_m) - q_z(x_i,z_{j-1/2},t_m) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
    p_z(x_i,z_j,t_{m+1/2}) = &amp; p_z(x_i,z_j,t_{m-1/2}) \\
    &amp;  -\frac{\rho v^2\Delta t}{\Delta z} [ q_z(x_i,z_{j+1/2},t_m) - q_z(x_i,z_{j-1/2},t_m) ]\\
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot;&gt;&lt;a href=&quot;#&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&quot;&gt;&lt;/a&gt;&amp;#x9012;&amp;#x63A8;&amp;#x6C47;&amp;#x603B;&lt;/h2&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{aligned}
        \begin{cases}
            q_x(x_{i+1/2},z_{j},t_{m+1} ) = &amp; q_x(x_{i+1/2},z_j,t_{m}) \\
                &amp;- \frac{\Delta t}{\rho \Delta x} [ p(x_{i+1},z_j,t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
                \\
            q_z(x_{i},z_{j+1/2},t_{m+1} ) = &amp; q_z(x_{i},z_{j+1/2},t_{m}) \\
                &amp;- \frac{\Delta t}{\rho \Delta z} [ p(x_i,z_{j+1},t_{m+1/2}) - p(x_{i},z_j,t_{m+1/2}) ]
                \\
            p_x(x_i,z_j,t_{m+1/2}) = &amp; p_x(x_i,z_j,t_{m-1/2})\\
                &amp;-\frac{\rho v^2\Delta t}{\Delta x} [ q_x(x_{i+1/2},z_j,t_m) - q_x(x_{i-1/2,z_j,t_m}) ]
                \\
            p_z(x_i,z_j,t_{m+1/2}) = &amp; p_z(x_i,z_j,t_{m-1/2}) \\
                &amp;-\frac{\rho v^2\Delta t}{\Delta z} [ q_z(x_i,z_{j+1/2},t_m) - q_z(x_i,z_{j-1/2},t_m) ]
        \end{cases}
    \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x6545;&amp;#x800C;&amp;#xFF0C;&amp;#x6CE2;&amp;#x573A;&amp;#x9012;&amp;#x63A8;&amp;#x5173;&amp;#x7CFB;&amp;#x4E3A;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
    \begin{cases}
        q_x(t=0)\\
        q_z(t=0)\\
        p(t=\Delta /2)
    \end{cases}
    \Rightarrow
    \begin{cases}
        \color{red}{q_x(t=\Delta t)}\\
        \color{red}{q_z(t=\Delta t)}\\
    \end{cases}
    \\
    \Rightarrow
    \begin{cases}
        \color{red}{q_x(t=\Delta t)}\\
        \color{red}{q_z(t=\Delta t)}\\
        p(t=\Delta /2)
    \end{cases}
    \Rightarrow
        \color{blue}{p(t=3\Delta /2)}
    \\
    \Rightarrow
    \begin{cases}
        \color{red}{q_x(t=\Delta t)}\\
        \color{red}{q_z(t=\Delta t)}\\
        \color{blue}{p(t=3\Delta /2)}
    \end{cases}
    \Rightarrow
    \begin{cases}
        \color{green}{q_x(t=2\Delta t)}\\
        \color{green}{q_z(t=2\Delta t)}\\
    \end{cases}
    \\
    \Rightarrow
    \begin{cases}
        \color{green}{q_x(t=2\Delta t)}\\
        \color{green}{q_z(t=2\Delta t)}\\
        \color{blue}{p(t=3\Delta /2)}
    \end{cases}
    \Rightarrow
    ............
    \\ \\
    ... ...
\end{equation}&lt;/script&gt;&lt;h2 id=&quot;implementation&quot;&gt;&lt;a href=&quot;#Implementation&quot; class=&quot;headerlink&quot; title=&quot;Implementation&quot;&gt;&lt;/a&gt;Implementation&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/15/fd-2d/wave_field.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%Matlab&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    close all; clear; clc;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%Parameters&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    nx = &lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;; nz = &lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;; dx = &lt;span class=&quot;number&quot;&gt;5.0&lt;/span&gt;; dz = &lt;span class=&quot;number&quot;&gt;5.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    x  = (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) *dx; z  = (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:nz&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) *dz;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dt = &lt;span class=&quot;number&quot;&gt;1.0e-3&lt;/span&gt;; nt = &lt;span class=&quot;number&quot;&gt;2000&lt;/span&gt;; t  = (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:nt&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)*dt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    v = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;)+&lt;span class=&quot;number&quot;&gt;800.0&lt;/span&gt;;v(&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;,:) = &lt;span class=&quot;number&quot;&gt;1500.0&lt;/span&gt;;v(&lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;300&lt;/span&gt;,:) = &lt;span class=&quot;number&quot;&gt;2000.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    v2 =  v.^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; rho = &lt;span class=&quot;number&quot;&gt;1000.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%Coefficients&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a_qx= dt/dx/rho; a_qz= dt/dz/rho;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    a_px= dt*rho/dx; a_pz= dt*rho/dz;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%Initial condition&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p   = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(nx,nz);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p_x = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(nx,  nz); p_z = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(nx,  nz);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    q_x = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;,nz); q_z = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(nx,nz&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%Receiver&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    rec = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(nt,nx); trace=&lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(nt,&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    trace(:,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) = &lt;span class=&quot;number&quot;&gt;-4&lt;/span&gt;; trace(:,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;) = &lt;span class=&quot;number&quot;&gt;-3&lt;/span&gt;; trace(:,&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;) = &lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;; trace(:,&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;) = &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    trace(:,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;) =  &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; trace(:,&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;) =  &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; trace(:,&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;) =  &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;; trace(:,&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;) =  &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    trace(:,&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;) =  &lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;; trace_fill = trace;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%Source&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    src = [ &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;*mexihat(&lt;span class=&quot;number&quot;&gt;-5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;) zeros(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,nt)]; ix_src = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; iz_src = &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    figure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%Main loop&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; it = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;%     1   2   3   4   5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;%   --q---q---q---q---q--...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;%   p---p---p---p---p---p...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;%   1   2   3   4   5   6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p_x(ix_src, iz_src) = p_x(ix_src,iz_src) + src(it)/&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p_z(ix_src, iz_src) = p_z(ix_src,iz_src) + src(it)/&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p(  ix_src, iz_src) = p(  ix_src,iz_src) + src(it)/&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ix = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;%q_x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; iz = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                q_x(ix,iz) = q_x(ix,iz) - a_qx *( p(ix+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,iz) - p(ix,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; iz = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nz&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;%q_z&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ix = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                q_z(ix,iz) = q_z(ix,iz) - a_qz *( p(ix,iz+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) - p(ix,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ix = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt; &lt;span class=&quot;comment&quot;&gt;%p_x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; iz = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;:nz&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p_x(ix,iz) = p_x(ix,iz) - a_px *v2(ix,iz)*( q_x(ix,iz) - q_x(ix-    &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,iz) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p_z(ix,iz) = p_z(ix,iz) - a_pz *v2(ix,iz)*( q_z(ix,iz) - q_z(ix,iz- &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                p(ix,iz)   = p_x(ix,iz) + p_z(ix,iz);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;%Free boundary at z = 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,:)    = p(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,:); p_x(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,:)  = p_x(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,:); p_z(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,:)  = p_z(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,:);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;%Plot&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rec(it,:)   = p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,:);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p_trace = &lt;span class=&quot;number&quot;&gt;20.0&lt;/span&gt;* [p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;149&lt;/span&gt;) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;210&lt;/span&gt; ) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;) p(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;270&lt;/span&gt;)];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        trace(it,:) = trace(it,:) + p_trace;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        trace_fill(it,:) = trace_fill(it,:) + &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;*(p_trace + &lt;span class=&quot;built_in&quot;&gt;abs&lt;/span&gt;(p_trace) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pmax = max(max( &lt;span class=&quot;built_in&quot;&gt;abs&lt;/span&gt;(p) ));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        subplot(&lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;),imagesc(x, z, p/pmax );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        colormap(&lt;span class=&quot;string&quot;&gt;&amp;apos;gray&amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        axis square;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        w_max = max(max( &lt;span class=&quot;built_in&quot;&gt;abs&lt;/span&gt;(rec) ));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        subplot(&lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;),imagesc(x,t,rec./w_max);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        colormap(&lt;span class=&quot;string&quot;&gt;&amp;apos;gray&amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        subplot(&lt;span class=&quot;number&quot;&gt;223&lt;/span&gt;),fill(t, trace_fill ,&lt;span class=&quot;string&quot;&gt;&amp;apos;r&amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        hold on;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        subplot(&lt;span class=&quot;number&quot;&gt;223&lt;/span&gt;),plot(t,trace,&lt;span class=&quot;string&quot;&gt;&amp;apos;k&amp;apos;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        hold off;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        pause(&lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x4E00;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x5728;&amp;#x4E8C;&amp;#x7EF4;&amp;#x4E0B;&amp;#x7684;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x6A21;&amp;#x62DF;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/15/fd-2d/wave_field.jpg&quot; width=&quot;600px&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="wave equation" scheme="http://sheng09.github.io/tags/wave-equation/"/>
    
  </entry>
  
  <entry>
    <title>PML边界-一阶声波方程有线差分模拟</title>
    <link href="http://sheng09.github.io/2016/09/13/fd-1d-PML/"/>
    <id>http://sheng09.github.io/2016/09/13/fd-1d-PML/</id>
    <published>2016-09-13T02:38:40.000Z</published>
    <updated>2016-10-10T01:45:22.036Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x7684;PML&amp;#x5438;&amp;#x6536;&amp;#x8FB9;&amp;#x754C;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x6A21;&amp;#x62DF;&amp;#xFF0C;&amp;#x5E76;&amp;#x5229;&amp;#x7528;&amp;#x4E00;&amp;#x7EF4;&amp;#x6A21;&amp;#x578B;&amp;#x4F8B;&amp;#x5B50;&amp;#x52A0;&amp;#x4EE5;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/13/fd-1d-PML/wave.gif&quot; width=&quot;600px&quot;&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#dx&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot;&gt;$d(x)$&amp;#x7684;&amp;#x9009;&amp;#x62E9;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x5B9E;&amp;#x73B0;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;a href=&quot;#&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;/a&gt;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/h2&gt;&lt;p&gt;&amp;#x4E00;&amp;#x7EF4;&amp;#x7A7A;&amp;#x95F4;&amp;#x4E0B;&amp;#xFF0C;&amp;#x4E00;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x53EF;&amp;#x4EE5;&amp;#x5199;&amp;#x6210;&amp;#x4EE5;&amp;#x4E0B;&amp;#x5F62;&amp;#x5F0F;&amp;#xFF1A;$ $&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        \frac{\partial p }{\partial t} &amp; = &amp; -\rho v^2\frac{\partial q}{\partial x} \\
        \frac{\partial q }{\partial t} &amp; = &amp; -\frac{1}{\rho} \frac{\partial p}{\partial x}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x9488;&amp;#x5BF9;PML&amp;#x533A;&amp;#x57DF;&amp;#xFF0C;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        \frac{\partial p }{\partial t}+d(x)p &amp; = &amp; -\rho v^2\frac{\partial q}{\partial x}\\
        \frac{\partial q }{\partial t}+d(x)q &amp; = &amp; -\frac{1}{\rho} \frac{\partial p}{\partial x}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        D_t p_B + d(x_B) p_B &amp; = &amp; - \rho v^2 D_x q_B \\
        D_t q_A + d(x_A)q_A &amp; = &amp; -\frac{1}{\rho}D_x p_A
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;/a&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/h2&gt;&lt;p&gt;&amp;#x53C2;&amp;#x8003;Virieux(&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1441605&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;1984&lt;/a&gt;, &lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1442147&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;1986&lt;/a&gt;)&amp;#xFF0C;&amp;#x6784;&amp;#x5EFA;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/09/13/fd-1d-PML/grid.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5728;&amp;#x4E8C;&amp;#x9636;&amp;#x5DEE;&amp;#x5206;&amp;#x7CBE;&amp;#x5EA6;&amp;#x4E0B;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#xFF22;&amp;#x70B9;&amp;#x53EF;&amp;#x4EE5;&amp;#x63A8;&amp;#x5BFC;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
        D_t p_B + d(x_B)p_B &amp; = &amp; - \rho v^2 D_x q_B
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
\begin{aligned}
        \Rightarrow\frac{1}{\Delta t} [ p(x_i, t_{m+1/2}) - p(x_i, t_{m-1/2}) ] + &amp; \frac{d(x_i)}{2} [p(x_i, t_{m+1/2}) + p(x_i, t_{m-1/2}) ] \\
        &amp; = -\frac{\rho v^2}{\Delta x} [ q(x_{i+1/2}, t_m) - q(x_{i-1/2}, t_m) ]
\end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
  \Rightarrow
  \begin{cases}
        p(x_i, t_{m+1/2}) &amp; = &amp; c_1p(x_i, t_{m-1/2})  + c_2 [ q(x_{i+1/2}, t_m) - q(x_{i-1/2}, t_m) ]\\
        c_1 &amp; = &amp; \frac{2-\Delta t d(x_i)}{2+\Delta t d(x_i)} \\
        c_2 &amp; = &amp; -\frac{2\rho v^2 \Delta t}{\Delta x [2+ \Delta td(x_i)]} \\
  \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x540C;&amp;#x6837;&amp;#x7684;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x63A8;&amp;#x5BFC;&amp;#xFF21;&amp;#x70B9;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t q_A + d(x_A)q_A &amp; = &amp; -\frac{1}{\rho}D_x p_A
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
  \begin{aligned}
    \Rightarrow
    \frac{1}{\Delta t} [q(x_{i+1/2},t_{m+1})- q(x_{i+1/2},t_{m}) ]&amp; +
    \frac{d(x_{i+1/2})}{2} [q(x_{i+1/2},t_{m+1})+ q(x_{i+1/2},t_{m}) ]\\
    &amp;=  -\frac{1}{\rho \Delta x} [p(x_{i+1}, t_{m+1/2}) - p(x_i, t_{m+1/2})]
  \end{aligned}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
  \Rightarrow
    \begin{cases}
      q(x_{i+1/2},t_{m+1}) &amp; = &amp; f_1q(x_{i+1/2},t_{m}) + f_2[p(x_{i+1}, t_{m+1/2}) - p(x_i, t_{m+1/2})] \\
      f_1 &amp; = &amp;  \frac{2-\Delta t d(x_{i+1/2})}{2+\Delta t d(x_{i+1/2})}\\
      f_2 &amp; = &amp; -\frac{2\Delta t}{\rho \Delta x[2+ \Delta td(x_{i+1/2})]}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x6545;&amp;#x800C;&amp;#xFF0C;&amp;#x6CE2;&amp;#x573A;&amp;#x9012;&amp;#x63A8;&amp;#x5173;&amp;#x7CFB;&amp;#x4E3A;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
  \begin{cases}
    q(t=0) \\
    p(t=\Delta t/2)
  \end{cases}
  \Rightarrow
    \color{red}{q(t=\Delta t)}
  \\\Rightarrow
  \begin{cases}
    \color{red}{q(t=\Delta t)} \\
    p(t=\Delta t/2)
  \end{cases}
  \Rightarrow \color{blue}{p(t=3\Delta t/2)}
  \\\Rightarrow
  \begin{cases}
    \color{red}{q(t=\Delta t)} \\
    \color{blue}{p(t=3\Delta t/2)}\\
  \end{cases}
  \Rightarrow \color{green}{q(t=2\Delta t)}
  \\\Rightarrow
  \begin{cases}
    \color{green}{q(t=2\Delta t)} \\
    \color{blue}{p(t=3\Delta t/2)}
  \end{cases}
  \Rightarrow ............\\
  ...

  \end{equation}&lt;/script&gt;&lt;h2 id=&quot;dx&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot;&gt;&lt;a href=&quot;#d-x-&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot; class=&quot;headerlink&quot; title=&quot;$d(x)$&amp;#x7684;&amp;#x9009;&amp;#x62E9;&quot;&gt;&lt;/a&gt;$d(x)$&amp;#x7684;&amp;#x9009;&amp;#x62E9;&lt;/h2&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
d(x) = log(\frac{1}{R}) \frac{3v}{2\delta}(\frac{x}{\delta})^2&lt;/script&gt;&lt;p&gt;$R$&amp;#x63A8;&amp;#x8350;&amp;#x53D6;0.001&amp;#xFF0C;$\delta$&amp;#x4E3A;PML&amp;#x5C42;&amp;#x539A;[&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1444908&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Collino and Tsogka 2001&lt;/a&gt;]&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;a href=&quot;#&amp;#x5B9E;&amp;#x73B0;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;/a&gt;&amp;#x5B9E;&amp;#x73B0;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/13/fd-1d-PML/wave.gif&quot; width=&quot;600px&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;% Matlab&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%Parameters%&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  clear;close all; clc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  n_pml = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  nx = &lt;span class=&quot;number&quot;&gt;1020&lt;/span&gt;; dx  = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;; x = (-n_pml:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;-n_pml) * dx; &lt;span class=&quot;comment&quot;&gt;%(1:11) and (1010:1020) are PML zone&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  nt = &lt;span class=&quot;number&quot;&gt;700&lt;/span&gt;;  dt  = &lt;span class=&quot;number&quot;&gt;1.0e-2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  v  = &lt;span class=&quot;number&quot;&gt;1000.0&lt;/span&gt;; rho = &lt;span class=&quot;number&quot;&gt;1500&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  R = &lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;; delta = n_pml * dx; d_const = (&lt;span class=&quot;number&quot;&gt;3.0&lt;/span&gt;*v/&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;/delta)*&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1.0&lt;/span&gt;/R) /(delta*delta);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%d(x)%&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  d_pLeft  = ( (-n_pml:&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)*dx ) .^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  d_pRight = ( (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:n_pml)*dx  ) .^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  d_qLeft  = ( (-n_pml:&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)*dx +dx/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; ) .^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  d_qRight = ( (&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:n_pml)*dx -dx/&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;   ) .^&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; * d_const;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  d_p      = [d_pLeft zeros(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,nx&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;*n_pml&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;) d_pRight];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  d_q      = [d_qLeft zeros(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,nx&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;*n_pml&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) d_qRight];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  c1       = (&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;-dt*d_p)./(&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;+dt*d_p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  c2       = (&lt;span class=&quot;number&quot;&gt;-2.0&lt;/span&gt;*rho*v*v*dt)./dx./(&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;+dt*d_p);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  f1       = (&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;-dt*d_q)./(&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;+dt*d_q);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  f2       = ( (&lt;span class=&quot;number&quot;&gt;-2.0&lt;/span&gt;*dt)./rho./dx) ./ (&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt;+dt.*d_q);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%source%&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  f_wave = &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;*&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt; * &lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt; ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  n_stop = &lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;( &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt; * &lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt; / f_wave   / dt );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  src= [ sin( (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:n_stop)*dt*f_wave) zeros(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,nt) ]; &lt;span class=&quot;comment&quot;&gt;%source&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  p  = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,nx); q  = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;%initial conditions&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  new = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; old = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  figure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  xmin = min(x); xmax = max(x);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;%main loop%&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; it = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;%  1   2   3   4   5  ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;%--q---q---q---q---q--...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;%p---p---p---p---p---p...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;%1   2   3   4   5   6...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      p(old,&lt;span class=&quot;number&quot;&gt;511&lt;/span&gt;) = src(it)+p(old,&lt;span class=&quot;number&quot;&gt;511&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ix = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          q(new,ix) = f1(ix)* q(old,ix) + f2(ix) * ( p(old,ix+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) - p(old,ix) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ix = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          p(new,ix) = c1(ix)* p(old,ix) + c2(ix) * ( q(new,ix) - q(new,ix&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;%p(new,nx) = p(new,nx-1); % free boundary&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &lt;span class=&quot;comment&quot;&gt;%p(new,1)  = p(new,2);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      p(new,nx) = &lt;span class=&quot;number&quot;&gt;0.0&lt;/span&gt;; &lt;span class=&quot;comment&quot;&gt;% rigid boundary&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      p(new,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)  = &lt;span class=&quot;number&quot;&gt;0.0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      plot(x,p(old,:));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      axis( [xmin xmax &lt;span class=&quot;number&quot;&gt;-1.5&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;] );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      pause(&lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      tmp = old; old = new; new = tmp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&lt;a href=&quot;#&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&lt;/a&gt;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1441605&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Virieux J. SH-wave propagation in heterogeneous media: Velocity-stress finite-difference method[J]. Geophysics, 1984, 49(11): 1933-1942.&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1442147&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Virieux J. P-SV wave propagation in heterogeneous media: Velocity-stress finite-difference method[J]. Geophysics, 1986, 51(4): 889-901.&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1444908&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Collino, Francis, and Chrysoula Tsogka. &amp;#x201C;Application of the perfectly matched absorbing layer model to the linear elastodynamic problem in anisotropic heterogeneous media.&amp;#x201D; Geophysics 66.1 (2001): 294-307.&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x7684;PML&amp;#x5438;&amp;#x6536;&amp;#x8FB9;&amp;#x754C;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x6A21;&amp;#x62DF;&amp;#xFF0C;&amp;#x5E76;&amp;#x5229;&amp;#x7528;&amp;#x4E00;&amp;#x7EF4;&amp;#x6A21;&amp;#x578B;&amp;#x4F8B;&amp;#x5B50;&amp;#x52A0;&amp;#x4EE5;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/13/fd-1d-PML/wave.gif&quot; width=&quot;600px&quot;&gt;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="wave equation" scheme="http://sheng09.github.io/tags/wave-equation/"/>
    
  </entry>
  
  <entry>
    <title>一阶声波方程有线差分模拟</title>
    <link href="http://sheng09.github.io/2016/09/13/fd-1d/"/>
    <id>http://sheng09.github.io/2016/09/13/fd-1d/</id>
    <published>2016-09-12T22:38:40.000Z</published>
    <updated>2016-10-10T01:45:23.792Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x4E00;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x6A21;&amp;#x62DF;&amp;#xFF0C;&amp;#x5E76;&amp;#x5229;&amp;#x7528;&amp;#x4E00;&amp;#x7EF4;&amp;#x6A21;&amp;#x578B;&amp;#x4F8B;&amp;#x5B50;&amp;#x52A0;&amp;#x4EE5;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/13/fd-1d/wave.gif&quot; width=&quot;600px&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&amp;#x5B9E;&amp;#x73B0;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;a href=&quot;#&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&quot;&gt;&lt;/a&gt;&amp;#x63A7;&amp;#x5236;&amp;#x65B9;&amp;#x7A0B;&lt;/h2&gt;&lt;p&gt;&amp;#x4E00;&amp;#x7EF4;&amp;#x7A7A;&amp;#x95F4;&amp;#x4E0B;&amp;#xFF0C;&amp;#x4E00;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x53EF;&amp;#x4EE5;&amp;#x5199;&amp;#x6210;&amp;#x4EE5;&amp;#x4E0B;&amp;#x5F62;&amp;#x5F0F;&amp;#xFF1A;$ $&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        \frac{\partial p }{\partial t} &amp; = &amp; -\rho v^2\frac{\partial q}{\partial x} + f\\
        \frac{\partial q }{\partial t} &amp; = &amp; -\frac{1}{\rho} \frac{\partial p}{\partial x} + q_0
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x5728;&amp;#x65E0;&amp;#x5916;&amp;#x529B;&amp;#x4F5C;&amp;#x7528;&amp;#x65E0;&amp;#x4FE1;&amp;#x53F7;&amp;#x8F93;&amp;#x5165;&amp;#x60C5;&amp;#x51B5;&amp;#x4E0B;&amp;#xFF0C;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x53CA;&amp;#x5176;&amp;#x5DEE;&amp;#x5206;&amp;#x5F62;&amp;#x5F0F;&amp;#x4E3A;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        \frac{\partial p }{\partial t} &amp; = &amp; -\rho v^2\frac{\partial q}{\partial x}\\
        \frac{\partial q }{\partial t} &amp; = &amp; -\frac{1}{\rho} \frac{\partial p}{\partial x}
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \begin{cases}
        D_t p_B &amp; = &amp; - \rho v^2 D_x q_B \\
        D_t q_A &amp; = &amp; -\frac{1}{\rho}D_x p_A
    \end{cases}
\end{eqnarray}&lt;/script&gt;&lt;h2 id=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;a href=&quot;#&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&quot;&gt;&lt;/a&gt;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&lt;/h2&gt;&lt;p&gt;&amp;#x53C2;&amp;#x8003;Virieux(&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1441605&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;1984&lt;/a&gt;, &lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1442147&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;1986&lt;/a&gt;)&amp;#xFF0C;&amp;#x6784;&amp;#x5EFA;&amp;#x4EA4;&amp;#x9519;&amp;#x7F51;&amp;#x683C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/09/13/fd-1d/grid.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5728;&amp;#x4E8C;&amp;#x9636;&amp;#x5DEE;&amp;#x5206;&amp;#x7CBE;&amp;#x5EA6;&amp;#x4E0B;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#xFF22;&amp;#x70B9;&amp;#x53EF;&amp;#x4EE5;&amp;#x63A8;&amp;#x5BFC;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
        D_t p_B &amp; = &amp; - \rho v^2 D_x q_B \\
        \Rightarrow \frac{1}{\Delta t} [ p(x_i, t_{m+1/2}) - p(x_i, t_{m-1/2}) ] &amp; = &amp;  -\frac{\rho v^2}{\Delta x} [ q(x_{i+1/2}, t_m) - q(x_{i-1/2}, t_m) ]
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
        \Rightarrow p(x_i, t_{m+1/2}) &amp; = &amp; p(x_i, t_{m-1/2})  - \frac{\rho v^2 \Delta t}{\Delta x} [ q(x_{i+1/2}, t_m) - q(x_{i-1/2}, t_m)
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x540C;&amp;#x6837;&amp;#x7684;&amp;#xFF0C;&amp;#x53EF;&amp;#x4EE5;&amp;#x63A8;&amp;#x5BFC;&amp;#xFF21;&amp;#x70B9;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    D_t q_A &amp; = &amp; -\frac{1}{\rho}D_x p_A \\
    \Rightarrow \frac{1}{\Delta t} [q(x_{i+1/2},t_{m+1})- q(x_{i+1/2},t_{m}) ]&amp; = &amp; -\frac{1}{\rho \Delta x} [p(x_{i+1}, t_{m+1/2}) - p(x_i, t_{m+1/2})]
\end{eqnarray}&lt;/script&gt;&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{eqnarray}
    \Rightarrow q(x_{i+1/2},t_{m+1}) &amp; = &amp; q(x_{i+1/2},t_{m}) -\frac{\Delta t}{\rho \Delta x} [p(x_{i+1}, t_{m+1/2}) - p(x_i, t_{m+1/2})]
\end{eqnarray}&lt;/script&gt;&lt;p&gt;&amp;#x6545;&amp;#x800C;&amp;#xFF0C;&amp;#x6CE2;&amp;#x573A;&amp;#x9012;&amp;#x63A8;&amp;#x5173;&amp;#x7CFB;&amp;#x4E3A;&amp;#xFF1A;&lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\begin{equation}
  \begin{cases}
    q(t=0) \\
    p(t=\Delta t/2)
  \end{cases}
  \Rightarrow
    \color{red}{q(t=\Delta t)}
  \\\Rightarrow
  \begin{cases}
    \color{red}{q(t=\Delta t)} \\
    p(t=\Delta t/2)
  \end{cases}
  \Rightarrow \color{blue}{p(t=3\Delta t/2)}
  \\\Rightarrow
  \begin{cases}
    \color{red}{q(t=\Delta t)} \\
    \color{blue}{p(t=3\Delta t/2)}\\
  \end{cases}
  \Rightarrow \color{green}{q(t=2\Delta t)}
  \\\Rightarrow
  \begin{cases}
    \color{green}{q(t=2\Delta t)} \\
    \color{blue}{p(t=3\Delta t/2)}
  \end{cases}
  \Rightarrow ............\\
  ...

  \end{equation}&lt;/script&gt;&lt;h2 id=&quot;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;a href=&quot;#&amp;#x5B9E;&amp;#x73B0;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x5B9E;&amp;#x73B0;&quot;&gt;&lt;/a&gt;&amp;#x5B9E;&amp;#x73B0;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/09/13/fd-1d/wave.gif&quot; width=&quot;600px&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight matlab&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;% Matlab&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;clear;close all; clc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nx = &lt;span class=&quot;number&quot;&gt;1000&lt;/span&gt;;   dx  = &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;; x = (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) * dx;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nt = &lt;span class=&quot;number&quot;&gt;2500&lt;/span&gt;;   dt  = &lt;span class=&quot;number&quot;&gt;1.0e-2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;v  = &lt;span class=&quot;number&quot;&gt;1000.0&lt;/span&gt;; rho = &lt;span class=&quot;number&quot;&gt;1500&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;f_wave = &lt;span class=&quot;number&quot;&gt;0.5&lt;/span&gt;*&lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt; * &lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt; ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;n_stop = &lt;span class=&quot;built_in&quot;&gt;floor&lt;/span&gt;( &lt;span class=&quot;number&quot;&gt;2.0&lt;/span&gt; * &lt;span class=&quot;built_in&quot;&gt;pi&lt;/span&gt; / f_wave   / dt );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;src= [ sin( (&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:n_stop)*dt*f_wave) zeros(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,nt) ]; &lt;span class=&quot;comment&quot;&gt;%source&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;p  = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,nx); q  = &lt;span class=&quot;built_in&quot;&gt;zeros&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;%initial conditions&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;new = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;; old = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;c_q = &lt;span class=&quot;number&quot;&gt;-1.0&lt;/span&gt;*dt/rho/dx; c_p = &lt;span class=&quot;number&quot;&gt;-1.0&lt;/span&gt;*rho*v*v*dt/dx;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;figure&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; it = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%  1   2   3   4   5  ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%--q---q---q---q---q--...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%p---p---p---p---p---p...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%1   2   3   4   5   6...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p(old,&lt;span class=&quot;number&quot;&gt;501&lt;/span&gt;) = src(it)+p(old,&lt;span class=&quot;number&quot;&gt;501&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ix = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        q(new,ix) = q(old,ix) + c_q * ( p(old,ix+&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) - p(old,ix) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; ix = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;:nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        p(new,ix) = p(old,ix) + c_p * ( q(new,ix) - q(new,ix&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p(new,nx) = p(new,nx&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;% free boundary&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    p(new,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)  = p(new,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%p(new,nx) = 0.0; % rigid boundary&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;%p(new,1)  = 0.0;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    plot(x,p(old,:));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    axis( [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt; nx*dx &lt;span class=&quot;number&quot;&gt;-1.5&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;1.5&lt;/span&gt;] );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pause(&lt;span class=&quot;number&quot;&gt;0.001&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    tmp = old; old = new; new = tmp;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;end&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&lt;a href=&quot;#&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&quot;&gt;&lt;/a&gt;&amp;#x53C2;&amp;#x8003;&amp;#x6587;&amp;#x732E;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1441605&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Virieux J. SH-wave propagation in heterogeneous media: Velocity-stress finite-difference method[J]. Geophysics, 1984, 49(11): 1933-1942.&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://library.seg.org/doi/abs/10.1190/1.1442147&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Virieux J. P-SV wave propagation in heterogeneous media: Velocity-stress finite-difference method[J]. Geophysics, 1986, 51(4): 889-901.&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x672C;&amp;#x6587;&amp;#x4ECB;&amp;#x7ECD;&amp;#x4E86;&amp;#x4E00;&amp;#x9636;&amp;#x58F0;&amp;#x6CE2;&amp;#x65B9;&amp;#x7A0B;&amp;#x6709;&amp;#x9650;&amp;#x5DEE;&amp;#x5206;&amp;#x6A21;&amp;#x62DF;&amp;#xFF0C;&amp;#x5E76;&amp;#x5229;&amp;#x7528;&amp;#x4E00;&amp;#x7EF4;&amp;#x6A21;&amp;#x578B;&amp;#x4F8B;&amp;#x5B50;&amp;#x52A0;&amp;#x4EE5;&amp;#x8BF4;&amp;#x660E;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/13/fd-1d/wave.gif&quot; width=&quot;600px&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="FD" scheme="http://sheng09.github.io/tags/FD/"/>
    
      <category term="modeling" scheme="http://sheng09.github.io/tags/modeling/"/>
    
      <category term="wave equation" scheme="http://sheng09.github.io/tags/wave-equation/"/>
    
  </entry>
  
  <entry>
    <title>FFT终点截断引起的错误</title>
    <link href="http://sheng09.github.io/2016/09/12/fft-endpoint/"/>
    <id>http://sheng09.github.io/2016/09/12/fft-endpoint/</id>
    <published>2016-09-12T01:55:07.000Z</published>
    <updated>2016-10-10T01:47:34.995Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x6211;&amp;#x770B;&amp;#x8FC7;&amp;#x5F88;&amp;#x591A;&amp;#x4F8B;FFT&amp;#x8BA1;&amp;#x7B97;&amp;#x4E2D;&amp;#x7AEF;&amp;#x70B9;&amp;#x5904;&amp;#x7406;&amp;#x7684;&amp;#x9519;&amp;#x8BEF;&amp;#xFF0C;&amp;#x5148;&amp;#x6765;&amp;#x770B;&amp;#x4EE5;&amp;#x4E0B;&amp;#x7684;&amp;#x4F8B;&amp;#x5B50;&amp;#xFF1A;&lt;br&gt;&amp;#x4E0B;&amp;#x56FE;&amp;#x4E2D;&amp;#xFF0C;1Hz&amp;#x7684;&amp;#x5468;&amp;#x671F;&amp;#x6B63;&amp;#x5F26;&amp;#x4FE1;&amp;#x53F7;$sin(2\pi t)$&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;FFT&amp;#x8BA1;&amp;#x7B97;&amp;#xFF0C;&amp;#x5176;&amp;#x529F;&amp;#x7387;&amp;#x9891;&amp;#x8C31;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5B58;&amp;#x5728;1Hz&amp;#x4EE5;&amp;#x5916;&amp;#x7684;&amp;#x4FE1;&amp;#x53F7;&amp;#xFF0C;&amp;#x8FD9;&amp;#x663E;&amp;#x7136;&amp;#x662F;&amp;#x4E0D;&amp;#x5BF9;&amp;#x7684;&amp;#x3002;&lt;br&gt;&amp;#x5728;&amp;#x5F88;&amp;#x591A;&amp;#x6848;&amp;#x4F8B;&amp;#x4E2D;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E00;&amp;#x73B0;&amp;#x8C61;&amp;#x88AB;&amp;#x5FFD;&amp;#x89C6;&amp;#xFF0C;&amp;#x6216;&amp;#x8005;&amp;#x88AB;&amp;#x89E3;&amp;#x91CA;&amp;#x4E3A;&amp;#x8BA1;&amp;#x7B97;&amp;#x8BEF;&amp;#x5DEE;&amp;#x3002;&amp;#x7279;&amp;#x522B;&amp;#x662F;&amp;#x5F53;&amp;#x4FE1;&amp;#x53F7;&amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#x8DB3;&amp;#x591F;&amp;#x957F;&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E00;&amp;#x7279;&amp;#x5F81;&amp;#x4F1A;&amp;#x5341;&amp;#x5206;&amp;#x7684;&amp;#x4E0D;&amp;#x660E;&amp;#x663E;&amp;#x3002;&amp;#x4EA6;&amp;#x6709;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#x6848;&amp;#x4F8B;&amp;#x671F;&amp;#x671B;&amp;#x901A;&amp;#x8FC7;&amp;#x8865;&amp;#x96F6;&amp;#x6765;&amp;#x4F18;&amp;#x5316;&amp;#x7ED3;&amp;#x679C;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/12/fft-endpoint/wrong_frequency.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x9519;&amp;#x8BEF;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&quot;&gt;&amp;#x9519;&amp;#x8BEF;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x6B63;&amp;#x786E;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&quot;&gt;&amp;#x6B63;&amp;#x786E;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x4FE1;&amp;#x53F7;&amp;#x5904;&amp;#x7406;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;&amp;#x9879;&quot;&gt;&amp;#x4FE1;&amp;#x53F7;&amp;#x5904;&amp;#x7406;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;&amp;#x9879;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;&amp;#x9519;&amp;#x8BEF;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&quot;&gt;&lt;a href=&quot;#&amp;#x9519;&amp;#x8BEF;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x9519;&amp;#x8BEF;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&quot;&gt;&lt;/a&gt;&amp;#x9519;&amp;#x8BEF;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&lt;/h2&gt;&lt;p&gt;&amp;#x8981;&amp;#x5206;&amp;#x6790;&amp;#x8FD9;&amp;#x4E00;&amp;#x9519;&amp;#x8BEF;&amp;#x51FA;&amp;#x73B0;&amp;#x7684;&amp;#x539F;&amp;#x56E0;&amp;#xFF0C;&amp;#x9700;&amp;#x8981;&amp;#x4ECE;FFT&amp;#x7684;&amp;#x9690;&amp;#x542B;&amp;#x5468;&amp;#x671F;&amp;#x6027;&amp;#x6761;&amp;#x4EF6;&amp;#x51FA;&amp;#x53D1;&amp;#x3002;&amp;#x65F6;&amp;#x95F4;&amp;#x57DF;&amp;#x7684;&amp;#x79BB;&amp;#x6563;&amp;#x5316;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E86;&amp;#x9891;&amp;#x7387;&amp;#x57DF;&amp;#x7684;&amp;#x5468;&amp;#x671F;&amp;#x5316;&amp;#xFF0C;&amp;#x800C;&amp;#x9891;&amp;#x7387;&amp;#x57DF;&amp;#x7684;&amp;#x79BB;&amp;#x6563;&amp;#x5316;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E86;&amp;#x65F6;&amp;#x95F4;&amp;#x57DF;&amp;#x7684;&amp;#x5468;&amp;#x671F;&amp;#x5316;&amp;#x3002;&amp;#x6545;&amp;#x7531;&amp;#x65F6;&amp;#x95F4;&amp;#x57DF;&amp;#x7684;&amp;#x79BB;&amp;#x6563;&amp;#x5E8F;&amp;#x5217;&amp;#x53D8;&amp;#x6362;&amp;#x5F97;&amp;#x5230;&amp;#x9891;&amp;#x7387;&amp;#x57DF;&amp;#x7684;&amp;#x79BB;&amp;#x6563;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x9690;&amp;#x542B;&amp;#x4E86;&amp;#x4FE1;&amp;#x53F7;&amp;#x5728;&amp;#x65F6;&amp;#x9891;&amp;#x57DF;&amp;#x7686;&amp;#x4E3A;&amp;#x5468;&amp;#x671F;&amp;#x4FE1;&amp;#x53F7;&amp;#x7684;&amp;#x7EA6;&amp;#x675F;&amp;#x3002;&amp;#x56E0;&amp;#x6B64;&amp;#xFF0C;FFT&amp;#x8BA1;&amp;#x7B97;&amp;#xFF0C;&amp;#x5B9E;&amp;#x9645;&amp;#x4E0A;&amp;#x5BF9;&amp;#x5E94;&amp;#x4E86;&amp;#x5468;&amp;#x671F;&amp;#x5316;&amp;#x7684;&amp;#x65F6;&amp;#x95F4;&amp;#x5E8F;&amp;#x5217;&amp;#x7684;&amp;#x9891;&amp;#x8C31;&amp;#x3002;&lt;br&gt;&amp;#x9488;&amp;#x5BF9;&amp;#x4EE5;&amp;#x4E0A;&amp;#x65F6;&amp;#x95F4;&amp;#x5E8F;&amp;#x5217;&amp;#x4FE1;&amp;#x53F7;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x6784;&amp;#x5EFA;&amp;#x5176;&amp;#x5468;&amp;#x671F;&amp;#x5316;&amp;#x6CE2;&amp;#x5F62;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/09/12/fft-endpoint/wrong_2t.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&amp;#x663E;&amp;#x7136;&amp;#xFF0C;&amp;#x5468;&amp;#x671F;&amp;#x5316;&amp;#x4E4B;&amp;#x540E;&amp;#x7684;&amp;#x4FE1;&amp;#x53F7;&amp;#x5E76;&amp;#x975E;&amp;#x6211;&amp;#x4EEC;&amp;#x9884;&amp;#x60F3;&amp;#x7684;$sin(2\pi t)$&amp;#xFF0C;&amp;#x6240;&amp;#x4EE5;&amp;#x5229;&amp;#x7528;FFT&amp;#x5F97;&amp;#x5230;&amp;#x7684;&amp;#x9891;&amp;#x8C31;&amp;#x663E;&amp;#x7136;&amp;#x4E5F;&amp;#x4E0D;&amp;#x662F;&amp;#x9884;&amp;#x60F3;&amp;#x7684;1Hz&amp;#x3002;&lt;br&gt;&amp;#x800C;&amp;#x51FA;&amp;#x73B0;&amp;#x9891;&amp;#x8C31;&amp;#x6CC4;&amp;#x6F0F;&amp;#xFF0C;&amp;#x4E5F;&amp;#x662F;&amp;#x7531;$t=1$&amp;#x5904;&amp;#x95F4;&amp;#x65AD;&amp;#x5F15;&amp;#x8D77;&amp;#x7684;&amp;#x5409;&amp;#x5E03;&amp;#x65AF;&amp;#x6548;&amp;#x5E94;&amp;#x3002;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x6B63;&amp;#x786E;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&quot;&gt;&lt;a href=&quot;#&amp;#x6B63;&amp;#x786E;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x6B63;&amp;#x786E;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&quot;&gt;&lt;/a&gt;&amp;#x6B63;&amp;#x786E;&amp;#x7684;&amp;#x505A;&amp;#x6CD5;&lt;/h2&gt;&lt;p&gt;&amp;#x90A3;&amp;#x4E48;&amp;#xFF0C;&amp;#x8981;&amp;#x5F97;&amp;#x5230;&amp;#x6B63;&amp;#x786E;&amp;#x7684;&amp;#x9891;&amp;#x8C31;&amp;#xFF0C;&amp;#x6211;&amp;#x4EEC;&amp;#x9700;&amp;#x8981;&amp;#x62B9;&amp;#x6389;&amp;#x539F;&amp;#x59CB;&amp;#x5E8F;&amp;#x5217;&amp;#x672B;&amp;#x5C3E;&amp;#x7684;&amp;#x91C7;&amp;#x6837;&amp;#x70B9;&amp;#xFF1A;&lt;br&gt;&lt;img src=&quot;/2016/09/12/fft-endpoint/frequency.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;&amp;#x6B64;&amp;#x65F6;&amp;#xFF0C;&amp;#x5468;&amp;#x671F;&amp;#x5316;&amp;#x5BF9;&amp;#x5E94;&amp;#x7684;&amp;#x4FE1;&amp;#x53F7;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#xFF0C;&amp;#x663E;&amp;#x7136;&amp;#x662F;&amp;#x6211;&amp;#x4EEC;&amp;#x9884;&amp;#x671F;&amp;#x7684;&amp;#x6B63;&amp;#x5F26;&amp;#x4FE1;&amp;#x53F7;$sin(2\pi t)$&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/12/fft-endpoint/2t.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x4FE1;&amp;#x53F7;&amp;#x5904;&amp;#x7406;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;&amp;#x9879;&quot;&gt;&lt;a href=&quot;#&amp;#x4FE1;&amp;#x53F7;&amp;#x5904;&amp;#x7406;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;&amp;#x9879;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x4FE1;&amp;#x53F7;&amp;#x5904;&amp;#x7406;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;&amp;#x9879;&quot;&gt;&lt;/a&gt;&amp;#x4FE1;&amp;#x53F7;&amp;#x5904;&amp;#x7406;&amp;#x6CE8;&amp;#x610F;&amp;#x4E8B;&amp;#x9879;&lt;/h2&gt;&lt;p&gt;&amp;#x5B9E;&amp;#x9645;&amp;#x4FE1;&amp;#x53F7;&amp;#x5904;&amp;#x7406;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5BF9;&amp;#x4E8E;&amp;#x91C7;&amp;#x6837;&amp;#x70B9;&amp;#x4E3A;$N$&amp;#xFF0C;&amp;#x91C7;&amp;#x6837;&amp;#x95F4;&amp;#x9694;&amp;#x4E3A;$\delta t$&amp;#x7684;&amp;#x79BB;&amp;#x6563;&amp;#x5E8F;&amp;#x5217;&amp;#xFF0C;&amp;#x5176;&amp;#x5468;&amp;#x671F;&amp;#x4E3A;$N\delta t$&amp;#xFF0C;&amp;#x800C;&amp;#x4E0D;&amp;#x662F;$(N-1)\delta t$&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x6211;&amp;#x770B;&amp;#x8FC7;&amp;#x5F88;&amp;#x591A;&amp;#x4F8B;FFT&amp;#x8BA1;&amp;#x7B97;&amp;#x4E2D;&amp;#x7AEF;&amp;#x70B9;&amp;#x5904;&amp;#x7406;&amp;#x7684;&amp;#x9519;&amp;#x8BEF;&amp;#xFF0C;&amp;#x5148;&amp;#x6765;&amp;#x770B;&amp;#x4EE5;&amp;#x4E0B;&amp;#x7684;&amp;#x4F8B;&amp;#x5B50;&amp;#xFF1A;&lt;br&gt;&amp;#x4E0B;&amp;#x56FE;&amp;#x4E2D;&amp;#xFF0C;1Hz&amp;#x7684;&amp;#x5468;&amp;#x671F;&amp;#x6B63;&amp;#x5F26;&amp;#x4FE1;&amp;#x53F7;$sin(2\pi t)$&amp;#xFF0C;&amp;#x901A;&amp;#x8FC7;FFT&amp;#x8BA1;&amp;#x7B97;&amp;#xFF0C;&amp;#x5176;&amp;#x529F;&amp;#x7387;&amp;#x9891;&amp;#x8C31;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5B58;&amp;#x5728;1Hz&amp;#x4EE5;&amp;#x5916;&amp;#x7684;&amp;#x4FE1;&amp;#x53F7;&amp;#xFF0C;&amp;#x8FD9;&amp;#x663E;&amp;#x7136;&amp;#x662F;&amp;#x4E0D;&amp;#x5BF9;&amp;#x7684;&amp;#x3002;&lt;br&gt;&amp;#x5728;&amp;#x5F88;&amp;#x591A;&amp;#x6848;&amp;#x4F8B;&amp;#x4E2D;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E00;&amp;#x73B0;&amp;#x8C61;&amp;#x88AB;&amp;#x5FFD;&amp;#x89C6;&amp;#xFF0C;&amp;#x6216;&amp;#x8005;&amp;#x88AB;&amp;#x89E3;&amp;#x91CA;&amp;#x4E3A;&amp;#x8BA1;&amp;#x7B97;&amp;#x8BEF;&amp;#x5DEE;&amp;#x3002;&amp;#x7279;&amp;#x522B;&amp;#x662F;&amp;#x5F53;&amp;#x4FE1;&amp;#x53F7;&amp;#x7684;&amp;#x5E8F;&amp;#x5217;&amp;#x8DB3;&amp;#x591F;&amp;#x957F;&amp;#x65F6;&amp;#xFF0C;&amp;#x8FD9;&amp;#x4E00;&amp;#x7279;&amp;#x5F81;&amp;#x4F1A;&amp;#x5341;&amp;#x5206;&amp;#x7684;&amp;#x4E0D;&amp;#x660E;&amp;#x663E;&amp;#x3002;&amp;#x4EA6;&amp;#x6709;&amp;#x4E00;&amp;#x90E8;&amp;#x5206;&amp;#x6848;&amp;#x4F8B;&amp;#x671F;&amp;#x671B;&amp;#x901A;&amp;#x8FC7;&amp;#x8865;&amp;#x96F6;&amp;#x6765;&amp;#x4F18;&amp;#x5316;&amp;#x7ED3;&amp;#x679C;&amp;#x3002;&lt;br&gt;&lt;img src=&quot;/2016/09/12/fft-endpoint/wrong_frequency.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Digital Signal Processing" scheme="http://sheng09.github.io/categories/Digital-Signal-Processing/"/>
    
    
      <category term="FFT" scheme="http://sheng09.github.io/tags/FFT/"/>
    
  </entry>
  
  <entry>
    <title>Boundary Conditions for Differential Equations</title>
    <link href="http://sheng09.github.io/2016/09/01/PDE-boundaries/"/>
    <id>http://sheng09.github.io/2016/09/01/PDE-boundaries/</id>
    <published>2016-08-31T19:34:51.000Z</published>
    <updated>2016-08-31T20:26:33.060Z</updated>
    
    <content type="html">&lt;p&gt;There are different types of boundary conditions for ODE(Oridinary Differential Equation) and PDE(Partial Differential Equation). This post present all collections of these boundary conditions and associated equations.&lt;br&gt;Besides, this post also present the combination of Dirichlet and Neumann boundary conditions in construct absorbing boundary for solving wave eqution.&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#dirichlet-boundary-condition&quot;&gt;Dirichlet Boundary Condition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#neumann-boundary-condition&quot;&gt;Neumann Boundary Condition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#robin-boundary-condition&quot;&gt;Robin Boundary Condition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#mixed-boundary-condition&quot;&gt;Mixed Boundary Condition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#cauchy-boundary-condition&quot;&gt;Cauchy Boundary Condition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#associated-problems-for-pde-of-wave-equation&quot;&gt;Associated Problems for PDE of Wave Equation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#reference&quot;&gt;Reference&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;dirichlet-boundary-condition&quot;&gt;&lt;a href=&quot;#Dirichlet-Boundary-Condition&quot; class=&quot;headerlink&quot; title=&quot;Dirichlet Boundary Condition&quot;&gt;&lt;/a&gt;Dirichlet Boundary Condition&lt;/h2&gt;&lt;p&gt;Given ODE or PDE, conditions that specify values of the solution along the boundary of the domain is Dirichlet boundary condition. &lt;a href=&quot;https://en.wikipedia.org/wiki/Dirichlet_boundary_condition&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Wiki&lt;/a&gt;&lt;/p&gt;
&lt;span&gt;$$\begin{equation}
  \begin{cases}
    f(y&amp;apos;&amp;apos;,y) &amp;amp; = &amp;amp; 0 \\
    y(\alpha) &amp;amp; = &amp;amp; 0 \\
    y(\beta) &amp;amp; = &amp;amp; 0
  \end{cases}
\end{equation}$$&lt;/span&gt;&lt;!-- Has MathJax --&gt;
&lt;span&gt;$$\begin{equation}
  \begin{cases}
    f(\nabla^{2}G,G) &amp;amp; = &amp;amp; 0 \\
    G|_{boundary} &amp;amp; = &amp;amp; g(x,y,z)
  \end{cases}
\end{equation}$$&lt;/span&gt;&lt;!-- Has MathJax --&gt;
&lt;h2 id=&quot;neumann-boundary-condition&quot;&gt;&lt;a href=&quot;#Neumann-Boundary-Condition&quot; class=&quot;headerlink&quot; title=&quot;Neumann Boundary Condition&quot;&gt;&lt;/a&gt;Neumann Boundary Condition&lt;/h2&gt;&lt;p&gt;Being different to Dirichlet boundary condition, Neumann boundary condition specify the values of the derivative of the solution along the boundary. &lt;a href=&quot;https://en.wikipedia.org/wiki/Neumann_boundary_condition&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Wiki&lt;/a&gt;&lt;br&gt;&lt;span&gt;$$\begin{equation}
  \begin{cases}
    f(y&amp;apos;&amp;apos;,y) &amp;amp; = &amp;amp; 0 \\
    y&amp;apos;|_{x=\alpha} &amp;amp; = &amp;amp; 0 \\
    y&amp;apos;|_{x=\beta} &amp;amp; = &amp;amp; 0
  \end{cases}
\end{equation}$$&lt;/span&gt;&lt;!-- Has MathJax --&gt;&lt;br&gt;&lt;span&gt;$$\begin{equation}
  \begin{cases}
    f(G&amp;apos;&amp;apos;,G) &amp;amp; = &amp;amp; 0 \\
    G&amp;apos;|_{boundary} &amp;amp; = &amp;amp; g(x,y,z) \\
  \end{cases}
\end{equation}$$&lt;/span&gt;&lt;!-- Has MathJax --&gt;&lt;/p&gt;
&lt;h2 id=&quot;robin-boundary-condition&quot;&gt;&lt;a href=&quot;#Robin-Boundary-Condition&quot; class=&quot;headerlink&quot; title=&quot;Robin Boundary Condition&quot;&gt;&lt;/a&gt;Robin Boundary Condition&lt;/h2&gt;&lt;p&gt;Robin boundary condition is the combination of Dirichlet and Neumann boundary conditions.&lt;a href=&quot;https://en.wikipedia.org/wiki/Robin_boundary_condition&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Wiki&lt;/a&gt;&lt;/p&gt;
&lt;span&gt;$$\begin{equation}
  \begin{cases}
    f(G&amp;apos;&amp;apos;,G) &amp;amp; = &amp;amp; 0 \\
    G+G&amp;apos;|_{boundary} &amp;amp; = &amp;amp; g(x)
  \end{cases}
\end{equation}$$&lt;/span&gt;&lt;!-- Has MathJax --&gt;
&lt;h2 id=&quot;mixed-boundary-condition&quot;&gt;&lt;a href=&quot;#Mixed-Boundary-Condition&quot; class=&quot;headerlink&quot; title=&quot;Mixed Boundary Condition&quot;&gt;&lt;/a&gt;Mixed Boundary Condition&lt;/h2&gt;&lt;p&gt;Being different from Robin condition, Mixed condition means different types of condition along different subset of the boundary. It is much more complex than Robin condition.&lt;a href=&quot;https://en.wikipedia.org/wiki/Mixed_boundary_condition&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Wiki&lt;/a&gt;&lt;/p&gt;
&lt;span&gt;$$\begin{equation}
  \begin{cases}
    f(G&amp;apos;&amp;apos;,G) &amp;amp; = &amp;amp; 0 \\
    G|_{1st\ boundary\ subset} &amp;amp; = &amp;amp; g_1(x) \\
    G&amp;apos;|_{2nd\ boundary\ subset} &amp;amp; = &amp;amp; g_2(x)
  \end{cases}
\end{equation}$$&lt;/span&gt;&lt;!-- Has MathJax --&gt;
&lt;h2 id=&quot;cauchy-boundary-condition&quot;&gt;&lt;a href=&quot;#Cauchy-Boundary-Condition&quot; class=&quot;headerlink&quot; title=&quot;Cauchy Boundary Condition&quot;&gt;&lt;/a&gt;Cauchy Boundary Condition&lt;/h2&gt;&lt;p&gt;In Cauchy boundary condition, Dirichlet and Neumann conditions are declared along the boundary to ensure the unique solution. &lt;a href=&quot;https://en.wikipedia.org/wiki/Cauchy_boundary_condition&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Wiki&lt;/a&gt;&lt;/p&gt;
&lt;span&gt;$$\begin{equation}
  \begin{cases}
    f(G&amp;apos;&amp;apos;,G) &amp;amp; = &amp;amp; 0 \\
    G|_{boundary} &amp;amp; = &amp;amp; g_1(x) \\
    G&amp;apos;|_{ boundary} &amp;amp; = &amp;amp; g_2(x)
  \end{cases}
\end{equation}$$&lt;/span&gt;&lt;!-- Has MathJax --&gt;
&lt;h2 id=&quot;associated-problems-for-pde-of-wave-equation&quot;&gt;&lt;a href=&quot;#Associated-Problems-for-PDE-of-Wave-Equation&quot; class=&quot;headerlink&quot; title=&quot;Associated Problems for PDE of Wave Equation&quot;&gt;&lt;/a&gt;Associated Problems for PDE of Wave Equation&lt;/h2&gt;&lt;p&gt;Considering boundary conditions for wave equation, Dirichlet and Neumann conditions produce reflection that are opposite in sign. Thus, the summation of these two cases will cancel the reflection.[&lt;a href=&quot;http://www.sciencedirect.com/science/article/pii/0021999174900758&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Smith 1974&lt;/a&gt;]&lt;/p&gt;
&lt;h2 id=&quot;reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;Reference&lt;/h2&gt;&lt;p&gt;[1] &lt;a href=&quot;http://www.sciencedirect.com/science/article/pii/0021999174900758&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Smith W D. A nonreflecting plane boundary for wave propagation problems[J]. Journal of Computational Physics, 1974, 15(4): 492-503.&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;There are different types of boundary conditions for ODE(Oridinary Differential Equation) and PDE(Partial Differential Equation). This post present all collections of these boundary conditions and associated equations.&lt;br&gt;Besides, this post also present the combination of Dirichlet and Neumann boundary conditions in construct absorbing boundary for solving wave eqution.&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="PDE" scheme="http://sheng09.github.io/categories/PDE/"/>
    
    
      <category term="PDE" scheme="http://sheng09.github.io/tags/PDE/"/>
    
  </entry>
  
  <entry>
    <title>Hello</title>
    <link href="http://sheng09.github.io/2016/07/13/Hello/"/>
    <id>http://sheng09.github.io/2016/07/13/Hello/</id>
    <published>2016-07-13T06:35:31.000Z</published>
    <updated>2016-07-13T06:35:31.062Z</updated>
    
    <content type="html"></content>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>接收函数理论与实践（三）低速层对接收函数的影响</title>
    <link href="http://sheng09.github.io/2016/06/15/RF-LVZ-03/"/>
    <id>http://sheng09.github.io/2016/06/15/RF-LVZ-03/</id>
    <published>2016-06-15T12:12:25.000Z</published>
    <updated>2017-02-02T09:56:12.664Z</updated>
    
    <content type="html"></content>
    
    <summary type="html">
    
    </summary>
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/categories/Receiver-Function/"/>
    
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/tags/Receiver-Function/"/>
    
      <category term="Interface" scheme="http://sheng09.github.io/tags/Interface/"/>
    
  </entry>
  
  <entry>
    <title>接收函数理论与实践（二）界面梯度对接收函数的影响</title>
    <link href="http://sheng09.github.io/2016/06/15/RF-interface-02/"/>
    <id>http://sheng09.github.io/2016/06/15/RF-interface-02/</id>
    <published>2016-06-15T10:29:14.000Z</published>
    <updated>2017-02-02T09:55:47.052Z</updated>
    
    <content type="html">&lt;p&gt;&amp;#x63A5;&amp;#x6536;&amp;#x51FD;&amp;#x6570;&amp;#x901A;&amp;#x8FC7;&amp;#x53CD;&amp;#x8936;&amp;#x79EF;&amp;#x8BA1;&amp;#x7B97;&amp;#xFF0C;&amp;#x63D0;&amp;#x53D6;&amp;#x6CE2;&amp;#x573A;&amp;#x5728;&amp;#x754C;&amp;#x9762;&amp;#x5904;&amp;#x7684;&amp;#x8F6C;&amp;#x6362;&amp;#x6548;&amp;#x5E94;&amp;#x3002;&amp;#x5728;&amp;#x5B9E;&amp;#x9645;&amp;#x95EE;&amp;#x9898;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x7EDD;&amp;#x5BF9;&amp;#x7684;&amp;#x754C;&amp;#x9762;&amp;#xFF0C;&amp;#x66F4;&amp;#x4E3A;&amp;#x51C6;&amp;#x786E;&amp;#x7684;&amp;#x63CF;&amp;#x8FF0;&amp;#x5E94;&amp;#x8BE5;&amp;#x662F;&amp;#x901F;&amp;#x5EA6;&amp;#x68AF;&amp;#x5EA6;&amp;#x8F83;&amp;#x9AD8;&amp;#x7684;&amp;#x8FC7;&amp;#x5EA6;&amp;#x5E26;&amp;#x3002;&amp;#x4E3A;&amp;#x5BF9;&amp;#x6BD4;&amp;#x68AF;&amp;#x5EA6;&amp;#x5E26;&amp;#x7ED9;&amp;#x63A5;&amp;#x6536;&amp;#x51FD;&amp;#x6570;&amp;#x6CE2;&amp;#x5F62;&amp;#x5E26;&amp;#x6765;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x53C2;&amp;#x8003;&lt;a href=&quot;http://www.eas.slu.edu/eqc/eqc_cps/TUTORIAL/RFTN2/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;CPS Tutorials&amp;#x90E8;&amp;#x5206;&amp;#x5185;&amp;#x5BB9;&lt;/a&gt;&amp;#xFF0C;&amp;#x672C;&amp;#x6587;&amp;#x9009;&amp;#x62E9;&amp;#x4E86;&amp;#x8D70;&amp;#x65F6;&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x68AF;&amp;#x5EA6;&amp;#x53D8;&amp;#x5316;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6A21;&amp;#x578B;&amp;#xFF0C;&amp;#x7528;&amp;#x4E8E;&amp;#x63A5;&amp;#x6536;&amp;#x51FD;&amp;#x6570;&amp;#x6B63;&amp;#x6F14;&amp;#x8BA1;&amp;#x7B97;&amp;#x3002;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x6A21;&amp;#x578B;&amp;#x8BBE;&amp;#x5B9A;&quot;&gt;&amp;#x6A21;&amp;#x578B;&amp;#x8BBE;&amp;#x5B9A;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x6B63;&amp;#x6F14;&amp;#x7ED3;&amp;#x679C;&quot;&gt;&amp;#x6B63;&amp;#x6F14;&amp;#x7ED3;&amp;#x679C;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&amp;#x8FD0;&amp;#x884C;&quot;&gt;&amp;#x8FD0;&amp;#x884C;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- tocstop --&gt;
&lt;h2 id=&quot;&amp;#x6A21;&amp;#x578B;&amp;#x8BBE;&amp;#x5B9A;&quot;&gt;&lt;a href=&quot;#&amp;#x6A21;&amp;#x578B;&amp;#x8BBE;&amp;#x5B9A;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x6A21;&amp;#x578B;&amp;#x8BBE;&amp;#x5B9A;&quot;&gt;&lt;/a&gt;&amp;#x6A21;&amp;#x578B;&amp;#x8BBE;&amp;#x5B9A;&lt;/h2&gt;&lt;p&gt;&amp;#x751F;&amp;#x6210;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x68AF;&amp;#x5EA6;&amp;#x754C;&amp;#x9762;&amp;#x6A21;&amp;#x578B;&amp;#xFF0C;&amp;#x5E76;&amp;#x5408;&amp;#x7406;&amp;#x914D;&amp;#x7F6E;&amp;#x4F7F;&amp;#x8D70;&amp;#x65F6;&amp;#x76F8;&amp;#x540C;&amp;#x3002;&amp;#x6A21;&amp;#x578B;S&amp;#x6CE2;&amp;#x901F;&amp;#x5EA6;&amp;#xFF0C;P&amp;#x6CE2;&amp;#x901F;&amp;#x5EA6;&amp;#x53CA;&amp;#x5BC6;&amp;#x5EA6;&amp;#x5982;&amp;#x4E0B;&amp;#x56FE;&amp;#x6240;&amp;#x793A;&amp;#xFF0C;&amp;#x4E0D;&amp;#x540C;&amp;#x989C;&amp;#x8272;&amp;#x7684;&amp;#x5B9E;&amp;#x7EBF;&amp;#x4EE3;&amp;#x8868;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6A21;&amp;#x578B;&amp;#x3002;&lt;/p&gt;
&lt;table&gt;
&lt;tr&gt;
  &lt;td&gt; &lt;img src=&quot;/2016/06/15/RF-interface-02/VS.jpg&quot; width=&quot;250&quot; align=&quot;center&quot;&gt; &lt;/td&gt;
  &lt;td&gt; &lt;img src=&quot;/2016/06/15/RF-interface-02/VP.jpg&quot; width=&quot;250&quot; align=&quot;center&quot;&gt; &lt;/td&gt;
  &lt;td&gt; &lt;img src=&quot;/2016/06/15/RF-interface-02/RHO.jpg&quot; width=&quot;250&quot; align=&quot;center&quot;&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;

&lt;h2 id=&quot;&amp;#x6B63;&amp;#x6F14;&amp;#x7ED3;&amp;#x679C;&quot;&gt;&lt;a href=&quot;#&amp;#x6B63;&amp;#x6F14;&amp;#x7ED3;&amp;#x679C;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x6B63;&amp;#x6F14;&amp;#x7ED3;&amp;#x679C;&quot;&gt;&lt;/a&gt;&amp;#x6B63;&amp;#x6F14;&amp;#x7ED3;&amp;#x679C;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;/2016/06/15/RF-interface-02/rf_prf.jpg&quot; width=&quot;500&quot; align=&quot;center/&quot;&gt;&lt;br&gt;&lt;img src=&quot;/2016/06/15/RF-interface-02/rf_rainbow.jpg&quot; width=&quot;500&quot; align=&quot;center/&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;&amp;#x8FD0;&amp;#x884C;&quot;&gt;&lt;a href=&quot;#&amp;#x8FD0;&amp;#x884C;&quot; class=&quot;headerlink&quot; title=&quot;&amp;#x8FD0;&amp;#x884C;&quot;&gt;&lt;/a&gt;&amp;#x8FD0;&amp;#x884C;&lt;/h2&gt;&lt;p&gt;&amp;#x4E0B;&amp;#x8F7D;&lt;a href=&quot;/exam/rf_interface.tgz&quot;&gt;rf_interface&lt;/a&gt;&amp;#xFF0C;&amp;#x89E3;&amp;#x538B;&amp;#xFF0C;&amp;#x8FD0;&amp;#x884C;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ./run.sh          &lt;span class=&quot;comment&quot;&gt;#&amp;#x751F;&amp;#x6210;&amp;#x6A21;&amp;#x578B;&amp;#x5E76;&amp;#x6B63;&amp;#x6F14;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ./PlotModels.sh   &lt;span class=&quot;comment&quot;&gt;#&amp;#x7ED8;&amp;#x5236;&amp;#x6A21;&amp;#x578B;&amp;#x56FE;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x6587;&amp;#x4EF6;&amp;#x7ED3;&amp;#x6784;&amp;#x5982;&amp;#x4E0B;&amp;#xFF1A;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;rf_interface/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; PlotModels.sh    #scripts&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; run.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; rf_prf.jpg       #generated diagrams&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; rf_rainbow.jpg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; rf_sac.jpg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; RayPath.c        #program for calculating raypath for specific seismic phase&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; mkgrad.f         #program for generate models, from &amp;#x2018;CPs&amp;#x2019;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; CalRayPara.py    #python scripts for calculating ray parameters&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; CalTrvTPPPS.py   #python scripts for calculating traveltimes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; CalTrvTPPSS.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; CalTrvTPS.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; CalTrvTPSSS.py&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x251C;&amp;#x2500;&amp;#x2500; Grad_Intf_RFS/   #generate RF waveform for models&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2502;&amp;#xA0;&amp;#xA0; &amp;#x251C;&amp;#x2500;&amp;#x2500; RF.0.0618.00.sac&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2502;&amp;#xA0;&amp;#xA0; &amp;#x251C;&amp;#x2500;&amp;#x2500; ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#x2514;&amp;#x2500;&amp;#x2500; models/          #models and diagrams&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#x251C;&amp;#x2500;&amp;#x2500; Grad_Intf_hrftn96_00.model #model&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#x251C;&amp;#x2500;&amp;#x2500; Grad_Intf_hrftn96_00.ps    #single model plot and raypath&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#x251C;&amp;#x2500;&amp;#x2500; ...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#x251C;&amp;#x2500;&amp;#x2500; RHO.jpg      #models set plot&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#x251C;&amp;#x2500;&amp;#x2500; VP.jpg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#x2514;&amp;#x2500;&amp;#x2500; VS.jpg&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&amp;#x5982;&amp;#x679C;&amp;#x5BF9;&amp;#x7A0B;&amp;#x5E8F;&amp;#x6709;&amp;#x4EFB;&amp;#x4F55;&amp;#x7591;&amp;#x95EE;&amp;#xFF0C;&amp;#x6216;&amp;#x8005;&amp;#x53D1;&amp;#x73B0;&amp;#x4EFB;&amp;#x4F55;BUG&amp;#xFF0C;&amp;#x8BF7;&amp;#x7559;&amp;#x8A00;&amp;#xFF0C;&amp;#x6216;&amp;#x8005;&amp;#x81F4;&amp;#x4FE1;&lt;code&gt;wangsheng.cas@gmail.com&lt;/code&gt;&amp;#x3002;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&amp;#x63A5;&amp;#x6536;&amp;#x51FD;&amp;#x6570;&amp;#x901A;&amp;#x8FC7;&amp;#x53CD;&amp;#x8936;&amp;#x79EF;&amp;#x8BA1;&amp;#x7B97;&amp;#xFF0C;&amp;#x63D0;&amp;#x53D6;&amp;#x6CE2;&amp;#x573A;&amp;#x5728;&amp;#x754C;&amp;#x9762;&amp;#x5904;&amp;#x7684;&amp;#x8F6C;&amp;#x6362;&amp;#x6548;&amp;#x5E94;&amp;#x3002;&amp;#x5728;&amp;#x5B9E;&amp;#x9645;&amp;#x95EE;&amp;#x9898;&amp;#x4E2D;&amp;#xFF0C;&amp;#x5E76;&amp;#x4E0D;&amp;#x5B58;&amp;#x5728;&amp;#x7EDD;&amp;#x5BF9;&amp;#x7684;&amp;#x754C;&amp;#x9762;&amp;#xFF0C;&amp;#x66F4;&amp;#x4E3A;&amp;#x51C6;&amp;#x786E;&amp;#x7684;&amp;#x63CF;&amp;#x8FF0;&amp;#x5E94;&amp;#x8BE5;&amp;#x662F;&amp;#x901F;&amp;#x5EA6;&amp;#x68AF;&amp;#x5EA6;&amp;#x8F83;&amp;#x9AD8;&amp;#x7684;&amp;#x8FC7;&amp;#x5EA6;&amp;#x5E26;&amp;#x3002;&amp;#x4E3A;&amp;#x5BF9;&amp;#x6BD4;&amp;#x68AF;&amp;#x5EA6;&amp;#x5E26;&amp;#x7ED9;&amp;#x63A5;&amp;#x6536;&amp;#x51FD;&amp;#x6570;&amp;#x6CE2;&amp;#x5F62;&amp;#x5E26;&amp;#x6765;&amp;#x7684;&amp;#x5F71;&amp;#x54CD;&amp;#xFF0C;&amp;#x53C2;&amp;#x8003;&lt;a href=&quot;http://www.eas.slu.edu/eqc/eqc_cps/TUTORIAL/RFTN2/index.html&quot;&gt;CPS Tutorials&amp;#x90E8;&amp;#x5206;&amp;#x5185;&amp;#x5BB9;&lt;/a&gt;&amp;#xFF0C;&amp;#x672C;&amp;#x6587;&amp;#x9009;&amp;#x62E9;&amp;#x4E86;&amp;#x8D70;&amp;#x65F6;&amp;#x76F8;&amp;#x540C;&amp;#xFF0C;&amp;#x68AF;&amp;#x5EA6;&amp;#x53D8;&amp;#x5316;&amp;#x4E0D;&amp;#x540C;&amp;#x7684;&amp;#x6A21;&amp;#x578B;&amp;#xFF0C;&amp;#x7528;&amp;#x4E8E;&amp;#x63A5;&amp;#x6536;&amp;#x51FD;&amp;#x6570;&amp;#x6B63;&amp;#x6F14;&amp;#x8BA1;&amp;#x7B97;&amp;#x3002;&lt;br&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/categories/Receiver-Function/"/>
    
    
      <category term="Receiver Function" scheme="http://sheng09.github.io/tags/Receiver-Function/"/>
    
      <category term="Interface" scheme="http://sheng09.github.io/tags/Interface/"/>
    
  </entry>
  
</feed>
